(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 12.1' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[    256843,       6283]
NotebookOptionsPosition[    236369,       5871]
NotebookOutlinePosition[    236896,       5889]
CellTagsIndexPosition[    236853,       5886]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{
Cell[TextData[{
 "New in: ",
 Cell["1.0", "HistoryData",
  CellTags->"New",ExpressionUUID->"c739174c-9f39-4416-aa9f-619ab84b34da"],
 " | Modified in: ",
 Cell[" ", "HistoryData",
  CellTags->"Modified",ExpressionUUID->"18e82e84-c2fe-416d-9cec-e8275638b24d"],
 " | Obsolete in: ",
 Cell[" ", "HistoryData",
  CellTags->"Obsolete",ExpressionUUID->"91a89c33-e20b-4d1c-8c0f-91600aec6298"],
 " | Excised in: ",
 Cell[" ", "HistoryData",
  CellTags->"Excised",ExpressionUUID->"762ea802-8b7c-4bd2-8e08-12cfcc24d258"]
}], "History",
 CellChangeTimes->{{3.878112013961279*^9, 3.878112016513425*^9}},
 CellID->1247902091,ExpressionUUID->"3940006d-6a0f-486f-aa1e-3a8e40c0f7cb"],

Cell[CellGroupData[{

Cell["Categorization", "CategorizationSection",
 CellID->1122911449,ExpressionUUID->"091d4b82-1486-44fc-936a-55dae8d1b01e"],

Cell["Tutorial", "Categorization",
 CellLabel->"Entity Type",
 CellID->686433507,ExpressionUUID->"12a50e11-0ea6-435c-871d-7fca16e42f89"],

Cell["TBpack", "Categorization",
 CellLabel->"Paclet Name",
 CellID->605800465,ExpressionUUID->"41b5bfee-12d1-4c22-a6d7-4e9ffbebcfb4"],

Cell["TBpack`", "Categorization",
 CellLabel->"Context",
 CellID->468444828,ExpressionUUID->"596a08b0-fb5f-4694-ab0b-90638efb236f"],

Cell["TBpack/tutorial/HubbardMeanFieldModel", "Categorization",
 CellLabel->"URI",ExpressionUUID->"ea40e3af-a5f4-46dc-a8cc-1bf3a2c44d4a"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Keywords", "KeywordsSection",
 CellID->1427428552,ExpressionUUID->"f9914da7-07d0-40fd-9f4c-e5d4f7191392"],

Cell["electron-electron correlation", "Keywords",
 CellChangeTimes->{{3.8781120292281523`*^9, 3.8781120445890307`*^9}, {
  3.878112143416683*^9, 3.878112145229787*^9}},
 CellID->1251852827,ExpressionUUID->"9f40a13e-a795-49e4-843f-f7fbfc4f4ffa"],

Cell["Coulomb interaction", "Keywords",
 CellChangeTimes->{{3.8781120292281523`*^9, 3.878112054311587*^9}},
 CellID->653679113,ExpressionUUID->"e354a31c-d0b5-4d5a-a5b4-29343ef9751c"],

Cell["correlated systems", "Keywords",
 CellChangeTimes->{{3.8781120292281523`*^9, 3.878112072218611*^9}},
 CellID->613130496,ExpressionUUID->"38078204-3146-40df-a284-5dc4ee441da1"],

Cell["strongly correlated systems", "Keywords",
 CellChangeTimes->{{3.8781120292281523`*^9, 3.87811207954103*^9}},
 CellID->504256200,ExpressionUUID->"8f4c26f4-afeb-4e90-b08f-07f70c820ca3"],

Cell["mean field", "Keywords",
 CellChangeTimes->{{3.8781120292281523`*^9, 3.878112089007571*^9}, {
  3.8781121202523584`*^9, 3.8781121206773825`*^9}},
 CellID->1030914704,ExpressionUUID->"a690edf4-04b0-4c35-8c1d-c583759c22d7"],

Cell["mean-field approximation", "Keywords",
 CellChangeTimes->{{3.8781120292281523`*^9, 3.878112099983199*^9}},
 CellID->287984341,ExpressionUUID->"8c6c851a-1d41-4af9-aed8-c17b11b366bb"],

Cell["band structure", "Keywords",
 CellChangeTimes->{{3.8781121038774223`*^9, 3.87811213199203*^9}},
 CellID->333773507,ExpressionUUID->"a7bb5352-67da-4688-8eed-3695ca9a1299"],

Cell["Hubbard model", "Keywords",
 CellChangeTimes->{{3.8781121621907573`*^9, 3.878112166576008*^9}},
 CellID->372860421,ExpressionUUID->"3573d626-129c-4d33-9b6a-bea68813ad61"],

Cell["density fluctuations", "Keywords",
 CellChangeTimes->{{3.878112181507862*^9, 3.878112186947173*^9}},
 CellID->721034594,ExpressionUUID->"d7e01337-0159-4694-a68c-d5b8cbaac321"],

Cell["ferromagnetic", "Keywords",
 CellChangeTimes->{{3.878112196810737*^9, 3.878112226297425*^9}},
 CellID->17758388,ExpressionUUID->"cfb205c4-66f4-4b7b-9f8b-b245aa05e232"],

Cell["antiferromagnetic", "Keywords",
 CellChangeTimes->{{3.878112196810737*^9, 3.878112233863857*^9}},
 CellID->41305077,ExpressionUUID->"296183f8-9383-425f-a772-b213457fa14e"],

Cell["paramagnetic", "Keywords",
 CellChangeTimes->{{3.878112196810737*^9, 3.878112245325513*^9}},
 CellID->492575331,ExpressionUUID->"a46c7cdb-f64e-4d8d-a059-5a1366e63839"],

Cell["Mott insulator", "Keywords",
 CellChangeTimes->{{3.878112196810737*^9, 3.8781122497477655`*^9}},
 CellID->688022415,ExpressionUUID->"40cbac29-b276-4fb7-ab2d-3b706eb6d3b5"],

Cell["Slater insulator", "Keywords",
 CellChangeTimes->{{3.878112196810737*^9, 3.8781122587742815`*^9}},
 CellID->324842763,ExpressionUUID->"0bda32d1-a699-4437-a4f1-0750389425d0"],

Cell["Stoner criterion", "Keywords",
 CellChangeTimes->{{3.878112262628502*^9, 3.878112266250709*^9}},
 CellID->21823167,ExpressionUUID->"12d0fba9-af39-4a87-8e41-9e75bc1c92c5"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Details", "DetailsSection",
 CellID->307771771,ExpressionUUID->"90e9975d-c520-46e0-bf71-3acd7cf6f1e8"],

Cell["XXXX", "Details",
 CellLabel->"Lead",
 CellID->218895918,ExpressionUUID->"7d8d0c7b-e61e-4575-a313-a7b642db8c8a"],

Cell["XXXX", "Details",
 CellLabel->"Developers",
 CellID->350963985,ExpressionUUID->"b21b727f-597b-4e89-9be6-c16e07fc0f24"],

Cell["XXXX", "Details",
 CellLabel->"Authors",
 CellID->795871300,ExpressionUUID->"4541a1f0-67fb-41b5-9bd2-156a40c9ee87"],

Cell["XXXX", "Details",
 CellLabel->"Feature Name",
 CellID->199739161,ExpressionUUID->"3b5fa953-fede-4043-ae29-4c65585d43be"],

Cell["XXXX", "Details",
 CellLabel->"QA",
 CellID->40625308,ExpressionUUID->"4f8d0a18-baa7-4821-b109-d469f558826a"],

Cell["XXXX", "Details",
 CellLabel->"DA",
 CellID->357121918,ExpressionUUID->"dc91fe58-ba2b-4868-ada2-35153a1cb69a"],

Cell["XXXX", "Details",
 CellLabel->"Docs",
 CellID->35949532,ExpressionUUID->"d9ad6e5c-dfbf-43c8-ad66-cefc105ad852"],

Cell["XXXX", "Details",
 CellLabel->"Features Page Notes",
 CellID->929432370,ExpressionUUID->"3743f626-8751-48d7-b328-5281890e682c"],

Cell["XXXX", "Details",
 CellLabel->"Comments",
 CellID->240026365,ExpressionUUID->"e1faf829-06d4-479f-95c7-0d8b527e8003"]
}, Closed]],

Cell[CellGroupData[{

Cell["Hubbard Mean Field Model", "Title",
 CellChangeTimes->{{3.878112001476565*^9, 3.878112005744809*^9}},
 CellID->509267359,ExpressionUUID->"7d715dab-bfea-48f6-8d4e-3a3b891c6cba"],

Cell[TextData[{
 "While majority of the known materials can be simply classified based on \
their response to an externally applied magnetic field as diamagnetic \
(orbital magnetism, permeability ",
 Cell[BoxData[
  RowBox[{"\[Mu]", "<", "1"}]],ExpressionUUID->
  "226ae6af-c80a-4792-adb9-1e9d0984a13e"],
 ") or paramagnetic (spin magnetism, permeability ",
 Cell[BoxData[
  RowBox[{"\[Mu]", ">", "1"}]],ExpressionUUID->
  "681fb1de-40df-4732-9aa8-4460361cee34"],
 "), a range of materials exhibit magnetic behaviour even without the \
external field. Such materials are referred to as ferromagnetic or \
antiferromagnetic. The macroscopic effects of ferromagnetism and \
antiferromagnetism are rooted in the quantum behaviour of the system. At the \
microscopic level, they arise from the many-body Coulomb interaction between \
electrons. The minimum model accounting for many-body interactions within the \
tight-binding formalism can be obtained by considering the interaction \
between electrons only when they occupy the same atomic site, see ",
 ButtonBox["J. Hubbard, ",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1098/rspa.1963.0204"], None}],
 StyleBox[ButtonBox["Proc. R. Soc. London. Ser. A. Math. Phys. Sci.",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1098/rspa.1963.0204"], None}],
  FontSlant->"Italic"],
 ButtonBox[" ",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1098/rspa.1963.0204"], None}],
 StyleBox[ButtonBox["276",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1098/rspa.1963.0204"], None}],
  FontWeight->"Bold"],
 ButtonBox[", 238 (1963)",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1098/rspa.1963.0204"], None}],
 ". This model is called the ",
 StyleBox["Hubbard model",
  FontSlant->"Italic"],
 ". The Hubbard model can be further simplified by neglecting the fluctuation \
of the electron density. When this is done, the complicated many-particle \
picture reduces to a single electron moving in an average field of the \
surrounding particles. This reduction is called the ",
 StyleBox["mean field approximation",
  FontSlant->"Italic"],
 ". The mean field is not static. It depends on the overall electron \
configuration defined by on-site electron spin densities, therefore, this \
problem shall account for electron spin polarization and shall be solved \
self-consistently."
}], "Text",
 CellChangeTimes->{
  3.878365365810583*^9, {3.878366072961921*^9, 3.8783660861615443`*^9}, 
   3.878366254516528*^9, {3.8783663022385426`*^9, 3.8783663164575634`*^9}, {
   3.8784639705088935`*^9, 3.8784639714509487`*^9}},
 CellID->392738683,ExpressionUUID->"2df5b76c-6d6d-4a03-968a-295551a68714"],

Cell[TextData[{
 "This tutorial details how ",
 Cell[BoxData[
  ButtonBox["ElectronicStructure",
   BaseStyle->"Link",
   ButtonData->"paclet:TBpack/ref/ElectronicStructure"]], "InlineFormula",
  ExpressionUUID->"8da48f65-d7f3-49fe-8174-6e0018ce4e1d"],
 " can be extended to run spin polarized tight-binding calculation in a \
self-consistent manner."
}], "Text",
 CellChangeTimes->{{3.87811232326997*^9, 3.87811240578469*^9}, 
   3.878112590654264*^9, {3.878112643665296*^9, 3.8781129811706*^9}, {
   3.878113041463049*^9, 3.8781131901715546`*^9}, {3.8781132246855288`*^9, 
   3.878113450793461*^9}, {3.878125325659741*^9, 3.878125336293349*^9}, 
   3.8783653148504925`*^9, {3.888238493448419*^9, 3.8882385111494713`*^9}},
 CellID->234279902,ExpressionUUID->"86241a8a-be16-4793-bb9b-3b18c3bcc980"],

Cell[BoxData[GridBox[{
   {
    RowBox[{
     ButtonBox["ElectronicStructure",
      BaseStyle->"Link",
      ButtonData->"paclet:TBpack/ref/ElectronicStructure"], "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        SubscriptBox[
         StyleBox["unitcell", "TI"], 
         StyleBox["1", "TR"]], ",", 
        SubscriptBox[
         StyleBox["unitcell", "TI"], 
         StyleBox["2", "TR"]]}], "}"}], ",", 
      RowBox[{
       SubscriptBox[
        StyleBox["opt", "TI"], 
        StyleBox["1", "TR"]], "\[Rule]", 
       SubscriptBox[
        StyleBox["val", "TI"], 
        StyleBox["1", "TR"]]}], ",", 
      RowBox[{
       SubscriptBox[
        StyleBox["opt", "TI"], 
        StyleBox["2", "TR"]], "\[Rule]", 
       SubscriptBox[
        StyleBox["val", "TI"], 
        StyleBox["2", "TR"]]}], ",", "..."}], "]"}], Cell[TextData[{
     "calculate single-electron energy levels for the stucture defined by \
initial and optimized atomic coordinates ",
     Cell[BoxData[
      RowBox[{
       SubscriptBox[
        StyleBox["unitcell", "TI"], 
        StyleBox["1", "TR"]], " ", "and", " ", 
       SubscriptBox[
        StyleBox["unitcell", "TI"], 
        StyleBox["2", "TR"]]}]],ExpressionUUID->
      "f3b2f49e-9945-4af2-89b5-915465d4e82c"],
     ", subject to the given ",
     Cell[BoxData[
      RowBox[{
       SubscriptBox[
        StyleBox["opt", "TI"], 
        StyleBox["i", "TI"]], "\[Rule]", 
       SubscriptBox[
        StyleBox["val", "TI"], 
        StyleBox["i", "TI"]], " "}]],ExpressionUUID->
      "3cfb6e96-b40f-491e-903c-e10e3f56b677"],
     " rules"
    }], "TableText",ExpressionUUID->"86b7e1e2-0be3-4f94-9f5f-4b96dd02b318"]}
  }]], "DefinitionBox",
 CellChangeTimes->{{3.878112419892497*^9, 3.8781124274859314`*^9}, {
  3.8781257721712804`*^9, 3.87812581814891*^9}, {3.878125888041908*^9, 
  3.8781261018661375`*^9}, {3.878126160922516*^9, 3.8781262729149218`*^9}, {
  3.878130008330575*^9, 3.87813004005639*^9}, {3.878132930844733*^9, 
  3.878132957827276*^9}},
 CellID->2096742444,ExpressionUUID->"3a1bcea0-4a3b-421f-b003-b4cb8349cb87"],

Cell["Calculating spin non-polarized energy levels.", "Caption",
 CellChangeTimes->{{3.8781124446739144`*^9, 3.8781124453209515`*^9}, {
  3.878112482910101*^9, 3.878112541329443*^9}, {3.8781261690929832`*^9, 
  3.878126175899372*^9}},
 CellID->1891092685,ExpressionUUID->"580ed65d-1618-4f98-8d7c-484e1c8a1e78"],

Cell[CellGroupData[{

Cell["Basic theory", "Subsection",
 CellChangeTimes->{{3.878126320702655*^9, 3.878126321122679*^9}, {
  3.8781263902896347`*^9, 3.8781264114128428`*^9}},
 CellID->99497867,ExpressionUUID->"cef2287f-643e-4d1d-a0da-72c99a953337"],

Cell[TextData[{
 "In this brief theory introduction, we follow a pedagogical paper ",
 ButtonBox["Y. Claveau, B. Arnaud, and S. Di Matteo, ",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1088/0143-0807/35/3/035023"], None}],
 StyleBox[ButtonBox["Eur. J. Phys.",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1088/0143-0807/35/3/035023"], None}],
  FontSlant->"Italic"],
 ButtonBox[" ",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1088/0143-0807/35/3/035023"], None}],
 StyleBox[ButtonBox["35",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1088/0143-0807/35/3/035023"], None}],
  FontWeight->"Bold"],
 ButtonBox[", 035023 (2014)",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1088/0143-0807/35/3/035023"], None}],
 ". We start from the Hamiltonian in the Wannier basis with one atomic \
orbital per site: "
}], "Text",
 CellChangeTimes->{{3.8781330362987647`*^9, 3.8781330588870573`*^9}, {
  3.878366675130858*^9, 3.8783667019838953`*^9}, {3.8783667948512497`*^9, 
  3.8783667990452557`*^9}, {3.878366970958206*^9, 3.878366991605024*^9}, {
  3.878371225944914*^9, 3.878371250760304*^9}},
 CellID->340960235,ExpressionUUID->"282cb253-591f-45e0-a2e5-91fc179bfb24"],

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox[
    OverscriptBox["H", "^"], "H"], "=", 
   RowBox[{
    RowBox[{
     UnderscriptBox["\[Sum]", 
      RowBox[{" ", 
       RowBox[{"i", ",", "j", ",", "\[Sigma]"}]}]], 
     RowBox[{
      SubscriptBox["t", 
       RowBox[{"i", ",", "j"}]], 
      SubsuperscriptBox[
       OverscriptBox["c", "^"], 
       RowBox[{"i", ",", "\[Sigma]"}], "\[Dagger]"], 
      SubscriptBox[
       OverscriptBox["c", "^"], 
       RowBox[{"j", ",", "\[Sigma]"}]]}]}], "+", 
    RowBox[{"U", " ", 
     RowBox[{
      UnderscriptBox["\[Sum]", 
       RowBox[{" ", "i"}]], 
      RowBox[{
       SubscriptBox[
        OverscriptBox["n", "^"], 
        RowBox[{"i", ",", "\[UpArrow]"}]], 
       SubscriptBox[
        OverscriptBox["n", "^"], 
        RowBox[{"i", ",", "\[DownArrow]"}]]}]}]}]}]}], 
  TraditionalForm]], "InlineMath",
 InitializationCell->
  True,ExpressionUUID->"1a92a120-edc4-43dc-90bb-ff929f6f5ef8"]], "Text",
 CellChangeTimes->{{3.878366663999841*^9, 3.878366667277847*^9}, {
  3.878367695572129*^9, 3.878367751410723*^9}, {3.878369327348513*^9, 
  3.878369333375606*^9}, {3.878369438798833*^9, 3.8783696408367443`*^9}, {
  3.878369711846911*^9, 3.878369961974121*^9}, {3.888239549425556*^9, 
  3.888239555480649*^9}, {3.888240592655314*^9, 3.888240593680329*^9}},
 CellID->248436350,ExpressionUUID->"d3c135d8-6dd4-41b7-8698-475aa96ba954"],

Cell["where ", "Text",
 CellChangeTimes->{{3.878370067370464*^9, 3.8783702610783052`*^9}, {
  3.8783703519107065`*^9, 3.878370669453966*^9}},
 CellID->575166834,ExpressionUUID->"98a342a0-b954-4e83-8037-f5d96508ec39"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   SubsuperscriptBox[
    OverscriptBox["c", "^"], 
    RowBox[{"i", ",", "\[Sigma]"}], "\[Dagger]"], TraditionalForm]], 
  "InlineMath",ExpressionUUID->"e8420101-cdbf-4697-a869-4efd8473466e"],
 " is an operator representing creation of an electron with spin ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[Sigma]", "=", "\[UpArrow]"}], ",", "\[DownArrow]"}], 
   TraditionalForm]], "InlineMath",ExpressionUUID->
  "c751fc88-e9c8-459c-b45e-e6dc351865c2"],
 " at site ",
 Cell[BoxData[
  FormBox["i", TraditionalForm]], "InlineMath",ExpressionUUID->
  "49790352-ca49-42d6-b658-f5b55afba5a8"],
 ", "
}], "Text",
 CellChangeTimes->{{3.878370067370464*^9, 3.8783702610783052`*^9}, {
  3.8783703519107065`*^9, 3.878370645595336*^9}, {3.878370678371604*^9, 
  3.878370678371604*^9}},
 CellID->175323470,ExpressionUUID->"b848d3e0-e3dc-4327-99ac-d6922b23d7ba"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox["c", "^"], 
    RowBox[{"j", ",", "\[Sigma]"}]], TraditionalForm]], "InlineMath",
  ExpressionUUID->"b6de4e8f-2603-44fb-80b2-0a7b09efffc1"],
 " is the annihilation operator of an electron with spin ",
 Cell[BoxData[
  FormBox["\[Sigma]", TraditionalForm]], "InlineMath",ExpressionUUID->
  "26d9140e-b318-4787-b7dd-1bccaf5f7967"],
 " at site ",
 Cell[BoxData[
  FormBox["j", TraditionalForm]], "InlineMath",ExpressionUUID->
  "831fec52-caff-4c89-a925-7a3fbe5acb16"],
 ", "
}], "Text",
 CellChangeTimes->{{3.878370067370464*^9, 3.8783702610783052`*^9}, {
  3.8783703519107065`*^9, 3.878370645595336*^9}, {3.878370683556377*^9, 
  3.878370683556377*^9}, {3.878370833560389*^9, 3.878370835377918*^9}},
 CellID->431712291,ExpressionUUID->"f3101dec-e6bc-4011-a6d6-51d028b68b12"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   SubscriptBox["t", 
    RowBox[{"i", ",", "j"}]], TraditionalForm]], "InlineMath",ExpressionUUID->
  "5a9e10af-a8cd-4eae-b712-afa15148fb02"],
 " is the hopping integral for an electron hopping from site ",
 Cell[BoxData[
  FormBox["j", TraditionalForm]], "InlineMath",ExpressionUUID->
  "e681b559-44b3-4126-8608-d69a48d7ab57"],
 ", where electron is destroyed, to the site ",
 Cell[BoxData[
  FormBox["i", TraditionalForm]], "InlineMath",ExpressionUUID->
  "c7fe3a32-88a0-4cfc-8594-097a69c3a60a"],
 ", where electron is created,"
}], "Text",
 CellChangeTimes->{{3.878370067370464*^9, 3.8783702610783052`*^9}, {
  3.8783703519107065`*^9, 3.878370645595336*^9}, {3.878370837609953*^9, 
  3.8783708395874825`*^9}},
 CellID->355460130,ExpressionUUID->"5d04248c-d458-42ab-8bb9-1d2283efffa3"],

Cell[TextData[{
 Cell[BoxData[
  FormBox["U", TraditionalForm]], "InlineMath",ExpressionUUID->
  "7e12d091-de9d-4443-8372-b189ee8f0edb"],
 " is the on-site Coulomb repulsion between electrons and"
}], "Text",
 CellChangeTimes->{{3.878370067370464*^9, 3.8783702610783052`*^9}, {
  3.8783703519107065`*^9, 3.878370645595336*^9}, {3.878370837609953*^9, 
  3.8783708494836354`*^9}, {3.878370883076597*^9, 3.8783708952663617`*^9}, {
  3.8783710478980727`*^9, 3.878371048233077*^9}, {3.8882395645257883`*^9, 
  3.8882395645257883`*^9}, {3.888239939309829*^9, 3.888239940457374*^9}, {
  3.8882406031514745`*^9, 3.888240604278991*^9}},
 CellID->6233816,ExpressionUUID->"73a6b437-bd1c-48bc-835c-da1f300ed7d3"],

Cell[TextData[{
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     OverscriptBox["n", "^"], 
     RowBox[{"i", ",", "\[Sigma]"}]], "=", 
    RowBox[{
     SubsuperscriptBox[
      OverscriptBox["c", "^"], 
      RowBox[{"i", ",", "\[Sigma]"}], "\[Dagger]"], 
     SubscriptBox[
      OverscriptBox["c", "^"], 
      RowBox[{"i", ",", "\[Sigma]"}]]}]}], TraditionalForm]], "InlineMath",
  ExpressionUUID->"397bd1a3-33f9-4402-9bb7-bdefc173063b"],
 " is the particle number operator for an electron at site ",
 Cell[BoxData[
  FormBox["i", TraditionalForm]], "InlineMath",ExpressionUUID->
  "12a916d2-1e8b-4e33-b9fd-838c5aad7ca3"],
 " with spin ",
 Cell[BoxData[
  FormBox["\[Sigma]", TraditionalForm]], "InlineMath",ExpressionUUID->
  "4ffc5a6b-7f09-44f6-a97f-4eba0e39ff02"],
 "."
}], "Text",
 CellChangeTimes->{{3.878370067370464*^9, 3.8783702610783052`*^9}, {
  3.8783703519107065`*^9, 3.878370645595336*^9}, {3.878370837609953*^9, 
  3.8783708494836354`*^9}, {3.878370883076597*^9, 3.8783710503171096`*^9}, {
  3.878464079617135*^9, 3.878464108586792*^9}},
 CellID->691137860,ExpressionUUID->"075d7032-6e66-4a82-821f-92c2fe1953ba"],

Cell[TextData[{
 "The first hopping term in the above Hamiltonian is the second quantization \
representation of the kinetic energy and crystal potential, while the second \
one is the electron-electron interaction. The hopping is usually considered \
to be non-zero only for the nearest neighbor sites, as their orbital overlap \
is the largest, so that the sum is usually running over the nearest neighbors \
only, which is standardly denoted as ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    UnderscriptBox["\[Sum]", 
     RowBox[{" ", 
      RowBox[{"i", ",", "j", ",", "\[Sigma]"}]}]], 
    RowBox[{"\[Rule]", 
     UnderscriptBox["\[Sum]", 
      RowBox[{" ", 
       RowBox[{
        RowBox[{"<", "i"}], ",", 
        RowBox[{"j", ">"}], ",", "\[Sigma]"}]}]]}]}], TraditionalForm]], 
  "InlineMath",ExpressionUUID->"df428dd0-338a-4c3c-bd08-47896ac3aa10"],
 ". The system is normally considered to be isotropic so that hopping \
integral does not depend on the sites involved in the hopping, then ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["t", 
     RowBox[{"i", ",", "j"}]], "=", "t"}], TraditionalForm]], "InlineMath",
  ExpressionUUID->"b209f5e4-edcd-4d32-982b-6f0a7622b60c"],
 " is also a standard assumption. The second term in the Hamiltonian is the \
Coulomb repulsion between two electrons with opposite spins occupying the \
same orbital. When this is the case, they contribute the energy ",
 Cell[BoxData[
  FormBox["U", TraditionalForm]], "InlineMath",ExpressionUUID->
  "85b8b7d3-5e88-485d-9335-d7e0e1f397c4"],
 ". However, if electrons occupy different sites, they do not feel any \
repulsion, which is, by the way, a very strong approximation that \
nevertheless correctly captures a lot of physics. "
}], "Text",
 CellChangeTimes->{{3.878371057231217*^9, 3.878371150029909*^9}, {
  3.878371328051288*^9, 3.878371627514485*^9}, {3.878371745753851*^9, 
  3.87837187804236*^9}, {3.878371967525036*^9, 3.8783720647245803`*^9}, {
  3.878372098777529*^9, 3.8783722338414574`*^9}, {3.87837227386961*^9, 
  3.878372310241981*^9}, {3.878372417398028*^9, 3.8783724235557194`*^9}, {
  3.878464164002961*^9, 3.878464189129399*^9}},
 CellID->9668019,ExpressionUUID->"dee2eb1c-f86a-4151-8e7b-9f2e98d942fb"],

Cell[TextData[{
 "The ",
 StyleBox["mean field approximation",
  FontSlant->"Italic"],
 " corresponds to neglecting fluctuation an electron density around its mean \
value. These deviations of the exact number operator ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    OverscriptBox["n", "^"], 
    RowBox[{"i", ",", "\[Sigma]"}]], TraditionalForm]], "InlineMath",
  ExpressionUUID->"54385868-87af-4b3e-b66d-5861412c7eef"],
 " from the mean occupation number ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[LeftAngleBracket]", 
    SubscriptBox[
     OverscriptBox["n", "^"], 
     RowBox[{"i", ",", "\[Sigma]"}]], "\[RightAngleBracket]"}], 
   TraditionalForm]], "InlineMath",ExpressionUUID->
  "0b1da2ad-032b-4fdc-93bc-4b28c80b5ba1"],
 " are defined as  ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[CapitalDelta]", " ", 
     SubscriptBox[
      OverscriptBox["n", "^"], 
      RowBox[{"i", ",", "\[Sigma]"}]]}], "=", 
    RowBox[{
     SubscriptBox[
      OverscriptBox["n", "^"], 
      RowBox[{"i", ",", "\[Sigma]"}]], "-", 
     RowBox[{"\[LeftAngleBracket]", 
      SubscriptBox[
       OverscriptBox["n", "^"], 
       RowBox[{"i", ",", "\[Sigma]"}]], "\[RightAngleBracket]"}]}]}], 
   TraditionalForm]], "InlineMath",ExpressionUUID->
  "be1ece02-0439-4ac1-9388-c87f10ed3722"],
 ", whence ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox[
     OverscriptBox["n", "^"], 
     RowBox[{"i", ",", "\[Sigma]"}]], "=", 
    RowBox[{
     RowBox[{"\[CapitalDelta]", " ", 
      SubscriptBox[
       OverscriptBox["n", "^"], 
       RowBox[{"i", ",", "\[Sigma]"}]]}], "+", 
     RowBox[{"\[LeftAngleBracket]", 
      SubscriptBox[
       OverscriptBox["n", "^"], 
       RowBox[{"i", ",", "\[Sigma]"}]], "\[RightAngleBracket]"}]}]}], 
   TraditionalForm]], "InlineMath",ExpressionUUID->
  "f0f7fe3e-b06c-4d31-9062-c4149485042e"],
 ". This latter expression allows one to re-write the second term of the \
Hamiltonian as follows:"
}], "Text",
 CellChangeTimes->{{3.878372469256501*^9, 3.8783725169306555`*^9}, {
  3.878372624464059*^9, 3.878373007707418*^9}, {3.87837312528394*^9, 
  3.878373238154806*^9}, {3.878464286953994*^9, 3.8784643402770443`*^9}},
 CellID->244331071,ExpressionUUID->"85a33cc4-9ccf-4975-a2b7-f301552b38b1"],

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    SubscriptBox[
     OverscriptBox["n", "^"], 
     RowBox[{"i", ",", "\[UpArrow]"}]], " ", 
    SubscriptBox[
     OverscriptBox["n", "^"], 
     RowBox[{"i", ",", "\[DownArrow]"}]]}], "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[CapitalDelta]", " ", 
        SubscriptBox[
         OverscriptBox["n", "^"], 
         RowBox[{"i", ",", "\[UpArrow]"}]]}], "+", 
       RowBox[{"\[LeftAngleBracket]", 
        SubscriptBox[
         OverscriptBox["n", "^"], 
         RowBox[{"i", ",", "\[UpArrow]"}]], "\[RightAngleBracket]"}]}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"\[CapitalDelta]", " ", 
        SubscriptBox[
         OverscriptBox["n", "^"], 
         RowBox[{"i", ",", "\[DownArrow]"}]]}], "+", 
       RowBox[{"\[LeftAngleBracket]", 
        SubscriptBox[
         OverscriptBox["n", "^"], 
         RowBox[{"i", ",", "\[DownArrow]"}]], "\[RightAngleBracket]"}]}], 
      ")"}]}], "=", 
    RowBox[{
     RowBox[{"\[CapitalDelta]", " ", 
      SubscriptBox[
       OverscriptBox["n", "^"], 
       RowBox[{"i", ",", "\[UpArrow]"}]], "\[CapitalDelta]", " ", 
      SubscriptBox[
       OverscriptBox["n", "^"], 
       RowBox[{"i", ",", "\[DownArrow]"}]]}], "+", 
     RowBox[{"\[CapitalDelta]", " ", 
      SubscriptBox[
       OverscriptBox["n", "^"], 
       RowBox[{"i", ",", "\[UpArrow]"}]], 
      RowBox[{"\[LeftAngleBracket]", 
       SubscriptBox[
        OverscriptBox["n", "^"], 
        RowBox[{"i", ",", "\[DownArrow]"}]], "\[RightAngleBracket]"}]}], "+", 
     RowBox[{
      RowBox[{"\[LeftAngleBracket]", 
       SubscriptBox[
        OverscriptBox["n", "^"], 
        RowBox[{"i", ",", "\[UpArrow]"}]], "\[RightAngleBracket]"}], 
      "\[CapitalDelta]", " ", 
      SubscriptBox[
       OverscriptBox["n", "^"], 
       RowBox[{"i", ",", "\[DownArrow]"}]]}], "+", 
     RowBox[{
      RowBox[{"\[LeftAngleBracket]", 
       SubscriptBox[
        OverscriptBox["n", "^"], 
        RowBox[{"i", ",", "\[UpArrow]"}]], "\[RightAngleBracket]"}], 
      RowBox[{"\[LeftAngleBracket]", 
       SubscriptBox[
        OverscriptBox["n", "^"], 
        RowBox[{"i", ",", "\[DownArrow]"}]], "\[RightAngleBracket]"}]}]}]}]}],
   TraditionalForm]], \
"InlineMath",ExpressionUUID->"cb8bbad5-760b-4385-b623-e4e72db3f340"]], "Text",
 CellChangeTimes->{{3.878372469256501*^9, 3.8783725169306555`*^9}, {
  3.878372624464059*^9, 3.878373007707418*^9}, {3.87837312528394*^9, 
  3.878373237080756*^9}, {3.878373308558224*^9, 3.8783734554814434`*^9}, {
  3.8783734890500712`*^9, 3.878373549857668*^9}, {3.9277982201960907`*^9, 
  3.927798232016468*^9}},
 CellID->135531073,ExpressionUUID->"816a5dc8-490f-43a8-a94d-d7352bb59a12"],

Cell[TextData[{
 "The first term of the above expression, that is quadratic in fluctuations, \
can be neglected, while the linear terms can be again re-written via of the \
exact number operator and the ",
 StyleBox["mean occupation number:", "Text"]
}], "Text",
 CellChangeTimes->{{3.878373637281155*^9, 3.8783737254660015`*^9}, {
  3.878374035155444*^9, 3.878374048426203*^9}},
 CellID->188641995,ExpressionUUID->"db4aee14-5452-4f17-92aa-90362178c4b0"],

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    RowBox[{
     SubscriptBox[
      OverscriptBox["n", "^"], 
      RowBox[{"i", ",", "\[UpArrow]"}]], " ", 
     SubscriptBox[
      OverscriptBox["n", "^"], 
      RowBox[{"i", ",", "\[DownArrow]"}]]}], "\[TildeTilde]", 
    RowBox[{
     RowBox[{"\[CapitalDelta]", " ", 
      SubscriptBox[
       OverscriptBox["n", "^"], 
       RowBox[{"i", ",", "\[UpArrow]"}]], 
      RowBox[{"\[LeftAngleBracket]", 
       SubscriptBox[
        OverscriptBox["n", "^"], 
        RowBox[{"i", ",", "\[DownArrow]"}]], "\[RightAngleBracket]"}]}], "+", 
     RowBox[{
      RowBox[{"\[LeftAngleBracket]", 
       SubscriptBox[
        OverscriptBox["n", "^"], 
        RowBox[{"i", ",", "\[UpArrow]"}]], "\[RightAngleBracket]"}], 
      "\[CapitalDelta]", " ", 
      SubscriptBox[
       OverscriptBox["n", "^"], 
       RowBox[{"i", ",", "\[DownArrow]"}]]}], "+", 
     RowBox[{
      RowBox[{"\[LeftAngleBracket]", 
       SubscriptBox[
        OverscriptBox["n", "^"], 
        RowBox[{"i", ",", "\[UpArrow]"}]], "\[RightAngleBracket]"}], 
      RowBox[{"\[LeftAngleBracket]", 
       SubscriptBox[
        OverscriptBox["n", "^"], 
        RowBox[{"i", ",", "\[DownArrow]"}]], "\[RightAngleBracket]"}]}]}]}], 
   "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        SubscriptBox[
         OverscriptBox["n", "^"], 
         RowBox[{"i", ",", "\[UpArrow]"}]], "-", 
        RowBox[{"\[LeftAngleBracket]", 
         SubscriptBox[
          OverscriptBox["n", "^"], 
          RowBox[{"i", ",", "\[UpArrow]"}]], "\[RightAngleBracket]"}]}], 
       ")"}], 
      RowBox[{"\[LeftAngleBracket]", 
       SubscriptBox[
        OverscriptBox["n", "^"], 
        RowBox[{"i", ",", "\[DownArrow]"}]], "\[RightAngleBracket]"}]}], "+", 
     RowBox[{
      RowBox[{"\[LeftAngleBracket]", 
       SubscriptBox[
        OverscriptBox["n", "^"], 
        RowBox[{"i", ",", "\[UpArrow]"}]], "\[RightAngleBracket]"}], 
      RowBox[{"(", 
       RowBox[{
        SubscriptBox[
         OverscriptBox["n", "^"], 
         RowBox[{"i", ",", "\[DownArrow]"}]], "-", 
        RowBox[{"\[LeftAngleBracket]", 
         SubscriptBox[
          OverscriptBox["n", "^"], 
          RowBox[{"i", ",", "\[DownArrow]"}]], "\[RightAngleBracket]"}]}], 
       ")"}]}], "+", 
     RowBox[{
      RowBox[{"\[LeftAngleBracket]", 
       SubscriptBox[
        OverscriptBox["n", "^"], 
        RowBox[{"i", ",", "\[UpArrow]"}]], "\[RightAngleBracket]"}], 
      RowBox[{"\[LeftAngleBracket]", 
       SubscriptBox[
        OverscriptBox["n", "^"], 
        RowBox[{"i", ",", "\[DownArrow]"}]], "\[RightAngleBracket]"}]}]}], 
    "=", 
    RowBox[{
     RowBox[{
      RowBox[{
       SubscriptBox[
        OverscriptBox["n", "^"], 
        RowBox[{"i", ",", "\[UpArrow]"}]], 
       RowBox[{"\[LeftAngleBracket]", 
        SubscriptBox[
         OverscriptBox["n", "^"], 
         RowBox[{"i", ",", "\[DownArrow]"}]], "\[RightAngleBracket]"}]}], "-", 
      RowBox[{
       RowBox[{"\[LeftAngleBracket]", 
        SubscriptBox[
         OverscriptBox["n", "^"], 
         RowBox[{"i", ",", "\[UpArrow]"}]], "\[RightAngleBracket]"}], 
       RowBox[{"\[LeftAngleBracket]", 
        SubscriptBox[
         OverscriptBox["n", "^"], 
         RowBox[{"i", ",", "\[DownArrow]"}]], "\[RightAngleBracket]"}]}], "+", 
      RowBox[{
       SubscriptBox[
        OverscriptBox["n", "^"], 
        RowBox[{"i", ",", "\[DownArrow]"}]], 
       RowBox[{"\[LeftAngleBracket]", 
        SubscriptBox[
         OverscriptBox["n", "^"], 
         RowBox[{"i", ",", "\[UpArrow]"}]], "\[RightAngleBracket]"}]}], "-", 
      RowBox[{
       RowBox[{"\[LeftAngleBracket]", 
        SubscriptBox[
         OverscriptBox["n", "^"], 
         RowBox[{"i", ",", "\[UpArrow]"}]], "\[RightAngleBracket]"}], 
       RowBox[{"\[LeftAngleBracket]", 
        SubscriptBox[
         OverscriptBox["n", "^"], 
         RowBox[{"i", ",", "\[DownArrow]"}]], "\[RightAngleBracket]"}]}], "+", 
      RowBox[{
       RowBox[{"\[LeftAngleBracket]", 
        SubscriptBox[
         OverscriptBox["n", "^"], 
         RowBox[{"i", ",", "\[UpArrow]"}]], "\[RightAngleBracket]"}], 
       RowBox[{"\[LeftAngleBracket]", 
        SubscriptBox[
         OverscriptBox["n", "^"], 
         RowBox[{"i", ",", "\[DownArrow]"}]], "\[RightAngleBracket]"}]}]}], 
     "=", 
     RowBox[{
      RowBox[{
       SubscriptBox[
        OverscriptBox["n", "^"], 
        RowBox[{"i", ",", "\[UpArrow]"}]], 
       RowBox[{"\[LeftAngleBracket]", 
        SubscriptBox[
         OverscriptBox["n", "^"], 
         RowBox[{"i", ",", "\[DownArrow]"}]], "\[RightAngleBracket]"}]}], "+", 
      RowBox[{
       SubscriptBox[
        OverscriptBox["n", "^"], 
        RowBox[{"i", ",", "\[DownArrow]"}]], 
       RowBox[{"\[LeftAngleBracket]", 
        SubscriptBox[
         OverscriptBox["n", "^"], 
         RowBox[{"i", ",", "\[UpArrow]"}]], "\[RightAngleBracket]"}]}], "-", 
      RowBox[{
       RowBox[{"\[LeftAngleBracket]", 
        SubscriptBox[
         OverscriptBox["n", "^"], 
         RowBox[{"i", ",", "\[UpArrow]"}]], "\[RightAngleBracket]"}], 
       RowBox[{"\[LeftAngleBracket]", 
        SubscriptBox[
         OverscriptBox["n", "^"], 
         RowBox[{"i", ",", "\[DownArrow]"}]], 
        "\[RightAngleBracket]"}]}]}]}]}]}], 
  TraditionalForm]], \
"InlineMath",ExpressionUUID->"e10f1378-586f-4203-83e3-5196a848957c"]], "Text",
 CellChangeTimes->{{3.878373740156253*^9, 3.8783740122198267`*^9}, {
  3.8783749357497406`*^9, 3.8783749367297564`*^9}},
 CellID->610935084,ExpressionUUID->"a7afd486-0cb6-4c9c-a848-567cb34bdf32"],

Cell["Thus, the Hubbard mean field model is", "Text",
 CellChangeTimes->{{3.878374144360144*^9, 3.878374195948005*^9}},
 CellID->513880676,ExpressionUUID->"c0bbfc22-4877-4d7d-9f68-57276250cab3"],

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox[
    OverscriptBox["H", "^"], "H"], "=", 
   RowBox[{
    RowBox[{
     UnderscriptBox["\[Sum]", 
      RowBox[{" ", 
       RowBox[{"i", ",", "j", ",", "\[Sigma]"}]}]], 
     RowBox[{
      SubscriptBox["t", 
       RowBox[{"i", ",", "j"}]], 
      SubsuperscriptBox[
       OverscriptBox["c", "^"], 
       RowBox[{"i", ",", "\[Sigma]"}], "\[Dagger]"], 
      SubscriptBox[
       OverscriptBox["c", "^"], 
       RowBox[{"j", ",", "\[Sigma]"}]]}]}], "+", 
    RowBox[{"U", " ", 
     RowBox[{
      UnderscriptBox["\[Sum]", 
       RowBox[{" ", "i"}]], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox[
          OverscriptBox["n", "^"], 
          RowBox[{"i", ",", "\[UpArrow]"}]], 
         RowBox[{"\[LeftAngleBracket]", 
          SubscriptBox[
           OverscriptBox["n", "^"], 
           RowBox[{"i", ",", "\[DownArrow]"}]], "\[RightAngleBracket]"}]}], 
        "+", 
        RowBox[{
         SubscriptBox[
          OverscriptBox["n", "^"], 
          RowBox[{"i", ",", "\[DownArrow]"}]], 
         RowBox[{"\[LeftAngleBracket]", 
          SubscriptBox[
           OverscriptBox["n", "^"], 
           RowBox[{"i", ",", "\[UpArrow]"}]], "\[RightAngleBracket]"}]}], "-", 
        RowBox[{
         RowBox[{"\[LeftAngleBracket]", 
          SubscriptBox[
           OverscriptBox["n", "^"], 
           RowBox[{"i", ",", "\[UpArrow]"}]], "\[RightAngleBracket]"}], 
         RowBox[{"\[LeftAngleBracket]", 
          SubscriptBox[
           OverscriptBox["n", "^"], 
           RowBox[{"i", ",", "\[DownArrow]"}]], "\[RightAngleBracket]"}]}]}], 
       ")"}]}]}]}]}], 
  TraditionalForm]], \
"InlineMath",ExpressionUUID->"add4a890-86aa-49ca-a780-1d95542ae85e"]], "Text",
 CellChangeTimes->{{3.878374222570566*^9, 3.8783742388071556`*^9}, {
  3.878374278782271*^9, 3.87837428544461*^9}, {3.878374933205701*^9, 
  3.878374938500784*^9}, {3.88824004455265*^9, 3.888240047192691*^9}, {
  3.8882405339998236`*^9, 3.888240536207359*^9}},
 CellID->968486772,ExpressionUUID->"6ea8e673-a7f0-442c-b343-561152c1fdee"],

Cell[TextData[{
 Cell[BoxData[
 "XXXXf"], "InlineFormula",ExpressionUUID->
  "b61700ce-dd6d-4145-809c-8653fc861eec"],
 " dkfsjdkf ",
 Cell[BoxData[
  FormBox[
   TemplateBox[<|"boxes" -> FormBox[
       FractionBox[
        StyleBox["x", "TI"], "2"], TraditionalForm], "errors" -> {}, "input" -> 
     "\\frac{x}{2}", "state" -> "Boxes"|>,
    "TeXAssistantTemplate"], TraditionalForm]],ExpressionUUID->
  "df345232-6ef8-7441-ad88-51c65915a6dd"],
 " - ",
 Cell[BoxData[
  FormBox[
   StyleBox[
    RowBox[{"T", 
     AdjustmentBox["E",
      BoxBaselineShift->0.5,
      BoxMargins->{{-0.3, 0}, {0, 0}}], "X"}],
    SingleLetterItalics->False], TraditionalForm]],ExpressionUUID->
  "85401da7-887a-db43-8a09-fbec079cd89e"],
 " fdjfsk ",
 Cell[BoxData[
  FormBox[
   StyleBox[
    RowBox[{
     SubscriptBox[
      OverscriptBox["H", "^"], "H"], "=", 
     RowBox[{
      RowBox[{
       UnderscriptBox["\[Sum]", 
        RowBox[{" ", 
         RowBox[{
          StyleBox["i", "TI"], ",", 
          StyleBox["j", "TI"], ",", 
          StyleBox["\[Sigma]", "TR"]}]}]], 
       RowBox[{
        SubscriptBox[
         StyleBox["t", "TI"], 
         RowBox[{
          StyleBox["i", "TI"], ",", 
          StyleBox["j", "TI"]}]], 
        SubsuperscriptBox[
         OverscriptBox[
          StyleBox["c", "TI"], "^"], 
         RowBox[{
          StyleBox["i", "TI"], ",", 
          StyleBox["\[Sigma]", "TR"]}], "\[Dagger]"], 
        SubscriptBox[
         OverscriptBox[
          StyleBox["c", "TI"], "^"], 
         RowBox[{
          StyleBox["j", "TI"], ",", 
          StyleBox["\[Sigma]", "TR"]}]]}]}], "+", 
      RowBox[{"U", " ", 
       RowBox[{
        UnderscriptBox["\[Sum]", 
         RowBox[{" ", 
          StyleBox["i", "TI"]}]], 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           SubscriptBox[
            OverscriptBox[
             StyleBox["n", "TI"], "^"], 
            RowBox[{
             StyleBox["i", "TI"], ",", "\[UpArrow]"}]], 
           RowBox[{"\[LeftAngleBracket]", 
            SubscriptBox[
             OverscriptBox[
              StyleBox["n", "TI"], "^"], 
             RowBox[{
              StyleBox["i", "TI"], ",", "\[DownArrow]"}]], 
            "\[RightAngleBracket]"}]}], "+", 
          RowBox[{
           SubscriptBox[
            OverscriptBox[
             StyleBox["n", "TI"], "^"], 
            RowBox[{
             StyleBox["i", "TI"], ",", "\[DownArrow]"}]], 
           RowBox[{"\[LeftAngleBracket]", 
            SubscriptBox[
             OverscriptBox[
              StyleBox["n", "TI"], "^"], 
             RowBox[{
              StyleBox["i", "TI"], ",", "\[UpArrow]"}]], 
            "\[RightAngleBracket]"}]}], "-", 
          RowBox[{
           RowBox[{"\[LeftAngleBracket]", 
            SubscriptBox[
             OverscriptBox[
              StyleBox["n", "TI"], "^"], 
             RowBox[{
              StyleBox["i", "TI"], ",", "\[UpArrow]"}]], 
            "\[RightAngleBracket]"}], 
           RowBox[{"\[LeftAngleBracket]", 
            SubscriptBox[
             OverscriptBox[
              StyleBox["n", "TI"], "^"], 
             RowBox[{
              StyleBox["i", "TI"], ",", "\[DownArrow]"}]], 
            "\[RightAngleBracket]"}]}]}], ")"}]}]}]}]}], "DisplayMath"], 
   TraditionalForm]], "InlineFormula",
  Background->RGBColor[0.87, 0.94, 1],ExpressionUUID->
  "79aa7aa4-4f12-2f43-9870-ffd976620cb0"]
}], "Text",
 CellChangeTimes->{{3.927797891695486*^9, 3.92779793188888*^9}, 
   3.9277980373907604`*^9, {3.927798077732836*^9, 3.9277981518447266`*^9}, 
   3.9277981912859745`*^9, {3.9277982600136814`*^9, 3.927798309620201*^9}, {
   3.927798343507885*^9, 3.927798344235935*^9}},
 CellID->50592848,ExpressionUUID->"146109dd-06f8-7f44-a838-2de64e495817"],

Cell["\<\
Finally, for the periodic systems the Hamiltonian can be transformed to the \
Bloch basis. To do this, we recast summation over all atoms into double \
summation: the first one is over all unit cells and and the second one over \
all atoms in a unit cell. Thus, we have\
\>", "Text",
 CellChangeTimes->{{3.878374589010619*^9, 3.8783746359543433`*^9}, {
  3.8783748686617174`*^9, 3.878374917974286*^9}, {3.878464424177843*^9, 
  3.8784644277140446`*^9}, {3.878464698595539*^9, 3.8784647074470453`*^9}, {
  3.927797384206482*^9, 3.9277974373518124`*^9}, {3.9277975290265636`*^9, 
  3.9277976301603165`*^9}, {3.927797710446335*^9, 3.9277977104503384`*^9}},
 CellID->711149020,ExpressionUUID->"436b25c7-f3fb-4d87-b665-451eb19cc889"],

Cell["\<\
the<explanation here, change of the summation index i to summation over the \
unit cells and intracell atoms> with the following Fourier transforms for the \
creation and annihilation operators:\
\>", "Text",
 CellChangeTimes->{{3.878374589010619*^9, 3.8783746359543433`*^9}, {
  3.8783748686617174`*^9, 3.878374917974286*^9}, {3.878464424177843*^9, 
  3.8784644277140446`*^9}, {3.878464698595539*^9, 3.8784647074470453`*^9}, {
  3.927797384206482*^9, 3.9277974373518124`*^9}, {3.9277975290265636`*^9, 
  3.9277976301603165`*^9}},
 CellID->10684558,ExpressionUUID->"20cd8010-c590-f548-8674-072c6dbec213"],

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   SubsuperscriptBox[
    OverscriptBox["c", "^"], 
    RowBox[{"i", ",", "\[Sigma]"}], "\[Dagger]"], "=", 
   RowBox[{
    FractionBox["1", 
     SqrtBox["N"]], 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{" ", 
       RowBox[{"l", "=", "1"}]}], "N"], 
     RowBox[{
      SuperscriptBox["e", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], " ", 
        SubscriptBox[
         StyleBox["k",
          FontWeight->"Bold"], "l"], " ", 
        SubscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], "i"]}]], 
      SubsuperscriptBox[
       OverscriptBox["c", "^"], 
       RowBox[{
        SubscriptBox[
         StyleBox["k",
          FontWeight->"Bold"], "l"], ",", "\[Sigma]"}], "\[Dagger]"]}]}]}]}], 
  TraditionalForm]], \
"InlineMath",ExpressionUUID->"176506d8-5105-4737-b4b5-b68f6ff07468"]], "Text",
 CellChangeTimes->{{3.8783743249815483`*^9, 3.8783743446830587`*^9}, {
  3.8783744452483406`*^9, 3.878374497171518*^9}, {3.8783746492296343`*^9, 
  3.878374754559554*^9}, {3.87837481963701*^9, 3.87837481963701*^9}, {
  3.8783749263735943`*^9, 3.878374929161137*^9}, {3.8784645563834047`*^9, 
  3.878464559534585*^9}, {3.878464842918794*^9, 3.878464846956024*^9}},
 CellID->12107329,ExpressionUUID->"1f6e276c-c35a-4a4d-9115-3b3ff56fcd50"],

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox[
    OverscriptBox["c", "^"], 
    RowBox[{"i", ",", "\[Sigma]"}]], "=", 
   RowBox[{
    FractionBox["1", 
     SqrtBox["N"]], 
    RowBox[{
     UnderoverscriptBox["\[Sum]", 
      RowBox[{" ", 
       RowBox[{"l", "=", "1"}]}], "N"], 
     RowBox[{
      SuperscriptBox["e", 
       RowBox[{"\[ImaginaryI]", " ", 
        SubscriptBox[
         StyleBox["k",
          FontWeight->"Bold"], "l"], " ", 
        SubscriptBox[
         StyleBox["r",
          FontWeight->"Bold"], "i"]}]], 
      SubscriptBox[
       OverscriptBox["c", "^"], 
       RowBox[{
        SubscriptBox[
         StyleBox["k",
          FontWeight->"Bold"], "l"], ",", "\[Sigma]"}]]}]}]}]}], 
  TraditionalForm]], \
"InlineMath",ExpressionUUID->"e93e4886-1ec9-42e4-9901-db27097b4ec5"]], "Text",
 CellChangeTimes->{{3.878374838294297*^9, 3.8783748535715337`*^9}, {
  3.8783749243495207`*^9, 3.878374940352313*^9}, {3.8784645407155085`*^9, 
  3.878464553656248*^9}, {3.8784648531183767`*^9, 3.8784648531183767`*^9}},
 CellID->591970146,ExpressionUUID->"fa5780c0-e073-4622-bf89-901361a5df68"],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox["N", TraditionalForm]], "InlineMath",ExpressionUUID->
  "5653643b-8b3f-473f-830a-66d2d1f8e753"],
 " is the number of the unit cells, ",
 Cell[BoxData[
  FormBox["l", TraditionalForm]], "InlineMath",ExpressionUUID->
  "52e4552a-419b-43be-a9d0-dfd8689ef024"],
 " is the index numbering electronic states with different quasi-momenta and ",
 Cell[BoxData[
  FormBox[
   SubscriptBox[
    StyleBox["r",
     FontWeight->"Bold"], "i"], TraditionalForm]], "InlineMath",
  ExpressionUUID->"87fa6f9d-a934-4fdf-a8db-89ada784dbe0"],
 " is the position of the atomic site."
}], "Text",
 CellChangeTimes->{{3.8784644600108924`*^9, 3.8784645082486515`*^9}, {
  3.878464573138363*^9, 3.8784646620354476`*^9}, {3.878464724545023*^9, 
  3.878464733483534*^9}},
 CellID->706609024,ExpressionUUID->"e0e8778b-2a43-418c-b01c-0f5bb1da3aee"],

Cell["\<\
For the two atom unit cells, such transformation yields a 2 by 2 matrix for \
each spin species:\
\>", "Text",
 CellChangeTimes->{{3.878375079414489*^9, 3.87837511005496*^9}, {
  3.87837529988489*^9, 3.878375304888177*^9}, {3.878379628609149*^9, 
  3.878379628799152*^9}},
 CellID->707388835,ExpressionUUID->"d4d2b80c-5100-4987-a376-79d14031041d"],

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox["H", "\[UpArrow]"], "=", 
   RowBox[{"(", GridBox[{
      {
       RowBox[{"U", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[LeftAngleBracket]", 
           SubscriptBox[
            OverscriptBox["n", "^"], 
            RowBox[{"1", ",", "\[DownArrow]"}]], "\[RightAngleBracket]"}], 
          "+", 
          SubscriptBox["e", "U"]}], ")"}]}], 
       RowBox[{"t", " ", 
        SubscriptBox["\[Gamma]", 
         StyleBox["k",
          FontWeight->"Bold"]]}]},
      {
       RowBox[{"t", " ", 
        SubsuperscriptBox["\[Gamma]", 
         StyleBox["k",
          FontWeight->"Bold"], "*"]}], 
       RowBox[{"U", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[LeftAngleBracket]", 
           SubscriptBox[
            OverscriptBox["n", "^"], 
            RowBox[{"2", ",", "\[DownArrow]"}]], "\[RightAngleBracket]"}], 
          "+", 
          SubscriptBox["e", "U"]}], ")"}]}]}
     }], ")"}]}], 
  TraditionalForm]], \
"InlineMath",ExpressionUUID->"cb8b7b47-49da-4f7f-82b8-b9c219a04301"]], "Text",
 CellChangeTimes->{{3.8783751521919656`*^9, 3.878375328411891*^9}, {
  3.8783791378243303`*^9, 3.8783792329728346`*^9}, {3.87837944296908*^9, 
  3.878379486769765*^9}},
 CellID->70986363,ExpressionUUID->"02d93cce-a5cb-402c-b7db-3df505dbd2f7"],

Cell["and", "Text",
 CellChangeTimes->{{3.8783792391044283`*^9, 3.878379242731986*^9}},
 CellID->253226891,ExpressionUUID->"6de84716-6724-43d1-b5f4-105c432a8c1f"],

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   SubscriptBox["H", "\[DownArrow]"], "=", 
   RowBox[{"(", GridBox[{
      {
       RowBox[{"U", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[LeftAngleBracket]", 
           SubscriptBox[
            OverscriptBox["n", "^"], 
            RowBox[{"1", ",", "\[UpArrow]"}]], "\[RightAngleBracket]"}], "+", 
          SubscriptBox["e", "U"]}], ")"}]}], 
       RowBox[{"t", " ", 
        SubscriptBox["\[Gamma]", 
         StyleBox["k",
          FontWeight->"Bold"]]}]},
      {
       RowBox[{"t", " ", 
        SubsuperscriptBox["\[Gamma]", 
         StyleBox["k",
          FontWeight->"Bold"], "*"]}], 
       RowBox[{"U", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"\[LeftAngleBracket]", 
           SubscriptBox[
            OverscriptBox["n", "^"], 
            RowBox[{"2", ",", "\[UpArrow]"}]], "\[RightAngleBracket]"}], "+", 
          SubscriptBox["e", "U"]}], ")"}]}]}
     }], ")"}]}], 
  TraditionalForm]], \
"InlineMath",ExpressionUUID->"987c8708-05dc-41c1-aa3c-070ede0aa8e5"]], "Text",
 CellChangeTimes->{{3.8783751521919656`*^9, 3.878375328411891*^9}, {
  3.8783791378243303`*^9, 3.878379234822863*^9}, {3.878379600281671*^9, 
  3.8783796183454494`*^9}},
 CellID->273828738,ExpressionUUID->"07db1f46-6861-4bb9-a886-47415f93460c"],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Gamma]", 
    StyleBox["k",
     FontWeight->"Bold"]], TraditionalForm]], "InlineMath",ExpressionUUID->
  "6918dfee-ca7f-4d54-b7c3-6f02d5f0e11a"],
 " is the phase factor that depends on the type of the crystal lattice and ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["e", "U"], "=", 
    RowBox[{"-", 
     RowBox[{
      UnderscriptBox["\[Sum]", 
       RowBox[{" ", "i"}]], 
      RowBox[{
       RowBox[{"\[LeftAngleBracket]", 
        SubscriptBox[
         OverscriptBox["n", "^"], 
         RowBox[{"i", ",", "\[UpArrow]"}]], "\[RightAngleBracket]"}], 
       RowBox[{"\[LeftAngleBracket]", 
        SubscriptBox[
         OverscriptBox["n", "^"], 
         RowBox[{"i", ",", "\[DownArrow]"}]], 
        "\[RightAngleBracket]"}]}]}]}]}], TraditionalForm]], "InlineMath",
  ExpressionUUID->"c12e631f-d51e-4f3a-92b4-bbb759964c2d"],
 " so that ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SubscriptBox["E", "U"], "=", 
    RowBox[{"U", " ", 
     SubscriptBox["e", "U"]}]}], TraditionalForm]], "InlineMath",
  ExpressionUUID->"73739144-7131-4c41-8ae8-e426c3f83b46"],
 " is the constant energy term for the given number of particles and spin \
configuration. Despite being merely a constant shifting the electronic band \
structure as a whole, ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["E", "U"], TraditionalForm]], "InlineMath",ExpressionUUID->
  "2802d146-b8f5-489e-8331-cb1013fd0be6"],
 "-term must be added to the problem as sometimes it favors paramagnetic \
configuration, ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"\[LeftAngleBracket]", 
     SubscriptBox[
      OverscriptBox["n", "^"], 
      RowBox[{"i", ",", "\[UpArrow]"}]], "\[RightAngleBracket]"}], "=", 
    RowBox[{"\[LeftAngleBracket]", 
     SubscriptBox[
      OverscriptBox["n", "^"], 
      RowBox[{"i", ",", "\[DownArrow]"}]], "\[RightAngleBracket]"}]}], 
   TraditionalForm]], "InlineMath",ExpressionUUID->
  "eb6aaff3-01eb-45cf-ba37-10d4a9124d25"],
 ", with respect to the ferromagnetic and antiferromagnetic ones and plays an \
important role in magnetic phase diagrams. "
}], "Text",
 CellChangeTimes->{{3.878375480698194*^9, 3.878375512529648*^9}, {
  3.8783794215119147`*^9, 3.8783794356506605`*^9}, {3.878379489182802*^9, 
  3.87837958973575*^9}, {3.878379673882574*^9, 3.878379997757599*^9}, {
  3.888239082163191*^9, 3.888239102023512*^9}, {3.8882400666834955`*^9, 
  3.8882400695735397`*^9}, {3.888240137240264*^9, 3.888240139308382*^9}, {
  3.8882401769889197`*^9, 3.8882401968472333`*^9}, {3.88824026629236*^9, 
  3.888240345386717*^9}, {3.8882403958551908`*^9, 3.888240396170209*^9}, {
  3.888240999817293*^9, 3.888241007777416*^9}},
 CellID->80053891,ExpressionUUID->"5341fae3-4658-4baa-8520-981cf7a564fe"],

Cell[TextData[{
 StyleBox["Note:",
  FontWeight->"Bold"],
 " The spin-up matrix Hamiltonian depends on the mean occupation number of \
the spin-down electron. Similar relation takes place for spin-down \
Hamiltonian and the mean occupation numbers for the spin-up electron."
}], "Text",
 CellChangeTimes->{{3.878375337062025*^9, 3.87837547009403*^9}, {
  3.888241185285262*^9, 3.888241191737297*^9}},
 CellID->327927258,ExpressionUUID->"f345168b-17c5-4d39-a1d7-64d0b52ab919"],

Cell["\<\
The full Hamiltonian is a direct sum of the spin-up and spin-down \
Hamiltonians:\
\>", "Text",
 CellChangeTimes->{{3.8783755980348544`*^9, 3.878375610924351*^9}, {
  3.878376509452859*^9, 3.878376577684974*^9}, {3.8783766125804195`*^9, 
  3.878376614140444*^9}, {3.878376665242673*^9, 3.8783766654151754`*^9}},
 CellID->357310156,ExpressionUUID->"fd6b4bd2-833e-498a-87f0-7170adeeefdb"],

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{"H", "=", 
   RowBox[{
    RowBox[{
     SubscriptBox["H", "\[UpArrow]"], "\[CirclePlus]", 
     SubscriptBox["H", "\[DownArrow]"]}], "=", 
    RowBox[{
     RowBox[{"(", GridBox[{
        {
         SubscriptBox["H", "\[UpArrow]"], 
         StyleBox["0",
          FontWeight->"Bold"]},
        {
         StyleBox["0",
          FontWeight->"Bold"], 
         SubscriptBox["H", "\[DownArrow]"]}
       }], ")"}], "=", 
     RowBox[{"(", GridBox[{
        {
         RowBox[{"U", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[LeftAngleBracket]", 
             SubscriptBox[
              OverscriptBox["n", "^"], 
              RowBox[{"1", ",", "\[DownArrow]"}]], "\[RightAngleBracket]"}], 
            "+", 
            SubscriptBox["e", "U"]}], ")"}]}], 
         RowBox[{"t", " ", 
          SubscriptBox["\[Gamma]", 
           StyleBox["k",
            FontWeight->"Bold"]]}], "0", "0"},
        {
         RowBox[{"t", " ", 
          SubsuperscriptBox["\[Gamma]", 
           StyleBox["k",
            FontWeight->"Bold"], "*"]}], 
         RowBox[{"U", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[LeftAngleBracket]", 
             SubscriptBox[
              OverscriptBox["n", "^"], 
              RowBox[{"2", ",", "\[DownArrow]"}]], "\[RightAngleBracket]"}], 
            "+", 
            SubscriptBox["e", "U"]}], ")"}]}], "0", "0"},
        {"0", "0", 
         RowBox[{"U", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[LeftAngleBracket]", 
             SubscriptBox[
              OverscriptBox["n", "^"], 
              RowBox[{"1", ",", "\[UpArrow]"}]], "\[RightAngleBracket]"}], 
            "+", 
            SubscriptBox["e", "U"]}], ")"}]}], 
         RowBox[{"t", " ", 
          SubscriptBox["\[Gamma]", 
           StyleBox["k",
            FontWeight->"Bold"]]}]},
        {"0", "0", 
         RowBox[{"t", " ", 
          SubsuperscriptBox["\[Gamma]", 
           StyleBox["k",
            FontWeight->"Bold"], "*"]}], 
         RowBox[{"U", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"\[LeftAngleBracket]", 
             SubscriptBox[
              OverscriptBox["n", "^"], 
              RowBox[{"2", ",", "\[UpArrow]"}]], "\[RightAngleBracket]"}], 
            "+", 
            SubscriptBox["e", "U"]}], ")"}]}]}
       }], ")"}]}]}]}], 
  TraditionalForm]], \
"InlineMath",ExpressionUUID->"93a5d0bc-d572-4f5c-9aff-b2ec567fb642"]], "Text",
 CellChangeTimes->{{3.878375585255655*^9, 3.87837559393179*^9}, {
  3.878376488469804*^9, 3.878376504024548*^9}, {3.878376585766099*^9, 
  3.878376653388989*^9}, {3.8783792779045796`*^9, 3.87837939470108*^9}, {
  3.878380133207325*^9, 3.878380133207325*^9}},
 CellID->453425570,ExpressionUUID->"47241bca-4c35-4b15-87dc-3f815aa47e7e"],

Cell[TextData[{
 "Since spin-up and down blocks are decoupled, eigen problems for them can be \
solved separately, which is much faster than solving an eigen problem for the \
single but twice larger matrix. The spin-up and down solutions are linked via \
the on-site spin occupation numbers ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[LeftAngleBracket]", 
    SubscriptBox[
     OverscriptBox["n", "^"], 
     RowBox[{"i", ",", "\[Sigma]"}]], "\[RightAngleBracket]"}], 
   TraditionalForm]], "InlineMath",ExpressionUUID->
  "5d7a8340-c2f9-4b57-ab46-f6a2014cf9cb"],
 ". The occupation numbers, in turn, are linked to the eigenvectors of the \
corresponding eigen problem. Thus, the problem shall be solved \
self-consistently, i.e. by taking some trial spin configuration and iterating \
it until convergence is achieved, when mean occupation numbers ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[LeftAngleBracket]", 
    SubscriptBox[
     OverscriptBox["n", "^"], 
     RowBox[{"i", ",", "\[Sigma]"}]], "\[RightAngleBracket]"}], 
   TraditionalForm]], "InlineMath",ExpressionUUID->
  "e1b9a45c-c912-4f7c-a50d-f14d4e290a90"],
 " are not changing anymore within the chosen tolerance, ",
 Cell[BoxData[
  FormBox["\[Epsilon]", TraditionalForm]], "InlineMath",
  FontSlant->"Italic",ExpressionUUID->"ec53d041-cc89-4862-bc31-2a8ccdefcaef"],
 ": ",
 Cell[BoxData[
  FormBox[
   RowBox[{"|", 
    RowBox[{
     SubscriptBox[
      RowBox[{"\[LeftAngleBracket]", 
       SubscriptBox[
        OverscriptBox["n", "^"], 
        RowBox[{"i", ",", "\[Sigma]"}]], "\[RightAngleBracket]"}], "m"], "-", 
     SubscriptBox[
      RowBox[{"\[LeftAngleBracket]", 
       SubscriptBox[
        OverscriptBox["n", "^"], 
        RowBox[{"i", ",", "\[Sigma]"}]], "\[RightAngleBracket]"}], 
      RowBox[{"m", "-", "1"}]]}], "|", 
    RowBox[{"<", 
     StyleBox["\[Epsilon]",
      FontSlant->"Italic"]}]}], TraditionalForm]], "InlineMath",
  ExpressionUUID->"9ea8890f-7402-4dd8-bad0-5ae4bf34edeb"],
 ", where ",
 Cell[BoxData[
  FormBox["m", TraditionalForm]], "InlineMath",ExpressionUUID->
  "669d76d9-72cf-40f1-8c50-7484d2cf5026"],
 " is the iteration number."
}], "Text",
 CellChangeTimes->{{3.878376669963746*^9, 3.878376704732881*^9}, {
   3.878376758521659*^9, 3.8783773321967382`*^9}, {3.8783774152178*^9, 
   3.878377562926238*^9}, {3.878380183104636*^9, 3.8783802210456514`*^9}, {
   3.878380253580331*^9, 3.878380283418867*^9}, {3.878465028790425*^9, 
   3.878465043438263*^9}, 3.88824123907678*^9, 3.9277961900471*^9},
 CellID->223785096,ExpressionUUID->"75c3bd3f-1a49-417a-ad80-723481df5009"],

Cell["The mean occupation numbers can be calculated as follows", "Text",
 CellChangeTimes->{{3.878380299283139*^9, 3.878380317790424*^9}},
 CellID->26141655,ExpressionUUID->"9ccd6dc8-2b14-401a-9894-06f69a31794c"],

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{"\[LeftAngleBracket]", 
    SubscriptBox[
     OverscriptBox["n", "^"], 
     RowBox[{"i", ",", "\[Sigma]"}]], "\[RightAngleBracket]"}], "=", 
   RowBox[{
    FractionBox["1", "N"], 
    RowBox[{
     UnderscriptBox["\[Sum]", 
      RowBox[{" ", 
       RowBox[{
        StyleBox["k",
         FontWeight->"Bold"], ",", "j"}]}]], 
     RowBox[{
      SuperscriptBox[
       RowBox[{"\[LeftBracketingBar]", 
        RowBox[{
         SubscriptBox["C", 
          RowBox[{"i", ",", "j", ",", "\[Sigma]"}]], "(", 
         StyleBox["k",
          FontWeight->"Bold"], ")"}], "\[RightBracketingBar]"}], "2"], 
      RowBox[{"f", "(", 
       RowBox[{
        RowBox[{"\[ScriptCapitalE]", "(", 
         RowBox[{
          StyleBox["k",
           FontWeight->"Bold"], 
          StyleBox[",",
           FontWeight->"Plain"], 
          StyleBox["j",
           FontWeight->"Plain"], 
          StyleBox[",",
           FontWeight->"Plain"], 
          StyleBox["\[Sigma]",
           FontWeight->"Plain"]}], ")"}], ",", "\[Mu]"}], ")"}]}]}]}]}], 
  TraditionalForm]], \
"InlineMath",ExpressionUUID->"570a7cbb-890b-4cbf-930c-58831f9380a2"]], "Text",
 CellChangeTimes->{{3.878377593224211*^9, 3.878377603632414*^9}, {
  3.8783776690120025`*^9, 3.878377929039872*^9}},
 CellID->135951613,ExpressionUUID->"350d62af-4853-4e60-94c0-aba0431aaa5e"],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[ScriptCapitalE]", "(", 
    RowBox[{
     StyleBox["k",
      FontWeight->"Bold"], 
     StyleBox[",",
      FontWeight->"Plain"], 
     StyleBox["j",
      FontWeight->"Plain"], 
     StyleBox[",",
      FontWeight->"Plain"], 
     StyleBox["\[Sigma]",
      FontWeight->"Plain"]}], ")"}], TraditionalForm]], "InlineMath",
  ExpressionUUID->"c022f9b4-0a4f-489d-b429-de996f1bf1ff"],
 " is the eigenvalue and ",
 Cell[BoxData[
  FormBox[
   RowBox[{"f", "(", 
    RowBox[{
     RowBox[{"\[ScriptCapitalE]", "(", 
      RowBox[{
       StyleBox["k",
        FontWeight->"Bold"], 
       StyleBox[",",
        FontWeight->"Plain"], 
       StyleBox["j",
        FontWeight->"Plain"], 
       StyleBox[",",
        FontWeight->"Plain"], 
       StyleBox["\[Sigma]",
        FontWeight->"Plain"]}], ")"}], ",", "\[Mu]"}], ")"}], 
   TraditionalForm]], "InlineMath",ExpressionUUID->
  "a69b3919-af99-4dc1-b49e-be26131c3e51"],
 " is the Fermi-Dirac distribution with ",
 Cell[BoxData[
  FormBox["\[Mu]", TraditionalForm]], "InlineMath",ExpressionUUID->
  "4407760e-8f8c-458f-9507-350cd1360dfa"],
 " being the chemical potential defined implicitly by the following equation:"
}], "Text",
 CellChangeTimes->{{3.878133097379258*^9, 3.878133127550984*^9}, {
  3.878377942069154*^9, 3.878377998864032*^9}, {3.878378090689593*^9, 
  3.878378106405834*^9}, {3.8784651514314394`*^9, 3.8784651525885053`*^9}, {
  3.8784652585945687`*^9, 3.87846528169189*^9}},
 CellID->288067883,ExpressionUUID->"045ae40e-a52d-42aa-91af-44d85191dd5f"],

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{
   RowBox[{
    UnderscriptBox["\[Sum]", 
     RowBox[{" ", 
      RowBox[{
       StyleBox["k",
        FontWeight->"Bold"], ",", "j", ",", " ", "\[Sigma]"}]}]], 
    RowBox[{"f", "(", 
     RowBox[{
      RowBox[{"\[ScriptCapitalE]", "(", 
       RowBox[{
        StyleBox["k",
         FontWeight->"Bold"], 
        StyleBox[",",
         FontWeight->"Plain"], 
        StyleBox["j",
         FontWeight->"Plain"], 
        StyleBox[",",
         FontWeight->"Plain"], 
        StyleBox["\[Sigma]",
         FontWeight->"Plain"]}], ")"}], ",", "\[Mu]"}], ")"}]}], "=", 
   SubscriptBox["n", "e"]}], 
  TraditionalForm]], \
"InlineMath",ExpressionUUID->"5d447bf8-5017-4c6e-90c6-4fad7dcfda14"]], "Text",
 CellChangeTimes->{{3.8781330695096645`*^9, 3.8781330805802975`*^9}, {
  3.8783780200079675`*^9, 3.878378083009474*^9}, {3.878380339802265*^9, 
  3.878380370955611*^9}},
 CellID->558645,ExpressionUUID->"6af06849-6f78-485e-859c-0b87857534ef"],

Cell[TextData[{
 "where ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["n", "e"], TraditionalForm]], "InlineMath",ExpressionUUID->
  "673910af-4454-4fba-bbbc-9a0e0a597037"],
 " is the number of electrons in the molecule or in the crystal unit cell and \
the summation is run over all energy bands, ",
 Cell[BoxData[
  FormBox["j", TraditionalForm]], "InlineMath",ExpressionUUID->
  "d31ede78-d0c8-4849-854c-751187b49d20"],
 ", spins, ",
 Cell[BoxData[
  FormBox["\[Sigma]", TraditionalForm]], "InlineMath",ExpressionUUID->
  "801f133f-01ac-47e4-99ea-286fb7455915"],
 ", and all ",
 Cell[BoxData[
  FormBox[
   StyleBox["k",
    FontWeight->"Bold"], TraditionalForm]], "InlineMath",ExpressionUUID->
  "025d3601-78e5-4b9b-b869-ed2a209364d1"],
 "-points in case of the crystals."
}], "Text",
 CellChangeTimes->{{3.8783781107524023`*^9, 3.8783781681633716`*^9}, {
  3.878378219068047*^9, 3.878378289777261*^9}, {3.8783783252819357`*^9, 
  3.878378325286936*^9}, {3.878380380507365*^9, 3.878380431872401*^9}, {
  3.878465209906784*^9, 3.87846523046496*^9}, {3.878465356910192*^9, 
  3.878465408398137*^9}},
 CellID->277095794,ExpressionUUID->"2c09ea12-e815-4497-8370-154583b7ac71"],

Cell["\<\
By running iterative procedure from the different initial spin configurations \
several final output configurations corresponding to distinct spin-polarized \
or spin non-polarized band structures can be obtained. Which one is the \
thermodynamically stable one is defined by the system total energy. In the \
case of the finite temperature calculations, the total energy shall be, of \
course, replaced by the free energy.\
\>", "Text",
 CellChangeTimes->{{3.8783804491493464`*^9, 3.8783806575213337`*^9}, {
  3.878465435951713*^9, 3.878465452245645*^9}, {3.888241281336909*^9, 
  3.8882413904395304`*^9}},
 CellID->430520891,ExpressionUUID->"f04b6401-4706-4920-9326-b6f49f3e6144"],

Cell[TextData[{
 "The free energy is ",
 Cell[BoxData[
  FormBox[
   RowBox[{"F", "=", 
    RowBox[{"E", "-", 
     RowBox[{"T", " ", "S"}]}]}], TraditionalForm]], "InlineMath",
  ExpressionUUID->"b70b3e9e-407d-4324-943e-d38e230e180e"],
 ", where ",
 Cell[BoxData[
  FormBox["E", TraditionalForm]], "InlineMath",ExpressionUUID->
  "a7d783a9-a2fc-4603-9c79-16d867e9b859"],
 " is the mean total energy, ",
 Cell[BoxData[
  FormBox["T", TraditionalForm]], "InlineMath",ExpressionUUID->
  "643cef25-7296-41ad-8ecd-a0578e3d4af4"],
 " is the absolute temperature and ",
 Cell[BoxData[
  FormBox["S", TraditionalForm]], "InlineMath",ExpressionUUID->
  "b319c6d5-3ef1-40a7-bcef-93f0587d55b8"],
 " is the entropy:"
}], "Text",
 CellChangeTimes->{{3.8783781107524023`*^9, 3.8783781681633716`*^9}, {
  3.878378219068047*^9, 3.878378289777261*^9}, {3.8783783274704905`*^9, 
  3.8783783447902775`*^9}, {3.8783806869296207`*^9, 3.878380785102558*^9}, {
  3.8784654707117004`*^9, 3.878465471009718*^9}},
 CellID->240321390,ExpressionUUID->"8fc728a6-7e3d-4ceb-9351-0e88ed4e30e3"],

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{"E", "=", 
   RowBox[{
    UnderscriptBox["\[Sum]", 
     RowBox[{
      StyleBox["k",
       FontWeight->"Bold"], ",", "j", ",", "\[Sigma]"}]], 
    RowBox[{
     RowBox[{"\[ScriptCapitalE]", "(", 
      RowBox[{
       StyleBox["k",
        FontWeight->"Bold"], 
       StyleBox[",",
        FontWeight->"Plain"], 
       StyleBox["j",
        FontWeight->"Plain"], 
       StyleBox[",",
        FontWeight->"Plain"], 
       StyleBox["\[Sigma]",
        FontWeight->"Plain"]}], ")"}], " ", 
     RowBox[{"f", "(", 
      RowBox[{
       RowBox[{"\[ScriptCapitalE]", "(", 
        RowBox[{
         StyleBox["k",
          FontWeight->"Bold"], 
         StyleBox[",",
          FontWeight->"Plain"], 
         StyleBox["j",
          FontWeight->"Plain"], 
         StyleBox[",",
          FontWeight->"Plain"], 
         StyleBox["\[Sigma]",
          FontWeight->"Plain"]}], ")"}], ",", "\[Mu]"}], ")"}]}]}]}], 
  TraditionalForm]], \
"InlineMath",ExpressionUUID->"bf07b598-7fe7-4d6f-8e96-686dcef7e3f4"]], "Text",
 CellChangeTimes->{{3.8783783541674213`*^9, 3.878378356302455*^9}, {
  3.87838080595388*^9, 3.878380876165861*^9}},
 CellID->58174926,ExpressionUUID->"e9188e2d-29c5-4239-9319-fc1875d8831d"],

Cell[TextData[Cell[BoxData[
 FormBox[
  RowBox[{"S", "=", 
   RowBox[{
    RowBox[{
     SubscriptBox["k", "B"], 
     RowBox[{
      UnderscriptBox["\[Sum]", 
       RowBox[{
        StyleBox["k",
         FontWeight->"Bold"], ",", "j", ",", "\[Sigma]"}]], 
      RowBox[{
       RowBox[{"f", "(", 
        RowBox[{
         RowBox[{"\[ScriptCapitalE]", "(", 
          RowBox[{
           StyleBox["k",
            FontWeight->"Bold"], 
           StyleBox[",",
            FontWeight->"Plain"], 
           StyleBox["j",
            FontWeight->"Plain"], 
           StyleBox[",",
            FontWeight->"Plain"], 
           StyleBox["\[Sigma]",
            FontWeight->"Plain"]}], ")"}], ",", "\[Mu]"}], ")"}], 
       RowBox[{"Log", "[", 
        RowBox[{"f", "(", 
         RowBox[{
          RowBox[{"\[ScriptCapitalE]", "(", 
           RowBox[{
            StyleBox["k",
             FontWeight->"Bold"], 
            StyleBox[",",
             FontWeight->"Plain"], 
            StyleBox["j",
             FontWeight->"Plain"], 
            StyleBox[",",
             FontWeight->"Plain"], 
            StyleBox["\[Sigma]",
             FontWeight->"Plain"]}], ")"}], ",", "\[Mu]"}], ")"}], 
        "]"}]}]}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"f", "(", 
        RowBox[{
         RowBox[{"\[ScriptCapitalE]", "(", 
          RowBox[{
           StyleBox["k",
            FontWeight->"Bold"], 
           StyleBox[",",
            FontWeight->"Plain"], 
           StyleBox["j",
            FontWeight->"Plain"], 
           StyleBox[",",
            FontWeight->"Plain"], 
           StyleBox["\[Sigma]",
            FontWeight->"Plain"]}], ")"}], ",", "\[Mu]"}], ")"}]}], ")"}], 
     RowBox[{"Log", "[", 
      RowBox[{"1", "-", 
       RowBox[{"f", "(", 
        RowBox[{
         RowBox[{"\[ScriptCapitalE]", "(", 
          RowBox[{
           StyleBox["k",
            FontWeight->"Bold"], 
           StyleBox[",",
            FontWeight->"Plain"], 
           StyleBox["j",
            FontWeight->"Plain"], 
           StyleBox[",",
            FontWeight->"Plain"], 
           StyleBox["\[Sigma]",
            FontWeight->"Plain"]}], ")"}], ",", "\[Mu]"}], ")"}]}], 
      "]"}]}]}]}], 
  TraditionalForm]], \
"InlineMath",ExpressionUUID->"8f00021c-17d2-43d2-a072-00793c4242bc"]], "Text",
 CellChangeTimes->{{3.878380883553987*^9, 3.878380888413265*^9}, {
  3.8783809227461586`*^9, 3.878380947169699*^9}, {3.878381069143451*^9, 
  3.8783810942873387`*^9}},
 CellID->85753493,ExpressionUUID->"e6d5107c-b29a-4bdc-b001-9dd696c0dcb7"],

Cell[TextData[{
 "with ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["k", "B"], TraditionalForm]], "InlineMath",ExpressionUUID->
  "14776078-4569-4b9b-9e5f-75d0226f471e"],
 " being the Boltzmann constant."
}], "Text",
 CellChangeTimes->{{3.8783811447066054`*^9, 3.878381203653454*^9}},
 CellID->57861609,ExpressionUUID->"1c0a8662-3520-4bf1-8dad-1a06506ff1d2"],

Cell[TextData[{
 StyleBox["Note:",
  FontWeight->"Bold"],
 " In contrast to ",
 ButtonBox["Y. Claveau, B. Arnaud, and S. Di Matteo, ",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1088/0143-0807/35/3/035023"], None}],
 StyleBox[ButtonBox["Eur. J. Phys.",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1088/0143-0807/35/3/035023"], None}],
  FontSlant->"Italic"],
 ButtonBox[" ",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1088/0143-0807/35/3/035023"], None}],
 StyleBox[ButtonBox["35",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1088/0143-0807/35/3/035023"], None}],
  FontWeight->"Bold"],
 ButtonBox[", 035023 (2014)",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1088/0143-0807/35/3/035023"], None}],
 ", the above formulation avoids introduction of the density of states per \
energy as well as integration over energy in the implicit equation for the \
chemical potential and the free energy (inner energy and entropy). Instead we \
utilize summation over the all bands, spins and ",
 Cell[BoxData[
  FormBox[
   StyleBox["k",
    FontWeight->"Bold"], TraditionalForm]], "InlineMath",ExpressionUUID->
  "1d3f70cf-3127-4133-bd8a-544417010e52"],
 "-points. The two approaches are fully equivalent and, in fact, coincide as \
the number of ",
 Cell[BoxData[
  FormBox[
   StyleBox["k",
    FontWeight->"Bold"], TraditionalForm]], "InlineMath",ExpressionUUID->
  "61704fab-716b-4b5a-836a-f2b97b757e35"],
 "-points increases. The latter, however, is much faster since its \
realization requires less computational operations. In addition, it avoids \
introducing additional artificial parameters such as Gaussian broadening in \
the ",
 Cell[BoxData[
  FormBox["\[Delta]", TraditionalForm]], "InlineMath",ExpressionUUID->
  "9d4421bb-9325-47ed-9d4e-70c154d2036c"],
 "-function numerical representation. Therefore, this faster approach is \
presented and implemented below."
}], "Text",
 CellChangeTimes->{{3.878381213404436*^9, 3.878381437979105*^9}, {
  3.8783815532357407`*^9, 3.878381859286038*^9}, {3.878465536015436*^9, 
  3.878465538037552*^9}, {3.87846557157347*^9, 3.878465716076735*^9}, {
  3.8784657511707425`*^9, 3.8784657901569724`*^9}, {3.8882414955312667`*^9, 
  3.888241543848344*^9}},
 CellID->13211328,ExpressionUUID->"4e681a1c-28b6-4e42-8cc3-83828b22e10c"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Basic code", "Subsection",
 CellChangeTimes->{{3.8781264208703837`*^9, 3.878126447641916*^9}},
 CellID->262340085,ExpressionUUID->"96936a3e-8ce9-45c6-8399-27c027ff80ab"],

Cell[TextData[{
 "This section follows the logical block-scheme presented in Fig. 3 of ",
 ButtonBox["Y. Claveau, B. Arnaud, and S. Di Matteo, ",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1088/0143-0807/35/3/035023"], None}],
 StyleBox[ButtonBox["Eur. J. Phys.",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1088/0143-0807/35/3/035023"], None}],
  FontSlant->"Italic"],
 ButtonBox[" ",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1088/0143-0807/35/3/035023"], None}],
 StyleBox[ButtonBox["35",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1088/0143-0807/35/3/035023"], None}],
  FontWeight->"Bold"],
 ButtonBox[", 035023 (2014)",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1088/0143-0807/35/3/035023"], None}],
 ", with the only amendment that it implements the theoretical realization \
introduced in the previous section ",
 ButtonBox["\"Basic theory\"",
  BaseStyle->"Link",
  ButtonData->"paclet:TBpack/tutorial/HubbardMeanFieldModel#99497867"],
 "."
}], "Text",
 CellChangeTimes->{{3.8781303082387285`*^9, 3.878130333947199*^9}, {
   3.878130364402941*^9, 3.878130365044978*^9}, {3.87813047190909*^9, 
   3.878130472011096*^9}, {3.878130530689452*^9, 3.878130540396008*^9}, {
   3.878465851160461*^9, 3.878465944523802*^9}, 3.878465982993002*^9, {
   3.878466171666794*^9, 3.87846618191738*^9}, {3.878466676334658*^9, 
   3.878466714596847*^9}},
 CellID->142643545,ExpressionUUID->"64c244e7-ce53-4397-8104-99869502c572"],

Cell["\<\
Some functions in this subsection are complied for performance, therefore, \
before dealing with them, it is useful to familiarize yourself with several \
related tutorials:\
\>", "Text",
 CellChangeTimes->{{3.878466229792118*^9, 3.878466268040306*^9}, {
   3.878466378874645*^9, 3.878466402682007*^9}, {3.878466732688882*^9, 
   3.878466770332035*^9}, {3.878466983610234*^9, 3.878467019442283*^9}, 
   3.878469915711941*^9},
 CellID->981673901,ExpressionUUID->"08ea47d7-20a7-4a06-85c4-41d7b1b9b387"],

Cell[TextData[ButtonBox["Compiling Wolfram Language Expressions",
 BaseStyle->"Link",
 ButtonData->"tutorial/EvaluationOfExpressions#23811"]], "Text",
 CellChangeTimes->{{3.878466229792118*^9, 3.878466268040306*^9}, {
   3.878466378874645*^9, 3.878466402682007*^9}, {3.878466732688882*^9, 
   3.878466770332035*^9}, {3.878466983610234*^9, 3.878467029021831*^9}, {
   3.878467064808878*^9, 3.8784670648818827`*^9}, 3.878467419981193*^9, {
   3.8784674808876767`*^9, 3.878467484106861*^9}},
 CellID->5495055,ExpressionUUID->"355ff0a4-acf7-438a-bb55-cd54fbe9dfe5"],

Cell[TextData[ButtonBox["The Wolfram System Compiler",
 BaseStyle->"Link",
 ButtonData->"Compile/tutorial/Overview"]], "Text",
 CellChangeTimes->{{3.8784673610518227`*^9, 3.8784673688812704`*^9}, {
  3.8784674478557873`*^9, 3.878467469349017*^9}},
 CellID->404766169,ExpressionUUID->"31060984-cec4-4ede-b943-aaedd24dd9dd"],

Cell[TextData[{
 Cell[BoxData[
  ButtonBox["$CompilationTarget",
   BaseStyle->"Link"]], "InlineFormula",ExpressionUUID->
  "911e80be-e7e8-4033-b31f-6171f42d5b19"],
 " allows one to globally set the default compilation target: Wolfram virtual \
machine \"WVM\" or C code \"C\"."
}], "Text",
 CellChangeTimes->{{3.878469441879839*^9, 3.878469616227811*^9}, {
  3.878469808199791*^9, 3.878469831836143*^9}, {3.8784699791025667`*^9, 
  3.87846999105025*^9}, {3.878470151473426*^9, 3.878470177986943*^9}},
 CellID->689812174,ExpressionUUID->"bcf14bcc-e104-4ce7-9d45-90b000ad051a"],

Cell[TextData[{
 "The compilation target for compiler can be also set explicitly in each case \
via ",
 Cell[BoxData[
  ButtonBox["CompilationTarget",
   BaseStyle->"Link"]], "InlineFormula",ExpressionUUID->
  "eaa1cb85-ded0-4620-8db2-ad4f1ae0f9f1"],
 " option of ",
 Cell[BoxData[
  ButtonBox["Compile",
   BaseStyle->"Link"]], "InlineFormula",ExpressionUUID->
  "f8fa7db0-27c3-4cff-9601-8724f35ab294"],
 "."
}], "Text",
 CellChangeTimes->{{3.878469759555009*^9, 3.878469790075755*^9}, {
  3.878470100778526*^9, 3.878470162650064*^9}},
 CellID->463680380,ExpressionUUID->"b91aee21-acf9-4c7f-bc0d-db843b819e20"],

Cell["\<\
To install C compiler one can use the following notes and links in there:\
\>", "Text",
 CellChangeTimes->{{3.8784701836642656`*^9, 3.878470216869166*^9}, {
  3.8784703576022153`*^9, 3.878470400939694*^9}, {3.8784706990397434`*^9, 
  3.878470703179981*^9}},
 CellID->161262773,ExpressionUUID->"a3bf0c91-661c-4d42-a37a-2536d21b0886"],

Cell[TextData[{
 ButtonBox["How to make Mathematica working with C compiler on Windows",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://sites.google.com/view/vasilsaroka/wolfram-mathematica"], 
    None}],
 " "
}], "Text",
 CellChangeTimes->{{3.878469427105994*^9, 3.878469431004217*^9}, {
  3.878470080720379*^9, 3.878470083159518*^9}},
 CellID->327779710,ExpressionUUID->"0f73e6c6-6088-42c9-91ad-25e15558cf7f"],

Cell["\<\
When C compiler is not available the compilation can always proceed with \
\"WVM\" option.\
\>", "Text",
 CellChangeTimes->{3.878470438381836*^9},
 CellID->789092532,ExpressionUUID->"68ea4b77-bf86-4a16-99b4-03af9f0cdf85"],

Cell[CellGroupData[{

Cell["\<\
In what follows, we assume that C compiler is not available, therefore we set \
globally for this session\
\>", "Text",
 CellChangeTimes->{{3.8784704805482464`*^9, 3.878470514193171*^9}, {
  3.8784707129335394`*^9, 3.878470729522488*^9}},
 CellID->44949911,ExpressionUUID->"2c2c027f-e571-478d-a186-83ff77c9b0c5"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"$CompilationTarget", "=", "\"\<WVM\>\""}]], "Code",
 CellChangeTimes->{{3.87846984803607*^9, 3.8784698734715242`*^9}, {
  3.8784704636802816`*^9, 3.878470468035532*^9}, {3.878470519359467*^9, 
  3.8784705216675997`*^9}},
 CellLabel->"In[18]:=",
 CellID->505161433,ExpressionUUID->"6a378b33-2853-4444-b34a-54f886227e4f"],

Cell[BoxData["\<\"WVM\"\>"], "Output",
 CellChangeTimes->{3.878469877854775*^9, 3.8784705290680223`*^9},
 CellLabel->"Out[18]=",
 CellID->17218734,ExpressionUUID->"17d5e6fc-0817-46c4-99c8-95a63f14df38"]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 "We also initiate the TBpack context to get access to ",
 Cell[BoxData[
  ButtonBox["ElectronicStructure",
   BaseStyle->"Link",
   ButtonData->"paclet:TBpack/ref/ElectronicStructure"]], "InlineFormula",
  ExpressionUUID->"752d8717-af74-495f-b8a6-3b6163a61883"],
 " function:"
}], "Text",
 CellChangeTimes->{{3.878470811584182*^9, 3.878470861046011*^9}, {
  3.8784732854146767`*^9, 3.878473308619004*^9}},
 CellID->2401200,ExpressionUUID->"87796fd7-a7d6-4766-a7cb-cf3e4600ca0a"],

Cell[BoxData[
 RowBox[{"Needs", "[", "\"\<TBpack`\>\"", "]"}]], "Code",
 CellChangeTimes->{{3.878131303264641*^9, 3.878131312034143*^9}},
 CellLabel->"In[19]:=",
 CellID->160837254,ExpressionUUID->"32247a65-953e-4fbe-85f1-f3495df7a9b9"]
}, Open  ]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["ChemicalPotential",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 StyleBox[":",
  FontWeight->"Bold"],
 " First we need a function that finds the chemical potential ",
 Cell[BoxData[
  FormBox["\[Mu]", TraditionalForm]], "InlineMath",ExpressionUUID->
  "38f9b683-c201-4878-b4d3-35be48f9511b"],
 " for the energy bands provided in the ",
 Cell[BoxData[
  ButtonBox["ElectronicStructure",
   BaseStyle->"Link",
   ButtonData->"paclet:TBpack/ref/ElectronicStructure"]], "InlineFormula",
  ExpressionUUID->"04761341-a4e5-4a68-8070-b48445b7e4ed"],
 " output format, given number of particles per unit cell ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["n", "e"], TraditionalForm]], "InlineMath",ExpressionUUID->
  "cc42d1fb-bef1-403d-a1c5-4d50b036f12a"],
 " and temperature. "
}], "Text",
 CellChangeTimes->{{3.878130869036804*^9, 3.878130876873253*^9}, {
  3.8784711237330346`*^9, 3.87847128587531*^9}, {3.878471319921257*^9, 
  3.8784713331370125`*^9}, {3.8784754932499566`*^9, 3.878475509921911*^9}, {
  3.878475606018408*^9, 3.878475607093469*^9}},
 CellID->633671718,ExpressionUUID->"069431dc-3865-4e98-826c-663082d33be5"],

Cell[BoxData[
 RowBox[{
  RowBox[{"ChemicalPotential", "=", 
   RowBox[{"Compile", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"bands", ",", "_Real", ",", "2"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"Temp", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"ne", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"eps", ",", "_Real"}], "}"}]}], "\[IndentingNewLine]", "}"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"Block", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
        "xl", ",", "xr", ",", "xm", ",", "\[IndentingNewLine]", "cnt", ",", 
         RowBox[{"maxit", "=", 
          SuperscriptBox["10", "4"]}], ",", "\[IndentingNewLine]", "err", ",",
          "\[IndentingNewLine]", "\[IndentingNewLine]", 
         RowBox[{"kB", "=", 
          RowBox[{"8.617", " ", 
           SuperscriptBox["10", 
            RowBox[{"-", "5"}]]}]}], 
         RowBox[{"(*", " ", 
          RowBox[{"eV", "/", "K"}], " ", "*)"}], ",", "\[IndentingNewLine]", 
         "\[Beta]", ",", "nbnds", ",", "nkps", ",", "\[IndentingNewLine]", 
         "s", ",", "\[Epsilon]", ",", "A", ",", 
         RowBox[{"explim", "=", "100"}], ",", "\[IndentingNewLine]", "fxm", 
         ",", "fxl"}], "\[IndentingNewLine]", "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"(*", " ", 
        RowBox[{"main", " ", "constants"}], " ", "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Beta]", "=", 
         FractionBox["1", 
          RowBox[{"kB", " ", "Temp"}]]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"nbnds", ",", "nkps"}], "}"}], "=", 
         RowBox[{"Dimensions", "[", "bands", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
          "the", " ", "sought", " ", "chemical", " ", "potential", " ", "is", 
           " ", "located", " ", "somewhere", " ", "within", " ", "the", " ", 
           "band", " ", "structure", " ", "range"}], ",", " ", 
          RowBox[{
          "therefore", " ", "initial", " ", "interval", " ", "scoping", " ", 
           "the", " ", "root", " ", "is", " ", "defined", " ", "by", " ", 
           "the", " ", "minimum", " ", "and", " ", "maximum", " ", "energies",
            " ", "among", " ", "all", " ", "the", " ", "bands"}]}], " ", 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"xr", "=", 
         RowBox[{"Max", "[", "bands", "]"}]}], ";", 
        RowBox[{"(*", " ", 
         RowBox[{"right", " ", "boundary"}], " ", "*)"}], 
        "\[IndentingNewLine]", 
        RowBox[{"xl", "=", 
         RowBox[{"Min", "[", "bands", "]"}]}], ";", 
        RowBox[{"(*", " ", 
         RowBox[{"left", " ", "boundary"}], " ", "*)"}], 
        "\[IndentingNewLine]", " ", "\[IndentingNewLine]", 
        RowBox[{"(*", " ", 
         RowBox[{
          RowBox[{
           RowBox[{"--", 
            RowBox[{"--", 
             RowBox[{"--", " ", "Numerical"}]}]}], " ", "solutions", " ", 
           "by", " ", "bisection", " ", 
           RowBox[{
            RowBox[{
             RowBox[{"method", " ", "--"}], "--"}], "--"}]}], "-", "-"}], 
         "*)"}], "\[IndentingNewLine]", 
        RowBox[{"xm", "=", 
         FractionBox[
          RowBox[{"xl", "+", "xr"}], "2"]}], ";", "\[IndentingNewLine]", 
        RowBox[{"err", "=", 
         RowBox[{"xr", "-", "xl"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"cnt", "=", "0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"While", "[", "\[IndentingNewLine]", "\t\t", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"err", ">", "eps"}], ")"}], "&&", 
           RowBox[{"(", 
            RowBox[{"cnt", "\[LessEqual]", "maxit"}], ")"}]}], ",", 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{"(*", " ", 
           RowBox[{
            RowBox[{"fun", "[", "xm", "]"}], " ", "and", " ", 
            RowBox[{"fun", "[", "xl", "]"}]}], " ", "*)"}], 
          "\[IndentingNewLine]", "\t\t", 
          RowBox[{
           RowBox[{"fxm", "=", "0.0"}], ";", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"fxl", "=", "0.0"}], ";", "\[IndentingNewLine]", "\t\t", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", "\t\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{"\[Epsilon]", "=", 
               RowBox[{"bands", "\[LeftDoubleBracket]", 
                RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}]}], ";", 
              "\[IndentingNewLine]", "\t\t\t", 
              RowBox[{"A", "=", 
               RowBox[{"\[Beta]", " ", 
                RowBox[{"(", 
                 RowBox[{"\[Epsilon]", "-", "xm"}], ")"}]}]}], ";", 
              "\[IndentingNewLine]", "\t\t\t", 
              RowBox[{"If", "[", "\[IndentingNewLine]", "\t\t\t\t", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "explim"}], "<", "A", "<", "explim"}], ",", 
                "\[IndentingNewLine]", "\t\t\t\t", 
                RowBox[{"fxm", "+=", 
                 FractionBox["1", 
                  RowBox[{
                   RowBox[{"Exp", "[", "A", "]"}], "+", "1"}]]}], ",", 
                "\[IndentingNewLine]", "\t\t\t\t", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"A", "<", "0"}], ",", 
                  RowBox[{"fxm", "+=", "1"}]}], "]"}]}], 
               "\[IndentingNewLine]", "\t\t\t", "]"}], 
              RowBox[{"(*", " ", 
               RowBox[{"end", " ", "If"}], " ", "*)"}], ";", 
              "\[IndentingNewLine]", "\t\t\t", 
              RowBox[{"A", "=", 
               RowBox[{"\[Beta]", " ", 
                RowBox[{"(", 
                 RowBox[{"\[Epsilon]", "-", "xl"}], ")"}]}]}], ";", 
              "\[IndentingNewLine]", "\t\t\t", 
              RowBox[{"If", "[", "\[IndentingNewLine]", "\t\t\t\t", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "explim"}], "<", "A", "<", "explim"}], ",", 
                "\[IndentingNewLine]", "\t\t\t\t", 
                RowBox[{"fxl", "+=", 
                 FractionBox["1", 
                  RowBox[{
                   RowBox[{"Exp", "[", "A", "]"}], "+", "1"}]]}], ",", 
                "\[IndentingNewLine]", "\t\t\t\t", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"A", "<", "0"}], ",", 
                  RowBox[{"fxl", "+=", "1"}]}], "]"}]}], 
               "\[IndentingNewLine]", "\t\t\t", "]"}]}], 
             RowBox[{"(*", " ", 
              RowBox[{"end", " ", "If"}], " ", "*)"}], "\[IndentingNewLine]", 
             "\t\t", ",", 
             RowBox[{"{", 
              RowBox[{"i", ",", "nbnds"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "nkps"}], "}"}]}], "]"}], 
           RowBox[{"(*", " ", 
            RowBox[{"end", " ", "Do"}], " ", "*)"}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"fxm", "=", 
            RowBox[{
             FractionBox["fxm", "nkps"], "-", "ne"}]}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"fxl", "=", 
            RowBox[{
             FractionBox["fxl", "nkps"], "-", "ne"}]}], ";", 
           "\[IndentingNewLine]", "\t\t", 
           RowBox[{"If", "[", 
            RowBox[{
             RowBox[{
              RowBox[{"fxm", " ", "fxl"}], ">", "0"}], ",", 
             RowBox[{"xl", "=", "xm"}], ",", 
             RowBox[{"xr", "=", "xm"}]}], "]"}], ";", "\[IndentingNewLine]", 
           "\t\t", 
           RowBox[{"xm", "=", 
            FractionBox[
             RowBox[{"xl", "+", "xr"}], "2"]}], ";", "\[IndentingNewLine]", 
           "\t\t", 
           RowBox[{"err", "=", 
            RowBox[{"xr", "-", "xl"}]}]}]}], "\[IndentingNewLine]", "\t", 
         "]"}], ";", "\[IndentingNewLine]", "\t", "xr"}]}], 
      "\[IndentingNewLine]", "]"}], 
     RowBox[{"(*", " ", 
      RowBox[{"end", " ", "Block"}], " ", "*)"}], ",", "\n", 
     RowBox[{"CompilationOptions", " ", "\[Rule]", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
        "\"\<InlineExternalDefinitions\>\"", " ", "\[Rule]", " ", "True"}], 
        ",", 
        RowBox[{
        "\"\<InlineCompiledFunctions\>\"", " ", "\[Rule]", " ", "True"}], ",", 
        RowBox[{
        "\"\<ExpressionOptimization\>\"", " ", "\[Rule]", " ", "True"}]}], 
       "}"}]}], ",", "\n", 
     RowBox[{"RuntimeOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<Speed\>\"", ",", 
        RowBox[{"\"\<EvaluateSymbolically\>\"", "\[Rule]", "False"}]}], 
       "}"}]}]}], "]"}]}], 
  RowBox[{"(*", " ", 
   RowBox[{"end", " ", "Compile"}], " ", "*)"}], ";"}]], "Code",
 CellChangeTimes->{
  3.878130195403274*^9, 3.878381006317099*^9, {3.878470911479895*^9, 
   3.878470925474695*^9}},
 CellLabel->"In[21]:=",
 CellID->287161835,ExpressionUUID->"cf57b0ea-8ea3-452d-932d-bc5b572bdf87"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["OccupationNumbers",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 StyleBox[":",
  FontWeight->"Bold"],
 " Once ",
 Cell[BoxData[
  FormBox["\[Mu]", TraditionalForm]], "InlineMath",ExpressionUUID->
  "a7df5a1b-1202-4765-a900-dcc987838630"],
 " is known one can calculate mean occupation numbers ",
 Cell[BoxData[
  FormBox[
   RowBox[{"\[LeftAngleBracket]", 
    SubscriptBox[
     OverscriptBox["n", "^"], 
     RowBox[{"i", ",", "\[Sigma]"}]], "\[RightAngleBracket]"}], 
   TraditionalForm]], "InlineMath",ExpressionUUID->
  "e77f12f9-3862-4fea-a7d6-9f552a4fdea4"],
 " using the energy bands and the eigenvectors returned by ",
 Cell[BoxData[
  ButtonBox["ElectronicStructure",
   BaseStyle->"Link",
   ButtonData->"paclet:TBpack/ref/ElectronicStructure"]], "InlineFormula",
  ExpressionUUID->"8f409a12-6dcc-42a5-815e-febc5e1c389d"],
 "."
}], "Text",
 CellChangeTimes->{
  3.878130726256638*^9, {3.8781308798754244`*^9, 3.87813088503772*^9}, {
   3.8784713153879976`*^9, 3.8784713165800657`*^9}, {3.8784713469048004`*^9, 
   3.878471476532214*^9}, {3.8784755400026317`*^9, 3.878475547368053*^9}, {
   3.878475609249592*^9, 3.8784756111317*^9}},
 CellID->579868645,ExpressionUUID->"8ee74053-5cfe-497f-8065-e10b0205c595"],

Cell[BoxData[
 RowBox[{
  RowBox[{"OccupationNumbers", "=", 
   RowBox[{"Compile", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"bands", ",", "_Real", ",", "2"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"wavefuncs", ",", "_Complex", ",", "3"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"\[Mu]", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"Temp", ",", "_Real"}], "}"}]}], "\[IndentingNewLine]", "}"}],
      ",", 
     RowBox[{"Block", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"kB", "=", 
          RowBox[{"8.617", " ", 
           SuperscriptBox["10", 
            RowBox[{"-", "5"}]]}]}], 
         RowBox[{"(*", " ", 
          RowBox[{"eV", "/", "K"}], " ", "*)"}], ",", "\[IndentingNewLine]", 
         "\[Beta]", ",", "nbnd", ",", "nkp", ",", "\[IndentingNewLine]", "s", 
         ",", "A", ",", "\[IndentingNewLine]", 
         RowBox[{"explim", "=", "100"}]}], "\[IndentingNewLine]", "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Beta]", "=", 
         FractionBox["1", 
          RowBox[{"kB", " ", "Temp"}]]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"nbnd", ",", "nkp"}], "}"}], "=", 
         RowBox[{"Dimensions", "[", "bands", "]"}]}], ";", 
        "\[IndentingNewLine]", 
        RowBox[{"Table", "[", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{
           RowBox[{"s", "=", "0.0"}], ";", "\[IndentingNewLine]", "\t", 
           RowBox[{"Do", "[", "\[IndentingNewLine]", "\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{"A", "=", 
               RowBox[{"\[Beta]", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"bands", "\[LeftDoubleBracket]", 
                   RowBox[{"j", ",", "k"}], "\[RightDoubleBracket]"}], "-", 
                  "\[Mu]"}], ")"}]}]}], ";", "\[IndentingNewLine]", "\t\t", 
              RowBox[{"If", "[", "\[IndentingNewLine]", "\t\t\t", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "explim"}], "<", "A", "<", "explim"}], ",", 
                "\[IndentingNewLine]", "\t\t\t", 
                RowBox[{"s", "+=", 
                 RowBox[{
                  SuperscriptBox[
                   RowBox[{"Abs", "[", 
                    RowBox[{"wavefuncs", "\[LeftDoubleBracket]", 
                    RowBox[{"k", ",", "j", ",", "i"}], 
                    "\[RightDoubleBracket]"}], "]"}], "2"], " ", 
                  FractionBox["1", 
                   RowBox[{
                    RowBox[{"Exp", "[", "A", "]"}], "+", "1"}]]}]}], ",", 
                "\[IndentingNewLine]", "\t\t\t", 
                RowBox[{"If", "[", 
                 RowBox[{
                  RowBox[{"A", "<", "0"}], ",", 
                  RowBox[{"s", "+=", 
                   SuperscriptBox[
                    RowBox[{"Abs", "[", 
                    RowBox[{"wavefuncs", "\[LeftDoubleBracket]", 
                    RowBox[{"k", ",", "j", ",", "i"}], 
                    "\[RightDoubleBracket]"}], "]"}], "2"]}]}], "]"}]}], 
               "\[IndentingNewLine]", "\t\t", "]"}]}], 
             RowBox[{"(*", " ", 
              RowBox[{"end", " ", "If"}], " ", "*)"}], "\[IndentingNewLine]", 
             "\t", ",", 
             RowBox[{"{", 
              RowBox[{"k", ",", "nkp"}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"j", ",", "nbnd"}], "}"}]}], "]"}], 
           RowBox[{"(*", " ", 
            RowBox[{"end", " ", "Do"}], " ", "*)"}], ";", 
           "\[IndentingNewLine]", "\t", 
           FractionBox["s", "nkp"]}], ",", "\[IndentingNewLine]", 
          RowBox[{"{", 
           RowBox[{"i", ",", "nbnd"}], "}"}]}], "]"}]}]}], 
      RowBox[{"(*", " ", 
       RowBox[{"end", " ", "Table"}], " ", "*)"}], "\[IndentingNewLine]", 
      "]"}], 
     RowBox[{"(*", " ", 
      RowBox[{"end", " ", "Block"}], " ", "*)"}], ",", "\n", 
     RowBox[{"CompilationOptions", " ", "\[Rule]", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
        "\"\<InlineExternalDefinitions\>\"", " ", "\[Rule]", " ", "True"}], 
        ",", 
        RowBox[{
        "\"\<InlineCompiledFunctions\>\"", " ", "\[Rule]", " ", "True"}], ",", 
        RowBox[{
        "\"\<ExpressionOptimization\>\"", " ", "\[Rule]", " ", "True"}]}], 
       "}"}]}], ",", "\n", 
     RowBox[{"RuntimeOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<Speed\>\"", ",", 
        RowBox[{"\"\<EvaluateSymbolically\>\"", "\[Rule]", "False"}]}], 
       "}"}]}]}], "]"}]}], 
  RowBox[{"(*", " ", 
   RowBox[{"end", " ", "Compile"}], " ", "*)"}], ";"}]], "Code",
 CellChangeTimes->{
  3.878130733020025*^9, {3.878471661725807*^9, 3.8784716691842337`*^9}},
 CellLabel->"In[20]:=",
 CellID->792939417,ExpressionUUID->"e1fd9edc-aac0-4751-992c-a18e6dd773a6"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["HubbardMFI",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 StyleBox[":",
  FontWeight->"Bold"],
 " The chemical potential and mean occupation numbers functions can be used \
to set up a routine for a single iteration of the self-consistent Hubbard \
mean field evaluation."
}], "Text",
 CellChangeTimes->{{3.87813089133508*^9, 3.8781309017896776`*^9}, {
  3.878471516370493*^9, 3.878471654138373*^9}, {3.878472034321118*^9, 
  3.878472039151394*^9}, {3.878475566708159*^9, 3.8784755815770097`*^9}, {
  3.878475614192875*^9, 3.878475618327111*^9}},
 CellID->183662499,ExpressionUUID->"5f014cd9-0cb2-4b4a-b592-5c4ece955c94"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "HubbardMFI", "]"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<\[Mu]AccuracyGoal\>\"", "\[Rule]", "3"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<Temperature\>\"", "\[Rule]", "4"}], " ", 
     RowBox[{"(*", " ", "K", " ", "*)"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<NumberOfElectrons\>\"", "\[Rule]", "Automatic"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Efield", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"HubbardMFI", "[", 
   RowBox[{
   "occnumbers_", ",", "uc_", ",", "T_", ",", "klist_", ",", "U_", ",", "t1_",
     ",", 
    RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
  RowBox[{"Block", "[", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"\[Mu]ag", "=", 
       RowBox[{"OptionValue", "[", "\"\<\[Mu]AccuracyGoal\>\"", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"Temp", "=", 
       RowBox[{"OptionValue", "[", "\"\<Temperature\>\"", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ne", "=", 
       RowBox[{"OptionValue", "[", "\"\<NumberOfElectrons\>\"", "]"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"efield", "=", 
       RowBox[{"OptionValue", "[", "Efield", "]"}]}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", "eu", ",", 
      "\[IndentingNewLine]", "t0sup", ",", "t0sdo", ",", "bdup", ",", "bddo", 
      ",", "\[IndentingNewLine]", "bandsUp", ",", "bandsDo", ",", "bands", 
      ",", "\[IndentingNewLine]", "wavefuncsUp", ",", "wavefuncsDo", ",", 
      "\[IndentingNewLine]", "\[Mu]"}], "\[IndentingNewLine]", "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"If", "[", 
      RowBox[{
       RowBox[{"ne", "===", "Automatic"}], ",", 
       RowBox[{"ne", "=", 
        RowBox[{"Length", "[", "uc", "]"}]}]}], "]"}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"occnumbers", " ", "=", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"occnumbers", " ", "<", 
          RowBox[{"spin", " ", "down"}], ">"}], ",", 
         RowBox[{"occnumbers", " ", "<", 
          RowBox[{"spin", " ", "up"}], ">"}]}], "}"}]}], " ", "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
       RowBox[{
        SubscriptBox["E", "U"], " ", "term", " ", "from", " ", 
        RowBox[{"Eq", ".", " ", 
         RowBox[{"(", "10", ")"}]}], " ", "in", " ", 
        RowBox[{"Y", ".", "Claveau"}]}], ",", 
       RowBox[{"B", ".", "Arnaud"}], ",", 
       RowBox[{"and", " ", 
        RowBox[{"S", ".", "Di"}], " ", "Matteo"}], ",", " ", 
       RowBox[{"Eur", ".", " ", "J", ".", " ", "Phys", ".", " ", "35"}], ",", 
       RowBox[{
        RowBox[{
         RowBox[{"035023", " ", 
          RowBox[{"(", "2014", ")"}]}], ":", " ", 
         SubscriptBox["E", "U"]}], " ", "=", " ", 
        RowBox[{"U", " ", "eu"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"eu", "=", 
      RowBox[{"-", 
       RowBox[{"Dot", "[", 
        RowBox[{
         RowBox[{
         "occnumbers", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
          ",", 
         RowBox[{
         "occnumbers", "\[LeftDoubleBracket]", "2", 
          "\[RightDoubleBracket]"}]}], "]"}]}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"t0sup", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"U", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"occnumbers", "\[LeftDoubleBracket]", 
            RowBox[{"1", ",", "#9"}], "\[RightDoubleBracket]"}], " ", "+", 
           " ", "eu"}], ")"}]}], ")"}], "&"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"t0sdo", "=", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"U", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"occnumbers", "\[LeftDoubleBracket]", 
            RowBox[{"2", ",", "#9"}], "\[RightDoubleBracket]"}], " ", "+", 
           " ", "eu"}], ")"}]}], ")"}], "&"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "calculating", " ", "the", " ", "energy", " ", "band", " ", "structure",
        " ", "for", " ", "the", " ", "spin", " ", "up", " ", "and", " ", 
       "down", " ", "electrons"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"bdup", ",", "bddo"}], "}"}], "=", 
      RowBox[{
       RowBox[{
        RowBox[{"ElectronicStructure", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"uc", ",", "uc"}], "}"}], ",", 
          RowBox[{"TranslationVectors", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{
             RowBox[{"{", "T", "}"}], ",", 
             RowBox[{"{", "T", "}"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"HoppingIntegrals", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"#", ",", "t1", ",", "0", ",", "0"}], "}"}]}], ",", 
          RowBox[{"Kpoint", "\[Rule]", "klist"}], ",", 
          RowBox[{"Efield", "\[Rule]", "efield"}], ",", 
          RowBox[{"EigenVectors", "\[Rule]", "True"}]}], "]"}], "&"}], "/@", 
       RowBox[{"{", 
        RowBox[{"t0sup", ",", "t0sdo"}], "}"}]}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{"calculating", " ", "the", " ", "chemical", " ", "potential"}], 
      " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"bandsUp", ",", "wavefuncsUp"}], "}"}], "=", 
      RowBox[{"bdup", "\[LeftDoubleBracket]", 
       RowBox[{"1", ";;", "2"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"bandsDo", ",", "wavefuncsDo"}], "}"}], "=", 
      RowBox[{"bddo", "\[LeftDoubleBracket]", 
       RowBox[{"1", ";;", "2"}], "\[RightDoubleBracket]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"bandsUp", "=", 
      RowBox[{"Most", "@", "bandsUp"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"bandsDo", "=", 
      RowBox[{"Most", "@", "bandsDo"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"bands", "=", 
      RowBox[{"Join", "[", 
       RowBox[{"bandsUp", ",", "bandsDo"}], "]"}]}], ";", 
     "\[IndentingNewLine]", 
     RowBox[{"\[Mu]", "=", 
      RowBox[{"ChemicalPotential", "[", 
       RowBox[{"bands", ",", "Temp", ",", "ne", ",", 
        SuperscriptBox["10", 
         RowBox[{"-", "\[Mu]ag"}]]}], "]"}]}], ";", "\[IndentingNewLine]", 
     RowBox[{"(*", " ", 
      RowBox[{
      "calculating", " ", "occupation", " ", "numbers", " ", "for", " ", 
       "spin", " ", "down", " ", "and", " ", "up", " ", "electrons", " ", 
       "and", " ", "returning", " ", "the", " ", "structured", " ", 
       "output"}], " ", "*)"}], "\[IndentingNewLine]", 
     RowBox[{"{", 
      RowBox[{"bdup", ",", "bddo", ",", "\[Mu]", ",", "\[IndentingNewLine]", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"OccupationNumbers", "[", 
          RowBox[{"bandsDo", ",", "wavefuncsDo", ",", "\[Mu]", ",", "Temp"}], 
          "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"OccupationNumbers", "[", 
          RowBox[{"bandsUp", ",", "wavefuncsUp", ",", "\[Mu]", ",", "Temp"}], 
          "]"}]}], "\[IndentingNewLine]", "}"}]}], "\[IndentingNewLine]", 
      "}"}]}]}], "\[IndentingNewLine]", "]"}], 
  RowBox[{"(*", " ", 
   RowBox[{"end", " ", "Block"}], " ", "*)"}]}]}], "Code",
 CellChangeTimes->{
  3.87813079308346*^9, {3.878471834260675*^9, 3.878471887367713*^9}, {
   3.878471924179818*^9, 3.878471925051868*^9}},
 CellLabel->"In[22]:=",
 CellID->663875468,ExpressionUUID->"dbc6af23-941d-4f11-ad2c-dcd986e20b16"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["HubbardMeanField",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 StyleBox[":",
  FontWeight->"Bold"],
 " The single iteration function can be used in a self-consistent run \
realized via ",
 Cell[BoxData[
  ButtonBox["NestWhile",
   BaseStyle->"Link"]], "InlineFormula",ExpressionUUID->
  "e8f7f2a8-ed72-4f59-a69b-81f506dc331e"],
 ". The presented below function is equipped with the \"CMonitor\" option \
that if set to ",
 Cell[BoxData[
  ButtonBox["True",
   BaseStyle->"Link"]], "InlineFormula",ExpressionUUID->
  "647de16f-12a4-46af-817c-cff4319a08ab"],
 " allows to track initial and final spin configuration and convergence of \
the self-consistent run. It is quite useful when function is used standalone. \
If this function is used as part of some other code it may be more convenient \
to set \"CMonitor\" to ",
 Cell[BoxData[
  ButtonBox["False",
   BaseStyle->"Link"]], "InlineFormula",ExpressionUUID->
  "b87deee9-a560-4a33-bc5f-1c3e84698a37"],
 "."
}], "Text",
 CellChangeTimes->{{3.878130908730075*^9, 3.878130927598154*^9}, {
  3.8784720727783175`*^9, 3.878472150556766*^9}, {3.878472350318192*^9, 
  3.878472500907805*^9}, {3.878472544190281*^9, 3.878472594122137*^9}, {
  3.878472656369697*^9, 3.87847275887056*^9}, {3.878475633751994*^9, 
  3.878475641800454*^9}, {3.9277967563100452`*^9, 3.9277967569959335`*^9}},
 CellID->44386903,ExpressionUUID->"f7cd916d-403c-467a-b57e-341dc2a07f34"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Options", "[", "HubbardMeanField", "]"}], "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\"\<Temperature\>\"", "\[Rule]", "4"}], " ", 
     RowBox[{"(*", " ", "K", " ", "*)"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<NumberOfElectrons\>\"", "\[Rule]", "Automatic"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"\"\<SpinConfiguration\>\"", "\[Rule]", "Automatic"}], 
     RowBox[{"(*", " ", 
      RowBox[{"\"\<AFM\>\"", ",", " ", 
       RowBox[{"\"\<FM\>\"", " ", "or", " ", "\"\<PM\>\""}]}], " ", "*)"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"Efield", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<CMonitor\>\"", "\[Rule]", "False"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"AccuracyGoal", "\[Rule]", "6"}], ",", "\[IndentingNewLine]", 
     RowBox[{"MaxIterations", "\[Rule]", "2000"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\"\<SpinDensityScaleFactor\>\"", "\[Rule]", "3"}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"HubbardMeanField", "[", 
    RowBox[{"uc_", ",", "T_", ",", "klist_", ",", "U_", ",", "t1_", ",", 
     RowBox[{"OptionsPattern", "[", "]"}]}], "]"}], ":=", 
   RowBox[{"Block", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"Temp", "=", 
        RowBox[{"OptionValue", "[", "\"\<Temperature\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ne", "=", 
        RowBox[{"OptionValue", "[", "\"\<NumberOfElectrons\>\"", "]"}]}], 
       RowBox[{"(*", " ", 
        RowBox[{"per", " ", "unit", " ", "cell"}], " ", "*)"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"spinconfig", "=", 
        RowBox[{"OptionValue", "[", "\"\<SpinConfiguration\>\"", "]"}]}], ",",
        "\[IndentingNewLine]", 
       RowBox[{"efield", "=", 
        RowBox[{"OptionValue", "[", "Efield", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"cmonitor", "=", 
        RowBox[{"OptionValue", "[", "\"\<CMonitor\>\"", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ag", "=", 
        RowBox[{"OptionValue", "[", "AccuracyGoal", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"maxit", "=", 
        RowBox[{"OptionValue", "[", "MaxIterations", "]"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"sdfac", "=", 
        RowBox[{"OptionValue", "[", "\"\<SpinDensityScaleFactor\>\"", "]"}]}],
        ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", "sce", ",", "spindensplot", ",", 
       "\[IndentingNewLine]", "occnumbers", ",", "rp", ",", "cplot"}], 
      "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"If", "[", 
       RowBox[{
        RowBox[{"ne", "===", "Automatic"}], ",", 
        RowBox[{"ne", "=", 
         RowBox[{"Length", "[", "uc", "]"}]}]}], "]"}], ";", 
      "\[IndentingNewLine]", 
      RowBox[{"If", "[", "\[IndentingNewLine]", "\t", 
       RowBox[{
        RowBox[{"spinconfig", "===", "Automatic"}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{"ferromagnetic", " ", "spin", " ", "configuration"}], " ", 
         "*)"}], "\[IndentingNewLine]", "\t", 
        RowBox[{"spinconfig", "=", 
         RowBox[{"{", "\[IndentingNewLine]", "\t", 
          RowBox[{
           RowBox[{"ConstantArray", "[", 
            RowBox[{"0", ",", 
             RowBox[{"Length", "[", "uc", "]"}]}], "]"}], ",", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"ConstantArray", "[", 
            RowBox[{"1", ",", 
             RowBox[{"Length", "[", "uc", "]"}]}], "]"}]}], 
          "\[IndentingNewLine]", "}"}]}]}], "\[IndentingNewLine]", "]"}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"initial", " ", "spin", " ", "configuration"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"spinconfig", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{
           RowBox[{"occ", ".", " ", "numbers"}], " ", "spin", " ", "do"}], 
          ",", " ", 
          RowBox[{
           RowBox[{"occ", ".", " ", "numbers"}], " ", "spin", " ", "up"}]}], 
         "}"}]}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
        RowBox[{"function", " ", "for", " ", "the", " ", "self"}], "-", 
        RowBox[{"consistent", " ", "evaluation", " ", 
         RowBox[{"(", "sce", ")"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"sce", "=", 
       RowBox[{
        RowBox[{
         RowBox[{"HubbardMFI", "[", 
          RowBox[{
          "#", ",", "uc", ",", "T", ",", "klist", ",", "U", ",", "t1", ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<\[Mu]AccuracyGoal\>\"", "\[Rule]", "ag"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<Temperature\>\"", "\[Rule]", "Temp"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"\"\<NumberOfElectrons\>\"", "\[Rule]", "ne"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Efield", "\[Rule]", "efield"}]}], "]"}], 
         "\[LeftDoubleBracket]", "4", "\[RightDoubleBracket]"}], "&"}]}], ";",
       "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"sce", " ", "output", " ", "structure"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"res", " ", "=", " ", 
        RowBox[{"{", 
         RowBox[{"bdup", ",", "bddo", ",", "\[Mu]", ",", "occnumbers"}], 
         "}"}]}], " ", "*)"}], "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"If", "[", "\[IndentingNewLine]", "\t", 
       RowBox[{"cmonitor", ",", "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{"convergence", " ", "tracking"}], " ", "*)"}], 
        "\[IndentingNewLine]", "\t", 
        RowBox[{
         RowBox[{"spindensplot", "=", 
          RowBox[{"Function", "[", 
           RowBox[{
            RowBox[{"{", "x", "}"}], ",", 
            RowBox[{"Graphics", "[", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"MapThread", "[", 
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"If", "[", 
                    RowBox[{
                    RowBox[{"#2", ">", "0"}], ",", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Opacity", "[", "0.5", "]"}], ",", "Red"}], "}"}],
                     "]"}], ",", 
                    RowBox[{"Directive", "[", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Opacity", "[", "0.5", "]"}], ",", "Blue"}], 
                    "}"}], "]"}]}], "]"}], ",", 
                    RowBox[{"Disk", "[", 
                    RowBox[{
                    RowBox[{"Most", "@", "#1"}], ",", 
                    RowBox[{"sdfac", " ", 
                    RowBox[{"Abs", "[", "#2", "]"}]}]}], "]"}]}], "}"}], 
                  "&"}], ",", 
                 RowBox[{"{", 
                  RowBox[{"uc", ",", 
                   RowBox[{"0.5", " ", 
                    RowBox[{"Plus", "@@", 
                    RowBox[{"(", 
                    RowBox[{"x", " ", 
                    RowBox[{"{", 
                    RowBox[{
                    RowBox[{"-", "1"}], ",", "1"}], "}"}]}], ")"}]}]}]}], 
                  "}"}]}], "]"}], ",", 
               RowBox[{"Opacity", "[", "0.1", "]"}], ",", "Gray", ",", 
               RowBox[{
                RowBox[{
                 RowBox[{"Disk", "[", 
                  RowBox[{
                   RowBox[{"Most", "@", "#"}], ",", "0.3"}], "]"}], "&"}], "/@",
                 "uc"}]}], "}"}], "]"}]}], "]"}]}], 
         RowBox[{"(*", " ", 
          RowBox[{"end", " ", "Function"}], " ", "*)"}], ";", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"Echo", "[", 
          RowBox[{
           RowBox[{"spindensplot", "[", "spinconfig", "]"}], ",", 
           "\"\<HubbardMeanField initial spin density:\>\""}], "]"}], ";", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"occnumbers", ",", "rp"}], "}"}], "=", 
          RowBox[{"Reap", "[", 
           RowBox[{"NestWhile", "[", "\[IndentingNewLine]", "\t", 
            RowBox[{"sce", ",", "spinconfig", ",", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Sow", "[", 
                 RowBox[{"Norm", "[", 
                  RowBox[{"Flatten", "[", 
                   RowBox[{"#2", "-", "#1"}], "]"}], "]"}], "]"}], ">", 
                SuperscriptBox["10", 
                 RowBox[{"-", "ag"}]]}], ")"}], "&"}], ",", 
             "\[IndentingNewLine]", "\t", "2", ",", "maxit"}], "]"}], 
           RowBox[{"(*", " ", 
            RowBox[{"end", " ", "NestWhile"}], " ", "*)"}], 
           "\[IndentingNewLine]", "\t", "]"}]}], 
         RowBox[{"(*", " ", 
          RowBox[{"end", " ", "Reap"}], " ", "*)"}], ";", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"cplot", "=", 
          RowBox[{"ListPlot", "[", 
           RowBox[{
            RowBox[{"First", "@", "rp"}], ",", 
            RowBox[{"PlotRange", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"-", "0.01"}], ",", "1"}], "}"}]}], ",", 
            RowBox[{
            "PlotLabel", "\[Rule]", 
             "\"\<occ. numbers \[CapitalDelta]-convergence\>\""}], ",", 
            RowBox[{"ImagePadding", "\[Rule]", 
             RowBox[{"{", 
              RowBox[{
               RowBox[{"{", 
                RowBox[{"20", ",", "20"}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"20", ",", "20"}], "}"}]}], "}"}]}], ",", 
            RowBox[{"ImageSize", "\[Rule]", 
             RowBox[{"0.75", " ", 
              RowBox[{"{", 
               RowBox[{"300", ",", "200"}], "}"}]}]}]}], "]"}]}], ";", 
         "\[IndentingNewLine]", "\t", 
         RowBox[{"Echo", "[", 
          RowBox[{"cplot", ",", "\"\<HubbardMeanField SCE convergence:\>\""}],
           "]"}], ";", "\[IndentingNewLine]", "\t", 
         RowBox[{"Echo", "[", 
          RowBox[{
           RowBox[{"spindensplot", "[", "occnumbers", "]"}], ",", 
           "\"\<HubbardMeanField final spin density:\>\""}], "]"}]}], ",", 
        "\[IndentingNewLine]", "\t", 
        RowBox[{"(*", " ", 
         RowBox[{"supressed", " ", "convergence", " ", "tracking"}], " ", 
         "*)"}], "\[IndentingNewLine]", "\t", 
        RowBox[{"occnumbers", "=", 
         RowBox[{"NestWhile", "[", 
          RowBox[{"sce", ",", "spinconfig", ",", "\[IndentingNewLine]", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Norm", "[", 
               RowBox[{"Flatten", "[", 
                RowBox[{"#2", "-", "#1"}], "]"}], "]"}], ">", 
              SuperscriptBox["10", 
               RowBox[{"-", "ag"}]]}], ")"}], "&"}], ",", "2", ",", "maxit"}],
           "]"}]}]}], 
       RowBox[{"(*", " ", 
        RowBox[{"end", " ", "NestWhile"}], " ", "*)"}], "\[IndentingNewLine]",
        "]"}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "one", " ", "more", " ", "iteration", " ", "with", " ", "the", " ", 
        "found", " ", "occupation", " ", "numbers"}], " ", "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"HubbardMFI", "[", 
       RowBox[{
       "occnumbers", ",", "uc", ",", "T", ",", "klist", ",", "U", ",", "t1", 
        ",", "\[IndentingNewLine]", 
        RowBox[{"\"\<\[Mu]AccuracyGoal\>\"", "\[Rule]", "ag"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<Temperature\>\"", "\[Rule]", "Temp"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"\"\<NumberOfElectrons\>\"", "\[Rule]", "ne"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Efield", "\[Rule]", "efield"}]}], "]"}]}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  RowBox[{"(*", " ", 
   RowBox[{"end", " ", "Block"}], " ", "*)"}], ";"}]}], "Code",
 CellChangeTimes->{
  3.8781308360699186`*^9, {3.878472177920332*^9, 3.87847220062363*^9}, 
   3.878472281935281*^9, {3.878472313846106*^9, 3.8784723142261267`*^9}},
 CellLabel->"In[24]:=",
 CellID->53961409,ExpressionUUID->"24a08639-5c19-4b47-a890-d6246f204e88"]
}, Closed]],

Cell[CellGroupData[{

Cell[TextData[{
 StyleBox["FreeEnergy",
  FontWeight->"Bold",
  FontSlant->"Italic"],
 StyleBox[":",
  FontWeight->"Bold"],
 " Finally, to make a judgement with respect to a set of self-consistent runs \
results, we need a function that calculates a free energy based on the \
obtained data."
}], "Text",
 CellChangeTimes->{{3.87813096599135*^9, 3.878130969182533*^9}, {
  3.8784727755055113`*^9, 3.8784727934415374`*^9}, {3.878472829566603*^9, 
  3.878472922251904*^9}, {3.878472995758109*^9, 3.878473031809171*^9}, {
  3.8784756804986672`*^9, 3.878475684788913*^9}, {3.927796790139389*^9, 
  3.9277967905780735`*^9}},
 CellID->475847898,ExpressionUUID->"9bd55406-5529-4532-a730-9624cb542e95"],

Cell[BoxData[
 RowBox[{
  RowBox[{"FreeEnergy", "=", 
   RowBox[{"Compile", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{"Temp", ",", "_Real"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{"bands", ",", "_Real", ",", "2"}], "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"\[Mu]", ",", "_Real"}], "}"}]}], "\[IndentingNewLine]", 
      "}"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Block", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"kB", "=", 
          RowBox[{"8.617", " ", 
           SuperscriptBox["10", 
            RowBox[{"-", "5"}]]}]}], 
         RowBox[{"(*", " ", 
          RowBox[{"eV", "/", "K"}], " ", "*)"}], ",", "\[IndentingNewLine]", 
         "\[Beta]", ",", "inv\[Beta]", ",", "v1", ",", "v2", ",", 
         "\[IndentingNewLine]", "nbnds", ",", "nkps", ",", 
         "\[IndentingNewLine]", "s", ",", "\[Epsilon]", ",", 
         "\[Epsilon]const", ",", "A", ",", "\[IndentingNewLine]", 
         RowBox[{"f", "=", "0.0"}], ",", "\[IndentingNewLine]", 
         RowBox[{"explim", "=", "50"}]}], "\[IndentingNewLine]", "}"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"\[Beta]", "=", 
         FractionBox["1", 
          RowBox[{"kB", " ", "Temp"}]]}], ";", "\[IndentingNewLine]", 
        RowBox[{"inv\[Beta]", "=", 
         FractionBox["1", "\[Beta]"]}], ";", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"nbnds", ",", "nkps"}], "}"}], "=", 
         RowBox[{"Dimensions", "[", "bands", "]"}]}], ";", 
        "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"s", "=", "0.0"}], ";", "\[IndentingNewLine]", 
        RowBox[{"Do", "[", "\[IndentingNewLine]", "\t", 
         RowBox[{
          RowBox[{
           RowBox[{"\[Epsilon]", "=", 
            RowBox[{"bands", "\[LeftDoubleBracket]", 
             RowBox[{"i", ",", "j"}], "\[RightDoubleBracket]"}]}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"A", "=", 
            RowBox[{"\[Beta]", " ", 
             RowBox[{"(", 
              RowBox[{"\[Epsilon]", "-", "\[Mu]"}], ")"}]}]}], ";", 
           "\[IndentingNewLine]", "\t", 
           RowBox[{"If", "[", "\[IndentingNewLine]", "\t\t", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "explim"}], "<", "A", "<", "explim"}], ",", 
             "\[IndentingNewLine]", "\t\t", 
             RowBox[{
              RowBox[{"f", "=", 
               FractionBox["1", 
                RowBox[{
                 RowBox[{"Exp", "[", "A", "]"}], "+", "1"}]]}], ";", 
              "\[IndentingNewLine]", "\t\t", 
              RowBox[{"If", "[", "\[IndentingNewLine]", "\t\t\t", 
               RowBox[{
                RowBox[{"f", "<", "1"}], ",", "\[IndentingNewLine]", "\t\t\t", 
                RowBox[{"s", "+=", 
                 RowBox[{
                  RowBox[{"\[Epsilon]", " ", "f"}], " ", "+", " ", 
                  RowBox[{"inv\[Beta]", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"f", " ", 
                    RowBox[{"Log", "[", "f", "]"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "f"}], ")"}], " ", 
                    RowBox[{"Log", "[", 
                    RowBox[{"1", "-", "f"}], "]"}]}]}], ")"}]}]}]}], ",", 
                "\[IndentingNewLine]", "\t\t\t", 
                RowBox[{"s", "+=", 
                 RowBox[{"\[Epsilon]", " ", "f"}]}]}], "\[IndentingNewLine]", 
               "\t\t", "]"}]}], ",", "\[IndentingNewLine]", "\t\t", 
             RowBox[{"If", "[", 
              RowBox[{
               RowBox[{"A", "<", "0"}], ",", 
               RowBox[{"s", "+=", "\[Epsilon]"}]}], "]"}]}], 
            "\[IndentingNewLine]", "\t", "]"}]}], 
          RowBox[{"(*", " ", 
           RowBox[{"end", " ", "If"}], " ", "*)"}], "\[IndentingNewLine]", 
          ",", 
          RowBox[{"{", 
           RowBox[{"i", ",", "nbnds"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"j", ",", "nkps"}], "}"}]}], "]"}], 
        RowBox[{"(*", " ", 
         RowBox[{"end", " ", "Do"}], " ", "*)"}], ";", "\[IndentingNewLine]", 
        FractionBox["s", "nkps"]}]}], "\[IndentingNewLine]", "]"}], 
     RowBox[{"(*", " ", 
      RowBox[{"end", " ", "Block"}], " ", "*)"}], ",", "\n", 
     RowBox[{"CompilationOptions", " ", "\[Rule]", " ", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{
        "\"\<InlineExternalDefinitions\>\"", " ", "\[Rule]", " ", "True"}], 
        ",", 
        RowBox[{
        "\"\<InlineCompiledFunctions\>\"", " ", "\[Rule]", " ", "True"}], ",", 
        RowBox[{
        "\"\<ExpressionOptimization\>\"", " ", "\[Rule]", " ", "True"}]}], 
       "}"}]}], ",", "\n", 
     RowBox[{"RuntimeOptions", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<Speed\>\"", ",", 
        RowBox[{"\"\<EvaluateSymbolically\>\"", "\[Rule]", "False"}]}], 
       "}"}]}]}], "]"}]}], 
  RowBox[{"(*", " ", 
   RowBox[{"end", " ", "Compile"}], " ", "*)"}], ";"}]], "Code",
 CellChangeTimes->{{3.878131025380747*^9, 3.878131074921581*^9}, {
  3.878472944998206*^9, 3.878472961347141*^9}},
 CellLabel->"In[27]:=",
 CellID->319588904,ExpressionUUID->"d4fb5ba3-59cb-4911-9b5c-e2f5db627107"]
}, Closed]],

Cell[TextData[{
 StyleBox["Hint:",
  FontWeight->"Bold"],
 " All the above code cells can be evaluated in one click by choosing \
'Evaluation",
 Cell[BoxData[
  FormBox["\[Rule]", TraditionalForm]], "InlineMath",ExpressionUUID->
  "7e9b4829-ed96-4c1c-8f97-290f32712291"],
 "Evaluate Initialization Cells':"
}], "Text",
 CellChangeTimes->{{3.878133311767521*^9, 3.8781333934271913`*^9}, {
   3.87813351141494*^9, 3.878133515316163*^9}, {3.8784730682092533`*^9, 
   3.878473088079389*^9}, 3.878473140951414*^9, {3.878475784824634*^9, 
   3.878475838807722*^9}},
 CellID->25939828,ExpressionUUID->"fdc37674-3441-43e8-bf90-8b00bd025775"],

Cell[TextData[Cell[BoxData[
 GraphicsBox[
  TagBox[RasterBox[CompressedData["
1:eJztnXmQHcV9xyfJP/kjVTkKx1W2UylXqpJKIREt1m7yX+JUUnFsg4UkJOTY
1rNig+NYMggfnHYB0mJcPoJMwEYSCkjoWqEDhADdyICEtPt0LAKEQAdCx+rY
fXu91S6mNj33r6+Znnnz9r15+n7qh5jX08eve7q/r7vf7MynZ3138s2/b1nW
7X/I/pn89R9+du7cr9855U/Yhxvn3P5ft8z55jf+fc73vnnLN+f+w6w/YIEH
2H+P/Z5l2cc333zLgl898uSTSxvbWB2/8pWvrlv37PDIRzAYrJHsV488uqrt
mZc2b2ts27Jt58MLHvn2f88uX/4dDAZrJFu6bMXmrTv2dhxsbCseOMz+nTpt
et/gCAwGayR7cumKFzbv2LP3QGPbvuIb7N8pU6f39A3DYLBGsuUr1+747d6O
A283thUPvVM8eGTylOkXei7DYLBGsmXL12zbuWdvx5uNbe37395XfOuGydPO
XSzDYLBGsuWr1u/4bXvHwaNXgk2aPO30+UEYDNZI9sRTa5/fsvfl3UcCW/7d
CRbHhO+sPkIjmNhPJ1lXf3dz0lS6rCxr+k+zyOrzX5zS+c4lnT06ndZ64g+2
aGMG8a+5qz06zhibXYXpq8SQCfOeV8Vx6jvz0ST5P3/XRCH/apuyRJOWr8Or
A6uSqUVs0sLKlSe9iP1iujXuzuVZqFZSEQu6vT124nTMaJgsmslpiPAxc2P5
c7rU/oMJgiDbIVMXpcwfIgarQ/u/pze8uL34yr53A1t5W5N1w2IaksJ+doN1
9W3bUiZ/+CZr/N0rK3NAaeYi5g726FFQjyK2Zd41VLKcj9dQ1RIiJDSIGKwO
zVDEmCjRQDuOqzNr7746WIER5SEitvh6q2n2Wj8rO/5NPwuPxbR2QQFOiYIe
2kXzERzbNnu8df3D9r8OpMTKRcwe+MHaOpQgYZg4kzduKcqtT6evEj7qUtlm
T6hMV7W8cdrrKgC3xiQqSvx3p2futE0sNHR7wrxHeUkhzodF8EvaVVOtUEJT
aKCJiCnbkMZxj8NoVf0egY25LV3x3NZdB/cUjwe25vYma/ISGmLbghnW+HvX
eB933jremrTAjTzj1g1hYJDwl5OtcbfvdI6XTLKa/DjH92y4d5w145fFqLR8
WTQrxzc/OZ/KOfYLYkloDoExEXvj6CWdPeZ0df9j+w+arBsX2ceb7prJhkYQ
yMaUHH8TGyBN8za5aZ013WPBcRAufVSn8idLTuA8v2hT2+SMes5DUuhj05X+
O/XyC7Xj0Pich2Fyu6CgmrRlaB35JCw3t0nTVUd5pXQtT+M85ugwV1kpT1h+
bemKjVt3HdpTPBHYmtuvpRvcjhqccLTo2ls3OHE8ITqxRzBPfOxjX3n4hGZp
ueOIrLjcbBHzo2lLcUSsW2dOt+8Ijp3hIEWzR+j8TWL81TfaChBE63AEUIwv
fdSk2jL/GmXRhuYNZJo/PfAd4/y3iw7qThwQPHSaZfpqlfMklX3gnbJV6675
13hVlpIY2CY62SPEtrx4NT23A1cTewKrW3tq+bMv7Si+2v5uYKvmspnYYhri
2s8nW1fP3SZHsD+Ginf3Kj7yq+32cnLOOj+fdfZy8ueRaV919sRWSeXa4SQt
n/m2OfZykpZCCm1/97X295h9/roph9/t1tmvbyKDpGn+C+TUC3dPlE+x+Nfc
3WFHWDzTkrhxcbd3imZFP2pTdfywieSQ2BylWkzLsjO0Q7bZOvNrUl/P/yCC
e8qONvGH28T4XjvctNp3njvllOukCnNjISyOHy40hZmFJfJXKrblSe24Y95V
WCPYUyue27xz/2sd7wXmahQN8WwB05Z7VnVst+VigRvINMRyAmkE+5gpz7i5
2/04TXPW+5msv2ccE6LItNwxzWqBI2KcV0Hm1Cu3FFJox3u7O44x+8J1U958
r0dnv7nJmnBPhxS+epojXC+6H52R+KIQ3xnRv1FmS+KLHyNSMds+39mg0keI
q8iL9zSz4e+GuMf2v8QZUt+OO5qsaYtp0c13bFd4GOapcJ41lJMqiMbycYpj
BbHMWaCqeWOM1kJxpfRtSK+mdGVDV2ENYEtXPrf15QPxe2LB7taCcFOLbnB5
Cf2dKO2eGFsqukn0abV7YnYSkhWXSbhNp47p2Beum/rWsZLOHp/BunpRDN/R
OsEqPO5/fMnWgdaXhPh2nOY7dqiyfaIQxBc/RqTyrMi0ReFSnDlOFqYxXXqC
lGsVpvEVJPW1CwojB45JHj5uX702tfO0odhxU+vjtmoVvdJntHJFJKqLW6Ly
SunbkF7N0G3SGo8n9ARWt7Zs5XPbdh3Yu/94YGu/12RNWUJDAnt4ijVufNO4
7+30Qp61teK2Z4NjewNtbRDTi7bztvGWn+ES57fHGQ9Hpt37yAwvjpiVfUxO
2TnTUm545LjCMWJfvH7qkeMlnS1k3f7eohi+0x4md+4MjtmsrHWzFJ8ds3Gx
0EtVvHOGF+fIkgIJFz+qUy0pTF/ihzRZ/nESc/0M3LatbboYQv3nCyJVtj1s
onWx1UDtfBNtPb44lmFT8wTaDsa2+d7moETlldK1vBQnqKDtm+JCw3JrK9o2
7Xy1s/3Q+4Gt+z6/sW9Zkx/1zz76Zcu6du5GVeRrfryOnWX/OuEPT7XGf3+X
H+3JyV6kLz+88cfj2b+RadsP7Zrr3tMw9UkpK849Em4nCf20S+H83HfgBDMm
Yu+c6NXZIrvb75fDt7Bx5HJt6xY2kNm/qviLZoQtRsL33+X6O2ON6qMqlSdB
Qj6JzCnF95MUVFikrq8df/oS/5QjYnft5P13fLabwvecaxnJVbu40AEnE5LQ
3IQSlVdK2fI0jnO8hlYkVavC6tRWrnlh1+7D+w+fbmzzROxLU4+e7INdabbo
y1bTj/bX3A1YlWzVMy/u2v3mgTfPNLa1HzzJ7Lov3fju+/2wK80WMxH78cGa
uwGrkq1Zt/m1vW+/8fa5xrZi5/vMmIgdO9UPu9Lsif+wRazmbsCqZM+s37J7
35HDR7oa2/a/cYrZ9ZNuPP7BAAwGayR7ZsOWPe1HDr/T1dh28M3TzK6fNO3E
6UEYDNZItnT5+teL77z17vnGtjePdjH7+n9+++SZQRgM1kj2jVtmb9r8Ws1n
StW2V19/a86tdzzx5DMnz5RhMFgj2Y/u/8X1k6b/0z//W2MbqyOr6aat7TAY
rMHsMQAAyDODAAAAAACgdvRWgfdPnRodHS0BAEA1gYgBAHINRAwAkGsgYgCA
XAMRAwDkGogYACDXQMQAALlmjEWs2Bo+zdihubWY2Oe2QqpklcF7XmiLjEw9
rIm3oLFhnUrqjHYPVfZLJ3J4xu/JMX1YJpPBWw1qIGKJG0+kIllIk9i9esTv
tkJ0JSBioGo4vZF2xla3e5mNLTsW6Y9JemfiwTtWXR8iFotw2ZMWAhEDWaLt
juYixn0dQ8QyETF7uksCw6tE56/qbw++mWjuqrSqSTiNqGxxwTsRZXKtiIUe
QNhAOnQd0u39QX9U9EZuPVhoUw6HIC+5g2pETF2u8Vhzk7vRC+lapB5EjB/n
YZRia4HWNEhoImK6tIoUVG5iFVaujiq5WsRobH8NAEBSXCmQRIYLtjujcpCY
zcSSipiyXLOx5gQ3FyoZDjXe2A+r7ldPN2dVK5d+JqZJK02M6LVSpY8SMW1y
vYhVvJYGoBQOJJ1I0M6WpYgpBq+2XLOxlmK3RqQuZmLCjFdYWqpWhSYipkwr
6otEAhHTJ9eopucRhAxkg7cIU/06SbQhgYipurSw8JOc0JZrNtYy+GqvExHz
6yvouFp8DERMm1Zq2Lj2i/ii0CeP2tiHkoEM4XeQKxUxkjrhnpiiXLOx1kAi
5la4TdiZj20b/hoEDaVPy6UwmsmKv2jzZ9TJ436dzGAKDYBDfKevCxGr8EfV
SOpGxJwaNzfzrc2vwxRtQxWGzK31aYVvBP4+QPJrgOgav5Hq3yemS64WsfDu
MuyOgbSwviPut4Q75GlETCNM2YhY/FjLp4jp9qC4Hzb4yCw4cvrl5cT9OqlO
G57hVq3i8l+Cd1xVfPz6Ne5mDgAMEHaXiCykEDFpOESgGbwRyx6TsZY/EQMA
gGyBiAEAcg1EDACQayBiAIBcAxEDAOQaiBgAINdAxAAAuQYiBgDINRAxAECu
gYgBAHINRAwAkGsgYgCAXAMRAwDkmjEWsaMb5s3mmLfhaGKfdy9MlSwtrLjZ
sxfuThZfUcExdhvUCq4DeB3H7vjKPiT0Ln+AJOhvFH58GWVi3i0zGbzVoAYi
lvL6hFSkBtWXElqCc929TxCxKwDngpMevnuDe8nNOr4di/SRZD3G1Rha9kLv
Q2Q+yUQs0eAdqx4PEcscvoSwX0LEGh9BhfgTZiLGqZB5j9GWHJcPRCwTEbNn
1CQwvBx0/qr+gpIFw89IlVY1z6cR1S1OynALCFLExi9pRUxTNeFM0CqxToL6
QOjLAdqeE/QKbrG2cLeyrwZ5SZ1AV67c511P3GD7s1JpVEXoRExdNeOxxvmj
qIAB9SBi8vB2oxzdsJBblvkJTURMl1YrMSVtRxBEjLtMKkXR+cQvM9XuCR82
7DZ1EtQJXBfRBNOeo+n78jkuLzE4uldIZcybt1BW0ZgiIkVMPSiMxproTwpq
vLEvbxfp5qxq5dLPxDRp+RTCBYyVWH7OrilOKC3oXdrJdXhC2ReNnAR1hN/L
dSOYXsPaiBhJnkzEFINXPyiMxlrUOtiQupiJCZNqYWkpLbsMRUyZVpYYgVgR
4wtQND+Xq36bVuGeTsMMnAR1R7hiK0X0nAQipuoJUd9+6nzEISgqja6ImOWk
ompmYy2DL+U6ETG/voKOq8XHQMS0aaWGjW+/FCKm/Gbh3Va5pxUxiFY+4bd3
KxUxkloMjp7OmItYRBEZiJiyGzeQiLkV3i3szMe2DX8FgoaKEBvxBoj4mWz2
IqbLRplhBtNtUCvie2Q2Iibd2iF6UXMRq/B320jqRsScGs+bxze2ckNd2mkP
dxfoFFWdVvhGoHtW3Ha74Fj2Iqatmryxb+IkqAvY1RQ3Q8Lt6zQiplENzQ9K
/C8K9D4x/ofusROx+LGWTxHTbe9Iv/aFkVlw5PTLy4n7dVKdNjzDrVrlHayQ
KiwnI9yj/qj3KjAtq2OErR+NdBiKmNRX4+CHl7rPG4mYQe6aTS1uUJiMtfyJ
GAAAZAtEDACQayBiAIBcAxEDAOQaiBgAINdAxAAAuQYiBgDINRAxAECugYgB
AHINRAwAkGsgYgCAXAMRAwDkGogYACDX1PopFmkeyWD+d/eZwD9CxDyJ/JwO
beSxqU6KigBQOYpHe2T6vOL6eZ5YojZJP+qrLhni4+n8Nw/WziMAakp8D69s
DEDEMib5g1ghYqCxie3hFQ6BehAx4QGW/OOaFetOoxeFqNIqV3kkorohpYci
Bil0zz6MfeWS4n033GMSucx0T7iTGkVbW9Xz94SlPf9Uu9h3awJgTpxGVfo1
Xg8ipnu6ZU7fOyk8D1tZSUHEhAdd0jfy+RXdID/Zmn+COx9TlVZ6tCz33FH+
mbgxdQTAnGiRqvwlEnjvpDA3qfy9k7Se6vljSRIx8ZnE83whEvLXOCzHVPmm
bbcS/9VhWEcAzOB38YXulL/HU8fKjBCBE72EIqZMK71GSqTy905yKcMcY5aT
usaYLb1rQeWwFFMRQgpSzDk1VwDvWgIVEzUTy+KNhHUiYn496Xn+7S3JZmLa
tGbvwlO5JrtvMsDDOClELIjpq1G0w3FKBhEDNSFCxLLQsLoRMbeiDfHeSSl1
IEAqV+XrqLiufknxJcoxVDKqjhXzcjEA0qEXsWx+ma8bEXPq0wDvnTwa9eZB
havCB7qVHrw3UJxiSg7LMTVp+ZU0t7FfgVADEIVOqrLqXLW+Y7/x3jupuD05
2tVgDiqm0Nz8oXBYjqlKG3GLReTGIkQMVIRGxDLrW/jbSQBAroGIAQByDUQM
AJBrIGIAgFwDEQMA5BqIGAAg10DEAAC5BiIGAMg1EDEAQK6BiAEAck21RewE
AABUk2qLGAAAVBUsJwEAuQYiBgDINRAxAECugYgBAHINRAwAkGsgYgCAXAMR
AwDkGogYACDXQMQAALlmjEWs2NpscTS3FhP73FZIlSwtrDjZT7sihbYMi8i0
Rtl6B0BdUwMRq3h0VTTkkyd2REyUMdOKmBUHEQMgNRAxsxStBV7GIGIA1An1
IGL2VIcE2nHcIU0Xn2SQkyHPj36auyqtN6dyUURUC4lXBu+lUBFumeyHmxfn
FhGekmd9Uj6Rp+SGgKSBhqUeRIyXojBKsbXghzojkYhDrIjp0ipSBB8FMZW8
o+clmQgSpinOlTv/DJdDROb6U6F3bYV0+44A5IYab+x744sMdd1KSK1c+pmY
Ji2fQljGxUks0SASVVoL0mzMihPlMywoIvOIU94RFAxcCdTFTIwMyKhlWkIR
U6YVBU0iep4YqItegPQO6ouT9MgPiMg8qlzHzeZmrCLBlUCdiJg//oRJjFp8
DERMm1ZSlfhhzpfhzW7Sipi6uKqJGOZhoPGpFxFzB2CbsNPET6tiRSwY1/q0
6nlVJKLCOKW0cks3s+WkvjhRkLiKaDKPKtc7cuai0DHQ4NSNiDnDncFt8HNb
3SrlorvZ7mpNGuB8WkEvnDRkb7ygGPHy/Q/eupCbMnIb7Nw2mEFxxPWSsBkf
kbn+FC9nWFSChqbWd+wLI5xTC+6Wg8jpl5cT9+ukOm14RnUjhHLWoriJS7pt
QXMziGlxwTRUuTGnz1x3ivuu4BUSgEYDfzsJAMg1EDEAQK6BiAEAcg1EDACQ
ayBiAIBcAxEDAOQaV8R6Sr3F4wPPHxpauz8za2sfeLbzwwwzhMFgsMCYXjHV
6u7xRKx4YnD/yeHSwPDlyyNZWV/fwEcfjQ4NDcNgMFjmxvSKqVbH8QFXxDZ2
Xu4dHBkoX+4fHMrKzl/s/vCj0b6BMgwGg2VuTGSYjj13aMgVMTY3K7O508BQ
htZ1oXvkd6O9/WUYDAarhg0ODTPtoiLWOzCUoZ270D38u9FSfxkGg8GqYQoR
6x/K0M6d7x7+cLTUV4bBYLBqGEQMBoPl2gQRG7w8UuofytDOnu++/OFoT1+Z
WseDLfxDLFrm7y8LcWJtdcFqfrAzaap0Fjrc/FBHpEuWNWt1wlPKGpnEN2yl
TPLRXLtkNRqz6wW7omxAELGhkZ7+oQztzPnuoQ9Hu/vK1OyBUFgvBCY1Nigm
PtiZMvmaWa4cmSexfU6UJHkRFdWognKNrXN+sydcQVkz15jWKJvawWCSDZQ5
ERsYGunuG8rQTnd1l0dGL/WWqbW32iImBCa1VWxQtHamTO6M9PYkSWyfEyVJ
XkRFNaqg3Gq1AF+jbGoHg0nWL4hYeeRS31CG9kFX9+DI6MXeMrW9jogJgSvZ
wocE7nWGzF52vP+hieEj/5wQPz4bFM7x+q9ZLQ/s97Oy489aGR6LaVeSBxIG
JdrF+WvbMCvBZy+Hzgeara+tsf8V4gcuyUUQb01qRI6ZKAm4PptVjSuXqyZt
bW2NiLFGZnEULRPRgOoacZVStzYMZm79g5yI9TMR6x3K0D441z04PHqxVKbm
iRgfeLHNnkLs9T46w6rNjTzrgWIYGCT0BoV97IhY0c+n6IhYKSotX5YvUMEp
P7nosxfHHexeibZu+GmJS2IR9JRBjfisVH4aVo0vt4VUjabS1oi7OqpmiW5A
dY3sC+Rfr7aHwgsHg6WyvlqJGMXr/0SLiBBxRkaoiYjp0vIjnU9O9FP0mYhY
qDCkOEMRM6iRKj4d+6ZV07cS57m2RlwRWhHTNqBexLR6CIMlNVnELvYOZWin
znUPDI9eKJWpve7MxITAC34/lyO8TkWv+aHX+cgX/EHkxffHSETaC85ID48l
2BhU+Owl8QYpKc4rnbjEFyGciq+RGP+CrzOiS9FVo/n4KkRyCNpNW6PQFMnp
KXUDamrkrVvlRobBUpggYn3lkQuloQzt/bPd/ZdHz/eUqe2Z32LNXC8E2rba
HoB7ejrvb7a+utoNXP9VZ4Tu4SLYxytmWhPnd/pxWu7v8DPpsEVsRWRa8diL
H2W2z14S6p5bnFc6cYkvQvQ2tkZ8VlzpMc2iLVdRzaDdtDUKTRkY14ARNXIy
tExaHgaLtl5exHoHR86XhjK0k2e7+y6PdvWUqbkiJgQ65gyr1Q99xunbdkgH
OSZjucsZFJ+Z3xmm6vAz8cdURNouf6T7RZDkGiPJvSHfJSUnLvFF0FNGNZKy
Ejw0rJpYri4TbY2I2XHUV03fgNoakTylQBgsmZUGRBHr6hnK0E6c6e4dGj3X
XabmipgQ6Npy1tUntrCO7YU4A+S+juDYsiY+tCeI6UXrvG+i5WfoTFGsWcsj
055zhG45KZR87Lxvph9N8NlLbhfHhrzsIXFJUYR3yqhG9NiuUZhtXLNoy5Wr
OZFrQGWNeHPadiJpnNWz3FS6BlTXyE8llguDpbKaiRhP2JOdWQcdQWFkNnzY
WdWQ97XLGUrOBGN5ZFpP96xA+txh6CEqhpCPoYjxRdBTJjUKjqljHk6GhlXj
XeJaXnDVQMRI5mFrlCMaUC1irupqmhoGS2o1ETEYDAbLygQRKw2MnOsZytCO
n+kuDY2e7S7DYDBYNaynXxSxs91DGdqx09095dEzl8owGAxWDaMitrHz8vle
eyYGEYPBYLkwplddpfDx1MUTg/tODLOQnoGRrKyre2BgeLS7fxgGg8EyN6ZX
TLXajw0Er2xrPzb4fOflDF+ohFe2wWCw6tnGQ0P73gtf2YaX5wIAcgpEDACQ
ayBiAIBcAxEDAOSaaovYCQAAqCbVFjEAAKgqWE4CAHINRAwAkGuCm12Lxwee
P5TyrjOWkCVnmUDEAABjTPBnR8WTwz0Dw+XLIymMJWTJWSYQMQDAGBP8AXhp
YKR34HKpfyiF2QkHRlgmEDEAwBiT1ctzWXKWCUQMADDGQMQAALkmhYi9caT7
nvvbb/7OKxAxAEDNSSFi7QfP/13zup8tOAgRAwDUnKQidqFUfuAnxT/+2FO7
28+lELHig+LbjloeLNak4oy2Aiu/0GYU13ZcjMrSJ/delVEMSfw0KD2L5o+o
eopWSdEmAAQkFbGnVhz99N+s+sd/3XjqXH9KEeO6qzNAc9CDx1bEUuWcWekG
QMRA/ZBUxGbM3H7VJ5Ztf+V0V3c5CxHzwuq+D0PEOCBioH5IJGJrNx7/5KeX
T2hZl/rXSXV3tadjdqj/fxLZHg9uomAlRIYIXR2RYGcctQXn7CyL3CcSrVhS
ZSb5GCNi7mGYAz+M3emmG95GM1L5H0b2/SDl6JsiopTY9k/Zwur66ls1sbcA
mBAhYs8+/94LW0+9f7YvCPmrv1398b9Y3rbhWMYi5qsVPwCCuO448E7YnT8c
0gU/NjedcwaIF8kbRPQTidaiTF988MHkImZZnNRwzgTF8Ktnnf+CEAgipmyK
iFLiqhGVbWQLa+vLtSrnlRfJ0FsATIgQsU/95W+u+tTTD/ykyI4v9g7t6ej6
048vvX7K5gulcsYiFnZ8adLhHym0TZeHOKOTPvHTJ0UcBQYiRk+HLourK21J
NGKkiKmawrQUcWOfaHsFLcxloG5gLl/jNgHAgAgRu2/+nqs+ueyqTyxrW/8e
E66/Htf2sU8+/cSyI8qVZjYzMdK/SUw+kTzgVCsy7fpGOcbiR5HRclJxTkon
BCj9jxYxRVPElRIXXmELl4S2JK0q4i/tjbwFwIQIEfugq/+zn3vhj/7syT//
1NPXTd7MDr415xXhR8nM9sTE8Usj6oYYXTVGSEpmIibuV5uImJQzqYzW/8Qi
FlWKVI0EImbYwiW9iGlmdBAxkB3RG/svv3a26e/XMfli9scfe2rryx/o9vwr
EDGhTwe78tz2d+z0g6pMYhFTSVSs59RvcVwGn6Wcw5gR0580MzHj5aS5iEW2
sLq+Jq1q7C0AJsT+Ovk//9vpKtisb+06eaYvYxFz1yqSOLS0iKMnZuRyO9PJ
Rcybc0Rs7Et3gnB708LmtLRvrdzE1vuv38bTyYqTvrKN/aQtHFFfdauSXwmw
sQ8yJFbEOt++9C+f33TVJ5YVOy9c7NXefZH2jn3dSFNuCItnuZ/4K1lO+h+l
zakI78W5BL2pQ14tBeHiOlnlf3hGfYuFsqG0pWhrEJaQroXV9dW3Kg038hYA
E0zuE9v+29Of+9JLp88PRNxCluXfTkobLvVPvblcb/4AUD1MROzcpcEDh6Om
YZmKmMH+VP1RX6KBPSZwJVFXzxPzlh45HH81FzH+doYctiAAaQkeT32pb4TN
tS6U0pgzScPjqQEANSB4UUj7ieELvcO9gyMpjCVkyTuO40UhAICxJnhlW/ux
wY1pX9nGErLkeGUbAGDswctzAQC5BiIGAMg1EDEAQK6BiAEAcg1EDACQayBi
AIBcAxEDAOSamogY/yyFuvsbGflRDzX8kyL+aTZVK0IqoXrl1vxPtECDMeYi
Jj1BrK1QGxXTjyXpyTD5eeJVKoGI/3vxTHUHIgayZYxFrI4eUZFAxErSIxHr
FYgYuPIYWxGLGS7cOk58smtwUv0Ed/kppPxC0M3Em1MV6DMfJIe0LwJwQjXl
qp0UayU+nTHLl2NyD7KQn7uon0vqlpPkOfsR2apbuK0UXXGIGMiMMRWxSA3j
5zr0E/dk5PDJxtKjUBUveOOfaN/SUjAZSzGvZFKXq3GSPpSZryJ9CYc33Okn
Eq1FmV75DG2+UvomFRNFiJg6W4MWjqg4RAxkSN2ImNS1NbJEwpWPbVbMXLRv
7EgkYtzcRC5X56S2ltJz9NXTL20KJRHSE1mxJCJm3ML6ikPEQIbUi4gpTgWd
XfsEeEUM/uGAZA2k2q1PNxNTexbx9Hv1s/kTvwjA5Hmt4ls6dE0qhiYQMfMW
Nqo4AJUypiIW8V2dSsT8KCSCdqRXLGLCQBbK1TpJV40RE5J8iZhJCxtWHIBK
GduNff1vfLK+8Su1qBc0tglaohwiFYqYMHSlcqPeehYpwEpvlEPe5JddcQet
CstJwxY2rTgAlTLm94nxX9Cl8D4x/u5K8cdG3UrNHhEMLj8+n0IoAdLNX+qJ
jRhVurUtKDd+0Ea+ujGZiAlV023sCxtt6iaNSKRyKDpbZQubVhyASqnFHfv8
HfHxNyNEiRj3QyANE/ORZyHcux31/qliyG6kfHVjMhHjq6adDlGXNU2qba4g
nuJ3TpKtSQubVRyASsHfTqYEQxGA+oAp2P8DpQp2MA==
    "], {{0, 124.8}, {244.2, 0}}, {0, 255},
    ColorFunction->RGBColor,
    ImageResolution->120],
   BoxForm`ImageTag["Byte", ColorSpace -> "RGB", Interleaving -> True],
   Selectable->False],
  DefaultBaseStyle->"ImageGraphics",
  ImageSize->Automatic,
  ImageSizeRaw->{244.2, 124.8},
  PlotRange->{{0, 244.2}, {
    0, 124.8}}]], \
"Input",ExpressionUUID->"04b089da-a6fa-4c2c-adbb-167da699f792"]], "Text",
 CellChangeTimes->{{3.8784731495809073`*^9, 3.87847317620543*^9}},
 CellID->114793826,ExpressionUUID->"b57ce971-918c-487a-81bc-6b1b042dc5e3"]
}, Closed]],

Cell[CellGroupData[{

Cell["Examples", "Subsection",
 CellChangeTimes->{{3.878126435979248*^9, 3.8781264375323377`*^9}},
 CellID->64426075,ExpressionUUID->"567fd1c0-4c1e-4081-9f8d-b3fc817863d3"],

Cell[CellGroupData[{

Cell["Zigzag graphene nanoribbons", "Subsubsection",
 CellChangeTimes->{{3.878132200336951*^9, 3.878132207699372*^9}},
 CellID->115823570,ExpressionUUID->"e56c4039-3e51-487c-8397-b6420fd0ab78"],

Cell[CellGroupData[{

Cell[TextData[{
 "XXXX ",
 ButtonBox["Y.-W. Son, M. L. Cohen, and S. G. Louie, ",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1103/PhysRevLett.97.216803"], None}],
 StyleBox[ButtonBox["Phys. Rev. Lett.",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1103/PhysRevLett.97.216803"], None}],
  FontSlant->"Italic"],
 ButtonBox[" ",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1103/PhysRevLett.97.216803"], None}],
 StyleBox[ButtonBox["97",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1103/PhysRevLett.97.216803"], None}],
  FontWeight->"Bold"],
 ButtonBox[", 216803 (2006)",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1103/PhysRevLett.97.216803"], None}],
 "."
}], "Text",
 CellChangeTimes->{{3.878132408659866*^9, 3.878132422103635*^9}, {
  3.878132497589953*^9, 3.878132497701959*^9}},
 CellID->541116115,ExpressionUUID->"63b696c3-4f2f-4bc9-adba-3a9b5c62d997"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"ruc", ",", "T", ",", "a0"}], "}"}], "=", 
    RowBox[{"Nanoribbon", "[", "6", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"AtomicStructure", "[", 
  RowBox[{"data", ",", 
   RowBox[{"PlaneProjection", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", "0"}], "}"}]}], ",", 
   RowBox[{"AtomEnumeration", "\[Rule]", "True"}]}], "]"}]}], "Input",
 CellChangeTimes->{3.878476247264085*^9},
 CellLabel->"In[30]:=",
 CellID->163654459,ExpressionUUID->"d1750d16-8095-4d1f-9f04-afcf7cff6f88"],

Cell[BoxData[
 GraphicsBox[{{
    TagBox[
     TooltipBox[
      DynamicBox[If[
        CurrentValue["MouseOver"], {
         GrayLevel[0.5], 
         AbsoluteThickness[3], 
         LineBox[{{0., 0.}, {-0.71, 1.2297560733739028`}}], 
         GrayLevel[0.5], 
         AbsoluteThickness[1], 
         LineBox[{{0., 0.}, {-0.71, 1.2297560733739028`}}]}, {
         GrayLevel[0.5], 
         AbsoluteThickness[1], 
         LineBox[{{0., 0.}, {-0.71, 1.2297560733739028`}}]}],
       ImageSizeCache->{{18.421906838964695`, 
        46.895818913543664`}, {-27.309616881564235`, 19.9380931610353}}],
      "\"  1.420 \[Angstrom]\"",
      TooltipStyle->{Background -> GrayLevel[1]}],
     Annotation[#, "  1.420 \[Angstrom]", "Tooltip"]& ], 
    TagBox[
     TooltipBox[
      DynamicBox[If[
        CurrentValue["MouseOver"], {
         GrayLevel[0.5], 
         AbsoluteThickness[3], 
         LineBox[{{0., 0.}, {1.42, 0.}}], 
         GrayLevel[0.5], 
         AbsoluteThickness[1], 
         LineBox[{{0., 0.}, {1.42, 0.}}]}, {
         GrayLevel[0.5], 
         AbsoluteThickness[1], 
         LineBox[{{0., 0.}, {1.42, 0.}}]}],
       ImageSizeCache->{{44.067391788797465`, 98.1867888132092}, {
        17.109666036289113`, 19.9380931610353}}],
      "\"  1.420 \[Angstrom]\"",
      TooltipStyle->{Background -> GrayLevel[1]}],
     Annotation[#, "  1.420 \[Angstrom]", "Tooltip"]& ], 
    TagBox[
     TooltipBox[
      DynamicBox[If[
        CurrentValue["MouseOver"], {
         GrayLevel[0.5], 
         AbsoluteThickness[3], 
         LineBox[{{1.42, 0.}, {2.13, 1.2297560733739028`}}], 
         GrayLevel[0.5], 
         AbsoluteThickness[1], 
         LineBox[{{1.42, 0.}, {2.13, 1.2297560733739028`}}]}, {
         GrayLevel[0.5], 
         AbsoluteThickness[1], 
         LineBox[{{1.42, 0.}, {2.13, 1.2297560733739028`}}]}],
       ImageSizeCache->{{95.35836168846302, 
        123.832273763042}, {-27.309616881564235`, 19.9380931610353}}],
      "\"  1.420 \[Angstrom]\"",
      TooltipStyle->{Background -> GrayLevel[1]}],
     Annotation[#, "  1.420 \[Angstrom]", "Tooltip"]& ], 
    TagBox[
     TooltipBox[
      DynamicBox[If[
        CurrentValue["MouseOver"], {
         GrayLevel[0.5], 
         AbsoluteThickness[3], 
         LineBox[{{2.13, 1.2297560733739028`}, {3.55, 1.2297560733739028`}}], 
         GrayLevel[0.5], 
         AbsoluteThickness[1], 
         LineBox[{{2.13, 1.2297560733739028`}, {3.55, 
          1.2297560733739028`}}]}, {
         GrayLevel[0.5], 
         AbsoluteThickness[1], 
         LineBox[{{2.13, 1.2297560733739028`}, {3.55, 1.2297560733739028`}}]}],
       ImageSizeCache->{{121.00384663829578`, 
        175.12324366270755`}, {-27.309616881564242`, -24.481189756818033`}}],
      "\"  1.420 \[Angstrom]\"",
      TooltipStyle->{Background -> GrayLevel[1]}],
     Annotation[#, "  1.420 \[Angstrom]", "Tooltip"]& ], 
    TagBox[
     TooltipBox[
      DynamicBox[If[
        CurrentValue["MouseOver"], {
         GrayLevel[0.5], 
         AbsoluteThickness[3], 
         LineBox[{{4.26, 0.}, {3.55, 1.2297560733739028`}}], 
         GrayLevel[0.5], 
         AbsoluteThickness[1], 
         LineBox[{{4.26, 0.}, {3.55, 1.2297560733739028`}}]}, {
         GrayLevel[0.5], 
         AbsoluteThickness[1], 
         LineBox[{{4.26, 0.}, {3.55, 1.2297560733739028`}}]}],
       ImageSizeCache->{{172.29481653796134`, 
        200.76872861254031`}, {-27.309616881564246`, 19.93809316103531}}],
      "\"  1.420 \[Angstrom]\"",
      TooltipStyle->{Background -> GrayLevel[1]}],
     Annotation[#, "  1.420 \[Angstrom]", "Tooltip"]& ], 
    TagBox[
     TooltipBox[
      DynamicBox[If[
        CurrentValue["MouseOver"], {
         GrayLevel[0.5], 
         AbsoluteThickness[3], 
         LineBox[{{4.26, 0.}, {5.68, 0.}}], 
         GrayLevel[0.5], 
         AbsoluteThickness[1], 
         LineBox[{{4.26, 0.}, {5.68, 0.}}]}, {
         GrayLevel[0.5], 
         AbsoluteThickness[1], 
         LineBox[{{4.26, 0.}, {5.68, 0.}}]}],
       ImageSizeCache->{{197.94030148779413`, 252.05969851220584`}, {
        17.109666036289102`, 19.93809316103531}}],
      "\"  1.420 \[Angstrom]\"",
      TooltipStyle->{Background -> GrayLevel[1]}],
     Annotation[#, "  1.420 \[Angstrom]", "Tooltip"]& ], 
    TagBox[
     TooltipBox[
      DynamicBox[If[
        CurrentValue["MouseOver"], {
         GrayLevel[0.5], 
         AbsoluteThickness[3], 
         LineBox[{{5.68, 0.}, {6.39, 1.2297560733739028`}}], 
         GrayLevel[0.5], 
         AbsoluteThickness[1], 
         LineBox[{{5.68, 0.}, {6.39, 1.2297560733739028`}}]}, {
         GrayLevel[0.5], 
         AbsoluteThickness[1], 
         LineBox[{{5.68, 0.}, {6.39, 1.2297560733739028`}}]}],
       ImageSizeCache->{{249.23127138745966`, 
        277.70518346203863`}, {-27.309616881564246`, 19.93809316103531}}],
      "\"  1.420 \[Angstrom]\"",
      TooltipStyle->{Background -> GrayLevel[1]}],
     Annotation[#, "  1.420 \[Angstrom]", "Tooltip"]& ], 
    TagBox[
     TooltipBox[
      DynamicBox[If[
        CurrentValue["MouseOver"], {
         GrayLevel[0.5], 
         AbsoluteThickness[3], 
         LineBox[{{6.39, 1.2297560733739028`}, {7.81, 1.2297560733739028`}}], 
         GrayLevel[0.5], 
         AbsoluteThickness[1], 
         LineBox[{{6.39, 1.2297560733739028`}, {7.81, 
          1.2297560733739028`}}]}, {
         GrayLevel[0.5], 
         AbsoluteThickness[1], 
         LineBox[{{6.39, 1.2297560733739028`}, {7.81, 1.2297560733739028`}}]}],
       ImageSizeCache->{{274.8767563372924, 
        328.9961533617042}, {-27.309616881564242`, -24.481189756818033`}}],
      "\"  1.420 \[Angstrom]\"",
      TooltipStyle->{Background -> GrayLevel[1]}],
     Annotation[#, "  1.420 \[Angstrom]", "Tooltip"]& ], 
    TagBox[
     TooltipBox[
      DynamicBox[If[
        CurrentValue["MouseOver"], {
         GrayLevel[0.5], 
         AbsoluteThickness[3], 
         LineBox[{{8.52, 0.}, {7.81, 1.2297560733739028`}}], 
         GrayLevel[0.5], 
         AbsoluteThickness[1], 
         LineBox[{{8.52, 0.}, {7.81, 1.2297560733739028`}}]}, {
         GrayLevel[0.5], 
         AbsoluteThickness[1], 
         LineBox[{{8.52, 0.}, {7.81, 1.2297560733739028`}}]}],
       ImageSizeCache->{{326.167726236958, 
        354.641638311537}, {-27.309616881564246`, 19.93809316103531}}],
      "\"  1.420 \[Angstrom]\"",
      TooltipStyle->{Background -> GrayLevel[1]}],
     Annotation[#, "  1.420 \[Angstrom]", "Tooltip"]& ], 
    TagBox[
     TooltipBox[
      DynamicBox[If[
        CurrentValue["MouseOver"], {
         GrayLevel[0.5], 
         AbsoluteThickness[3], 
         LineBox[{{8.52, 0.}, {9.94, 0.}}], 
         GrayLevel[0.5], 
         AbsoluteThickness[1], 
         LineBox[{{8.52, 0.}, {9.94, 0.}}]}, {
         GrayLevel[0.5], 
         AbsoluteThickness[1], 
         LineBox[{{8.52, 0.}, {9.94, 0.}}]}],
       ImageSizeCache->{{351.8132111867908, 405.93260821120253`}, {
        17.109666036289102`, 19.93809316103531}}],
      "\"  1.420 \[Angstrom]\"",
      TooltipStyle->{Background -> GrayLevel[1]}],
     Annotation[#, "  1.420 \[Angstrom]", "Tooltip"]& ], 
    TagBox[
     TooltipBox[
      DynamicBox[If[
        CurrentValue["MouseOver"], {
         GrayLevel[0.5], 
         AbsoluteThickness[3], 
         LineBox[{{9.94, 0.}, {10.649999999999999`, 1.2297560733739028`}}], 
         GrayLevel[0.5], 
         AbsoluteThickness[1], 
         LineBox[{{9.94, 0.}, {10.649999999999999`, 1.2297560733739028`}}]}, {
         GrayLevel[0.5], 
         AbsoluteThickness[1], 
         LineBox[{{9.94, 0.}, {10.649999999999999`, 1.2297560733739028`}}]}],
       ImageSizeCache->{{403.1041810864563, 
        431.57809316103527`}, {-27.309616881564246`, 19.93809316103531}}],
      "\"  1.420 \[Angstrom]\"",
      TooltipStyle->{Background -> GrayLevel[1]}],
     Annotation[#, "  1.420 \[Angstrom]", "Tooltip"]& ]}, {
    TagBox[
     TooltipBox[
      DynamicBox[If[
        CurrentValue["MouseOver"], {
         EdgeForm[
          GrayLevel[0.5]], 
         GrayLevel[0.5], 
         DiskBox[{0., 0.}, 0.3]}, {
         GrayLevel[0.5], 
         DiskBox[{0., 0.}, 0.3], {
          GrayLevel[1], 
          InsetBox[
           FormBox[
            StyleBox["\"1\"", 10, StripOnInput -> False], TraditionalForm], {
           0., 0.}]}}],
       ImageSizeCache->{{34.64548494983277, 56.31772575250835}, {
        7.687759197324414, 29.36}}],
      "\"(  0.000,  0.000) \[Angstrom]\"",
      TooltipStyle->{Background -> GrayLevel[1]}],
     Annotation[#, "(  0.000,  0.000) \[Angstrom]", "Tooltip"]& ], 
    TagBox[
     TooltipBox[
      DynamicBox[If[
        CurrentValue["MouseOver"], {
         EdgeForm[
          GrayLevel[0.5]], 
         GrayLevel[0.5], 
         DiskBox[{-0.71, 1.2297560733739028`}, 0.3]}, {
         GrayLevel[0.5], 
         DiskBox[{-0.71, 1.2297560733739028`}, 0.3], {
          GrayLevel[1], 
          InsetBox[
           FormBox[
            StyleBox["\"2\"", 10, StripOnInput -> False], 
            TraditionalForm], {-0.71, 1.2297560733739028`}]}}],
       ImageSizeCache->{{8.999999999999998, 
        30.67224080267558}, {-36.73152372052893, -15.059282917853348`}}],
      "\"( -0.710,  1.230) \[Angstrom]\"",
      TooltipStyle->{Background -> GrayLevel[1]}],
     Annotation[#, "( -0.710,  1.230) \[Angstrom]", "Tooltip"]& ], 
    TagBox[
     TooltipBox[
      DynamicBox[If[
        CurrentValue["MouseOver"], {
         EdgeForm[
          GrayLevel[0.5]], 
         GrayLevel[0.5], 
         DiskBox[{1.42, 0.}, 0.3]}, {
         GrayLevel[0.5], 
         DiskBox[{1.42, 0.}, 0.3], {
          GrayLevel[1], 
          InsetBox[
           FormBox[
            StyleBox["\"3\"", 10, StripOnInput -> False], TraditionalForm], {
           1.42, 0.}]}}],
       ImageSizeCache->{{85.93645484949832, 107.6086956521739}, {
        7.687759197324414, 29.36}}],
      "\"(  1.420,  0.000) \[Angstrom]\"",
      TooltipStyle->{Background -> GrayLevel[1]}],
     Annotation[#, "(  1.420,  0.000) \[Angstrom]", "Tooltip"]& ], 
    TagBox[
     TooltipBox[
      DynamicBox[If[
        CurrentValue["MouseOver"], {
         EdgeForm[
          GrayLevel[0.5]], 
         GrayLevel[0.5], 
         DiskBox[{2.13, 1.2297560733739028`}, 0.3]}, {
         GrayLevel[0.5], 
         DiskBox[{2.13, 1.2297560733739028`}, 0.3], {
          GrayLevel[1], 
          InsetBox[
           FormBox[
            StyleBox["\"4\"", 10, StripOnInput -> False], TraditionalForm], {
           2.13, 1.2297560733739028`}]}}],
       ImageSizeCache->{{111.5819397993311, 
        133.25418060200667`}, {-36.73152372052893, -15.059282917853348`}}],
      "\"(  2.130,  1.230) \[Angstrom]\"",
      TooltipStyle->{Background -> GrayLevel[1]}],
     Annotation[#, "(  2.130,  1.230) \[Angstrom]", "Tooltip"]& ], 
    TagBox[
     TooltipBox[
      DynamicBox[If[
        CurrentValue["MouseOver"], {
         EdgeForm[
          GrayLevel[0.5]], 
         GrayLevel[0.5], 
         DiskBox[{4.26, 0.}, 0.3]}, {
         GrayLevel[0.5], 
         DiskBox[{4.26, 0.}, 0.3], {
          GrayLevel[1], 
          InsetBox[
           FormBox[
            StyleBox["\"5\"", 10, StripOnInput -> False], TraditionalForm], {
           4.26, 0.}]}}],
       ImageSizeCache->{{188.51839464882946`, 210.19063545150505`}, {
        7.687759197324414, 29.36}}],
      "\"(  4.260,  0.000) \[Angstrom]\"",
      TooltipStyle->{Background -> GrayLevel[1]}],
     Annotation[#, "(  4.260,  0.000) \[Angstrom]", "Tooltip"]& ], 
    TagBox[
     TooltipBox[
      DynamicBox[If[
        CurrentValue["MouseOver"], {
         EdgeForm[
          GrayLevel[0.5]], 
         GrayLevel[0.5], 
         DiskBox[{3.55, 1.2297560733739028`}, 0.3]}, {
         GrayLevel[0.5], 
         DiskBox[{3.55, 1.2297560733739028`}, 0.3], {
          GrayLevel[1], 
          InsetBox[
           FormBox[
            StyleBox["\"6\"", 10, StripOnInput -> False], TraditionalForm], {
           3.55, 1.2297560733739028`}]}}],
       ImageSizeCache->{{162.87290969899666`, 
        184.54515050167225`}, {-36.73152372052893, -15.059282917853348`}}],
      "\"(  3.550,  1.230) \[Angstrom]\"",
      TooltipStyle->{Background -> GrayLevel[1]}],
     Annotation[#, "(  3.550,  1.230) \[Angstrom]", "Tooltip"]& ], 
    TagBox[
     TooltipBox[
      DynamicBox[If[
        CurrentValue["MouseOver"], {
         EdgeForm[
          GrayLevel[0.5]], 
         GrayLevel[0.5], 
         DiskBox[{5.68, 0.}, 0.3]}, {
         GrayLevel[0.5], 
         DiskBox[{5.68, 0.}, 0.3], {
          GrayLevel[1], 
          InsetBox[
           FormBox[
            StyleBox["\"7\"", 10, StripOnInput -> False], TraditionalForm], {
           5.68, 0.}]}}],
       ImageSizeCache->{{239.80936454849498`, 261.4816053511706}, {
        7.687759197324414, 29.36}}],
      "\"(  5.680,  0.000) \[Angstrom]\"",
      TooltipStyle->{Background -> GrayLevel[1]}],
     Annotation[#, "(  5.680,  0.000) \[Angstrom]", "Tooltip"]& ], 
    TagBox[
     TooltipBox[
      DynamicBox[If[
        CurrentValue["MouseOver"], {
         EdgeForm[
          GrayLevel[0.5]], 
         GrayLevel[0.5], 
         DiskBox[{6.39, 1.2297560733739028`}, 0.3]}, {
         GrayLevel[0.5], 
         DiskBox[{6.39, 1.2297560733739028`}, 0.3], {
          GrayLevel[1], 
          InsetBox[
           FormBox[
            StyleBox["\"8\"", 10, StripOnInput -> False], TraditionalForm], {
           6.39, 1.2297560733739028`}]}}],
       ImageSizeCache->{{265.45484949832775`, 
        287.1270903010033}, {-36.73152372052893, -15.059282917853348`}}],
      "\"(  6.390,  1.230) \[Angstrom]\"",
      TooltipStyle->{Background -> GrayLevel[1]}],
     Annotation[#, "(  6.390,  1.230) \[Angstrom]", "Tooltip"]& ], 
    TagBox[
     TooltipBox[
      DynamicBox[If[
        CurrentValue["MouseOver"], {
         EdgeForm[
          GrayLevel[0.5]], 
         GrayLevel[0.5], 
         DiskBox[{8.52, 0.}, 0.3]}, {
         GrayLevel[0.5], 
         DiskBox[{8.52, 0.}, 0.3], {
          GrayLevel[1], 
          InsetBox[
           FormBox[
            StyleBox["\"9\"", 10, StripOnInput -> False], TraditionalForm], {
           8.52, 0.}]}}],
       ImageSizeCache->{{342.3913043478261, 364.0635451505017}, {
        7.687759197324414, 29.36}}],
      "\"(  8.520,  0.000) \[Angstrom]\"",
      TooltipStyle->{Background -> GrayLevel[1]}],
     Annotation[#, "(  8.520,  0.000) \[Angstrom]", "Tooltip"]& ], 
    TagBox[
     TooltipBox[
      DynamicBox[If[
        CurrentValue["MouseOver"], {
         EdgeForm[
          GrayLevel[0.5]], 
         GrayLevel[0.5], 
         DiskBox[{7.81, 1.2297560733739028`}, 0.3]}, {
         GrayLevel[0.5], 
         DiskBox[{7.81, 1.2297560733739028`}, 0.3], {
          GrayLevel[1], 
          InsetBox[
           FormBox[
            StyleBox["\"10\"", 10, StripOnInput -> False], TraditionalForm], {
           7.81, 1.2297560733739028`}]}}],
       ImageSizeCache->{{316.74581939799333`, 
        338.4180602006689}, {-36.73152372052893, -15.059282917853348`}}],
      "\"(  7.810,  1.230) \[Angstrom]\"",
      TooltipStyle->{Background -> GrayLevel[1]}],
     Annotation[#, "(  7.810,  1.230) \[Angstrom]", "Tooltip"]& ], 
    TagBox[
     TooltipBox[
      DynamicBox[If[
        CurrentValue["MouseOver"], {
         EdgeForm[
          GrayLevel[0.5]], 
         GrayLevel[0.5], 
         DiskBox[{9.94, 0.}, 0.3]}, {
         GrayLevel[0.5], 
         DiskBox[{9.94, 0.}, 0.3], {
          GrayLevel[1], 
          InsetBox[
           FormBox[
            StyleBox["\"11\"", 10, StripOnInput -> False], TraditionalForm], {
           9.94, 0.}]}}],
       ImageSizeCache->{{393.68227424749165`, 415.3545150501672}, {
        7.687759197324414, 29.36}}],
      "\"(  9.940,  0.000) \[Angstrom]\"",
      TooltipStyle->{Background -> GrayLevel[1]}],
     Annotation[#, "(  9.940,  0.000) \[Angstrom]", "Tooltip"]& ], 
    TagBox[
     TooltipBox[
      DynamicBox[If[
        CurrentValue["MouseOver"], {
         EdgeForm[
          GrayLevel[0.5]], 
         GrayLevel[0.5], 
         DiskBox[{10.649999999999999`, 1.2297560733739028`}, 0.3]}, {
         GrayLevel[0.5], 
         DiskBox[{10.649999999999999`, 1.2297560733739028`}, 0.3], {
          GrayLevel[1], 
          InsetBox[
           FormBox[
            StyleBox["\"12\"", 10, StripOnInput -> False], TraditionalForm], {
           10.649999999999999`, 1.2297560733739028`}]}}],
       ImageSizeCache->{{419.3277591973244, 
        440.99999999999994`}, {-36.73152372052893, -15.059282917853348`}}],
      "\"( 10.650,  1.230) \[Angstrom]\"",
      TooltipStyle->{Background -> GrayLevel[1]}],
     Annotation[#, "( 10.650,  1.230) \[Angstrom]", "Tooltip"]& ]}},
  ImageSize->{300}]], "Output",
 CellChangeTimes->{3.878476414292638*^9},
 CellLabel->"Out[33]=",
 CellID->297566894,ExpressionUUID->"4a9c0f25-b32d-46bf-8b5b-c624dcb5144b"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"t1", "=", "2.7"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"U", "=", "t1"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"np", "=", "50"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"klist", "=", 
   RowBox[{"Table", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{"0", ",", 
       RowBox[{
        FractionBox[
         RowBox[{"2", "\[Pi]", " "}], 
         SqrtBox[
          RowBox[{"T", ".", "T"}]]], " ", 
        FractionBox["i", "np"]}], ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"i", ",", "0", ",", 
       RowBox[{"np", "-", "1"}]}], "}"}]}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Temp", "=", "4"}], ";"}], 
  RowBox[{"(*", " ", "K", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "FM", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"spinconfig", "=", 
   RowBox[{"{", "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"Length", "[", "ruc", "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"1", ",", 
       RowBox[{"Length", "[", "ruc", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
    "}"}]}], "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"AbsoluteTiming", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"bdup", ",", "bddo", ",", "\[Mu]", ",", "occnumbers"}], "}"}], 
    "=", 
    RowBox[{"HubbardMeanField", "[", 
     RowBox[{"ruc", ",", "T", ",", "klist", ",", "U", ",", "t1", ",", 
      RowBox[{"\"\<Temperature\>\"", "\[Rule]", "Temp"}], ",", 
      RowBox[{"\"\<SpinDensityScaleFactor\>\"", "\[Rule]", "2"}], ",", 
      RowBox[{"\"\<CMonitor\>\"", "\[Rule]", "True"}], ",", 
      RowBox[{"\"\<SpinConfiguration\>\"", "\[Rule]", "spinconfig"}]}], 
     "]"}]}], ";"}], "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{
  3.878476266581189*^9, {3.878476428977478*^9, 3.8784764414981947`*^9}},
 CellLabel->"In[34]:=",
 CellID->203993768,ExpressionUUID->"c3282c42-f6c1-4397-bece-6d2346102734"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0",
      ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1",
      ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.8784764483595867`*^9},
 CellLabel->"Out[38]=",
 CellID->572603121,ExpressionUUID->"1ec0c2c2-1cf9-4fcd-9da5-3a2c026ff534"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TagBox["\<\"HubbardMeanField initial spin density:\"\>",
   "EchoLabel"], " ", 
  GraphicsBox[{{
     {RGBColor[1, 0, 0], Opacity[0.5], DiskBox[{0., 0.}, 1.]}, 
     {RGBColor[1, 0, 0], Opacity[0.5], 
      DiskBox[{-0.71, 1.2297560733739028`}, 1.]}, 
     {RGBColor[1, 0, 0], Opacity[0.5], DiskBox[{1.42, 0.}, 1.]}, 
     {RGBColor[1, 0, 0], Opacity[0.5], 
      DiskBox[{2.13, 1.2297560733739028`}, 1.]}, 
     {RGBColor[1, 0, 0], Opacity[0.5], DiskBox[{4.26, 0.}, 1.]}, 
     {RGBColor[1, 0, 0], Opacity[0.5], 
      DiskBox[{3.55, 1.2297560733739028`}, 1.]}, 
     {RGBColor[1, 0, 0], Opacity[0.5], DiskBox[{5.68, 0.}, 1.]}, 
     {RGBColor[1, 0, 0], Opacity[0.5], 
      DiskBox[{6.39, 1.2297560733739028`}, 1.]}, 
     {RGBColor[1, 0, 0], Opacity[0.5], DiskBox[{8.52, 0.}, 1.]}, 
     {RGBColor[1, 0, 0], Opacity[0.5], 
      DiskBox[{7.81, 1.2297560733739028`}, 1.]}, 
     {RGBColor[1, 0, 0], Opacity[0.5], DiskBox[{9.94, 0.}, 1.]}, 
     {RGBColor[1, 0, 0], Opacity[0.5], 
      DiskBox[{10.649999999999999`, 1.2297560733739028`}, 1.]}}, 
    {GrayLevel[0.5], Opacity[0.1], DiskBox[{0., 0.}, 0.3], 
     DiskBox[{-0.71, 1.2297560733739028`}, 0.3], DiskBox[{1.42, 0.}, 0.3], 
     DiskBox[{2.13, 1.2297560733739028`}, 0.3], DiskBox[{4.26, 0.}, 0.3], 
     DiskBox[{3.55, 1.2297560733739028`}, 0.3], DiskBox[{5.68, 0.}, 0.3], 
     DiskBox[{6.39, 1.2297560733739028`}, 0.3], DiskBox[{8.52, 0.}, 0.3], 
     DiskBox[{7.81, 1.2297560733739028`}, 0.3], DiskBox[{9.94, 0.}, 0.3], 
     DiskBox[{10.649999999999999`, 1.2297560733739028`}, 0.3]}}]}]], "Echo",
 CellChangeTimes->{3.878476448376588*^9},
 CellID->18648108,ExpressionUUID->"1eb9a258-cc8f-4a3d-8834-723fd0612850"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"HubbardMeanField SCE convergence:\"\>",
   "EchoLabel"], " ", 
  GraphicsBox[{{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], 
     PointBox[{{1., 2.2719422066644683`}, {2., 0.08547492023681927}, {3., 
      0.020266531310766295`}, {4., 0.0037930912757251603`}, {5., 
      0.0012817578499626657`}, {6., 0.00043487903754828257`}, {7., 
      0.0001476088126063611}, {8., 0.00005011007727776579}, {9., 
      0.000017013563039925753`}, {10., 5.777437942245331*^-6}, {11., 
      1.9623709284323324`*^-6}, {12., 6.668135559586125*^-7}}]}, {{}, {}}},
   AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
   Axes->{True, True},
   AxesLabel->{None, None},
   AxesOrigin->{0., 0},
   DisplayFunction->Identity,
   Frame->{{False, False}, {False, False}},
   FrameLabel->{{None, None}, {None, None}},
   FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
   GridLines->{None, None},
   GridLinesStyle->Directive[
     GrayLevel[0.5, 0.4]],
   ImagePadding->{{20, 20}, {20, 20}},
   ImageSize->{225., 150.},
   Method->{
    "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
     "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
         Identity[
          Part[#, 1]], 
         Identity[
          Part[#, 2]]}& ), "CopiedValueFunction" -> ({
         Identity[
          Part[#, 1]], 
         Identity[
          Part[#, 2]]}& )}},
   PlotLabel->FormBox[
    "\"occ. numbers \[CapitalDelta]-convergence\"", TraditionalForm],
   PlotRange->{{0., 12.}, {-0.01, 1}},
   PlotRangeClipping->True,
   PlotRangePadding->{{
      Scaled[0.02], 
      Scaled[0.02]}, {0, 0}},
   Ticks->{Automatic, Automatic}]}]], "Echo",
 CellChangeTimes->{3.878476457771125*^9},
 CellID->47006840,ExpressionUUID->"3b1f3a35-03c2-4761-83f0-0d5d1696be12"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"HubbardMeanField final spin density:\"\>",
   "EchoLabel"], " ", 
  GraphicsBox[{{
     {RGBColor[0, 0, 1], Opacity[0.5], 
      DiskBox[{0., 0.}, 0.03510902011119921]}, 
     {RGBColor[1, 0, 0], Opacity[0.5], 
      DiskBox[{-0.71, 1.2297560733739028`}, 0.235112129665416]}, 
     {RGBColor[1, 0, 0], Opacity[0.5], 
      DiskBox[{1.42, 0.}, 0.03249205917258624]}, 
     {RGBColor[0, 0, 1], Opacity[0.5], 
      DiskBox[{2.13, 1.2297560733739028`}, 0.013574129275833346]}, 
     {RGBColor[0, 0, 1], Opacity[0.5], 
      DiskBox[{4.26, 0.}, 0.004185779137968859]}, 
     {RGBColor[1, 0, 0], Opacity[0.5], 
      DiskBox[{3.55, 1.2297560733739028`}, 0.005264741864934197]}, 
     {RGBColor[0, 0, 1], Opacity[0.5], 
      DiskBox[{5.68, 0.}, 0.004185772391397169]}, 
     {RGBColor[1, 0, 0], Opacity[0.5], 
      DiskBox[{6.39, 1.2297560733739028`}, 0.005264734757416734]}, 
     {RGBColor[1, 0, 0], Opacity[0.5], 
      DiskBox[{8.52, 0.}, 0.03249205207973388]}, 
     {RGBColor[0, 0, 1], Opacity[0.5], 
      DiskBox[{7.81, 1.2297560733739028`}, 0.01357412342171943]}, 
     {RGBColor[0, 0, 1], Opacity[0.5], 
      DiskBox[{9.94, 0.}, 0.03510901583146536]}, 
     {RGBColor[1, 0, 0], Opacity[0.5], 
      DiskBox[{10.649999999999999`, 1.2297560733739028`}, 
       0.23511212262949832]}}, 
    {GrayLevel[0.5], Opacity[0.1], DiskBox[{0., 0.}, 0.3], 
     DiskBox[{-0.71, 1.2297560733739028`}, 0.3], DiskBox[{1.42, 0.}, 0.3], 
     DiskBox[{2.13, 1.2297560733739028`}, 0.3], DiskBox[{4.26, 0.}, 0.3], 
     DiskBox[{3.55, 1.2297560733739028`}, 0.3], DiskBox[{5.68, 0.}, 0.3], 
     DiskBox[{6.39, 1.2297560733739028`}, 0.3], DiskBox[{8.52, 0.}, 0.3], 
     DiskBox[{7.81, 1.2297560733739028`}, 0.3], DiskBox[{9.94, 0.}, 0.3], 
     DiskBox[{10.649999999999999`, 1.2297560733739028`}, 0.3]}}]}]], "Echo",
 CellChangeTimes->{3.878476457819128*^9},
 CellID->261121597,ExpressionUUID->"6d7815d4-0b53-4081-9e35-88576959439f"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"9.740272798046425`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.878476458079142*^9},
 CellLabel->"Out[39]=",
 CellID->35452243,ExpressionUUID->"cfd2a37d-93b0-4b7b-b89d-d3ca46eb9b54"]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"plotbands", "[", 
    RowBox[{"bdup_", ",", "bddo_", ",", "\[Mu]_"}], "]"}], ":=", 
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Most", "@", 
           RowBox[{"First", "@", "bdup"}]}], "-", "\[Mu]"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "Red"}], ",", 
         RowBox[{"GridLines", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"None", ",", 
            RowBox[{"{", "0", "}"}]}], "}"}]}]}], "]"}], ",", 
       RowBox[{"ListLinePlot", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Most", "@", 
           RowBox[{"First", "@", "bddo"}]}], "-", "\[Mu]"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", "Blue"}]}], "]"}]}], "}"}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"3", " ", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"-", "1.0"}], ",", "1.0"}], "}"}]}]}]}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{
  3.8784763292697744`*^9, {3.878476693492607*^9, 3.8784767060453253`*^9}, {
   3.878476753243025*^9, 3.878476824751115*^9}},
 CellLabel->"In[52]:=",
 CellID->115514514,ExpressionUUID->"266d935e-fd17-4993-9ba5-8c9f739e0735"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"plotbands", "[", 
  RowBox[{"bdup", ",", "bddo", ",", "\[Mu]"}], "]"}]], "Input",
 CellChangeTimes->{{3.878476677758707*^9, 3.878476681922946*^9}},
 CellLabel->"In[53]:=",
 CellID->136568887,ExpressionUUID->"ac2b5b33-f844-4d1d-b969-4231c6152323"],

Cell[BoxData[
 GraphicsBox[{{{}, {{}, {}, 
     {RGBColor[1, 0, 0], PointSize[
       NCache[
        Rational[1, 120], 0.008333333333333333]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAmIQDQEf7IV/5TdZtcgfgAo4dC56uj6jEsbncIhOl53y
LwLGF3Awb4qzklOG8UUcjs955MJwQw7Kl3DIZzpx5HM5jC/jcP/FKuY4Zhhf
wWHi+z0Ou6pkoXwlh+elf5Jn3pOB8lUceFUsVy/Uh/HVHBb/ZAzry5OG8jUc
BCfOD9efIwXlazn0M+tKZu6UhPJ1HKS97KJMjktA+XoOS3OUXecdE4fyDRxO
bla5dmKHGJRv6NB9sezo63miUL6Rgz5vlF1YlQiUb+wQyFZ9q9BHGMo3cbg9
LXDpcTEhKN/UwdhpWhHHbQEo38yhaNGliaZm/FC+uYNfhc3tlE08UL6FQ9LM
FIVP+lxQvqXDMxPZ42u2skP5Vg67Ni/byRvCCuVbO7xCkbdxyELRb+sQhGK+
nUMciv32DrYo7nNwOI3s/gYHB08U/zk6qCP7v8HRoRYlfJwcLiOHX4OTw1SU
8HV2EEcO/wZntPhxQY2/BheHuSjx6+rAjRz/Da4OT1HSh5vDfOT00+CGlr7c
UdNfgzta+vRATb8NHg7lKOnbE57+AeBW1/M=
       "]]}, 
     {RGBColor[1, 0, 0], PointSize[
       NCache[
        Rational[1, 120], 0.008333333333333333]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAmIQDQEf7D3XVPzw9ZU9ABVwqI99e32/E4zP4dD4/OlN
RWUYX8Ah/l+21sx3MlC+iMPEtXWHkpfC+BIO6Q51RTfcYXwZh+0Tpb+nXZOG
8hUcnG0eyc8IhPGVHG7uXSPIt0sKyldxmMm0ZnOLAIyv5uC4YW/0pVBJKF/D
4bdB2fUXXRJQvpZDdcDd39c2iEP5Og6VRnU/Tp0Qg/L1HHzV4o+JXhGF8g0c
GHNfmxpcEYHyDR3OHvgRf+iUMJRv5CBqVb5o3U4hKN/YIfTYtNeKiwWhfBOH
k71F/1Z3CkD5pg5+fGZ+xx/wQflmDn0NNhcttvFA+eYOfge/VGbM5YLyLRzS
rOZf/LWIA8q3dJhkfnt70XU2KN/Kocj43Q7eEFYo39phEYq8jYMfin5bByMU
8+0cmlDst3fwQnGfg8NpZPc3ODgEovjP0UEc2f8Njmjh44Qafg1OaOHr7FCP
HP4NQD5K/Ligxl+Di4MrSvy6osZ/g6vDQ5T04ebgj5x+GtzQ0pc7avprcEdL
nx6o6bfBw2E+Svr2hKd/AJzJ7A0=
       "]]}, 
     {RGBColor[1, 0, 0], PointSize[
       NCache[
        Rational[1, 120], 0.008333333333333333]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAmIQDQEf7P9W5r2MPiZ5ACrgEO21JEZjD4zP4TD7cfy+
2XNhfAGHwOMnLB9kwfgiDpqnD4XbqMD4Eg7K0hIZwqckoHwZh9b2nyrPYmB8
BYf8o4aLg++KQ/lKDj/V/q6U8oHxVRwcH1jOlF4lBuWrOVhn6otG/xCF8jUc
LvfdOsZqAeNrOdx9+WthaZYIlK/jcD9fJsRyojCUr+dQqDvhhNw6ISjfwCGX
baao02FBKN/QIVfcebvSZQEo38hhnbBiavNBfijf2GFfWcSd6fd5oXwTh1dx
r41WcPJA+aYOeavnfbf05oLyzRz4LkUturaJA8o3d9j13elTRRA7lG/hsC7y
2mJJezYo39Lh2VY2bfc+VijfyuFVRuDhEm8Y39rhEYq8jcMpFP22DutQzLdz
YEKx396hCcV9Dg6PkN3f4OCwDsV/jg7TkP3f4OiQihI+Tg7pyOHX4OSQixK+
zg53kcO/wdnhIUr8uKDGX4OLgzNK/Lo6OCPHf4Orw0eU9OHmkI6cfhrc0NKX
O2r6a3BHS58eqOm3wcNhNUr69oSnfwA4V9wb
       "]]}, 
     {RGBColor[1, 0, 0], PointSize[
       NCache[
        Rational[1, 120], 0.008333333333333333]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAmIQDQEf7A1dGONu+4kegAo4LO08FfPOBcbncBA898rW
XB3GF3DQTY29+/SrCJQv4qDezjvHayOML+HQzGETcz0Sxpdx6JT+w6b4QRjK
V3CYOjfpyMMSGF/JYWnrcZU/L4SgfBWHSJ7v0+p9YXw1B8c22U3rFgtC+RoO
gkZLJDneCkD5Wg6cEjXywdowvo5DWeDElckH+aB8PYdHIoksZfK8UL6Bwz32
aiX7cm4o39BhU9JWlwMXOKF8I4ewgDQtAzMOKN/YYVuL16MDW9igfBMHvwy+
1rpYVijf1EHon+DEu64sUL6Zgx3LEa8nbcxQvrnDqVPiLcaWML6FQ9WLExyx
uTC+pYPRxaWnKlVg+q0crNgZD5d4w8y3dlBCkbdx6ELRb+twDMV8O4cgFPvt
HaRQ3OeA6v4GB4ddKP5zdIhD9n+Do8M2lPBxcjiHHH4NTg7PUMLX2SEOOfwb
nB1YUeLHBTX+Glwc3FHi19UhGDn+G1wd5qOkDzfU9NPghpa+3FHTX4M7Wvr0
QE2/DR4Owijp2xOe/gF9Sc3r
       "]]}, 
     {RGBColor[1, 0, 0], PointSize[
       NCache[
        Rational[1, 120], 0.008333333333333333]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAmIQDQEf7LnFE3duaBE4ABVwWF4y32tnFYzP4XD4QeKu
xzEwvoDDwXUOLUnaML6Iw6WFX1pEz/JD+RIO+5T96lfLwvgyDnKdkreOefJB
+QoO3zYHyf0J4oXylRzmrVV3tLfmgfJVHG6ts0v7zMIN5as5NNVOEGbazAnl
azjcatQ68teDA8rXcph2+4N92Gk2KF/H4dqji9Er7VmhfD2HtpyDsk5rmaF8
A4druuqHnsgyQfmGDvseMZRJzmeA8o0c1rzM1Snp+Lcfwjd22FLx5fTWoD9Q
volDzheh6eGvf0H5pg4tlmsYX6+F8c0crsSd/FRz4zeUb+5w5PozgWURMPMs
HA753pApeguzz9LBTu+oiiQzzH1WDn7mFgL+3jD3WzvoocjboOm3ddiDYr6d
wxMU++0delDc5+BQguz+BgeHNSj+c3ToQfZ/g6PDJpTwcXK4hRx+DU5o4evs
cA85/BucHWahxI8Lavw1uKDFr6vDJeT4b3B1WIeSPtwc3iGnnwY3tPTljpr+
GtzR0qcHavpt8HA4ipK+PeHpHwAJdutq
       "]]}, 
     {RGBColor[1, 0, 0], PointSize[
       NCache[
        Rational[1, 120], 0.008333333333333333]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAmIQDQEf7OP0Xmz+dYvjAFTAIYjDPIfrGIzP4cB0lssm
rB3GF3Cwu89QaSIP44s4BGW0RZr1sUP5Eg7vzGI0ta6yQfkyDrtOLb0r95UV
yldwOOTfuzTzPQuUr+QgV1dQse4oM5Sv4vBqCrPb20omKF/NIS39Y8M0PkYo
X8PhyamTxuG8//dD+FoOPU4Lep+d/g3l6zjsWeWZNC/pB5Sv57Ak7tjZKfe+
QPkGDgLsL/7yBH2E8g0dFjQk+z9b9xrKN3KQCC5I09Z+CuUbOyz44HX+KM99
KN/EwUF/dUhI2zUo39ThwenTJ1obLkL5Zg4Nqi3blnafh/LNHRp2dj5iU7gA
5Vs4XJgXP3u1Kky9pcOG1wsmvv8E41s5FPxRP9RndQnKt3a4gCJv43AARb+t
wwMU8+0cDqDYb+9wAcV9Dg4CyO5vAPJR/OfoEIHs/wZHhwKU8HFyYEAOvwYn
hyko4evssAU5/BucHaagxI8Lavw1uDhkocSvq8Mz5PhvcHVQQkkfbg77kNNP
gxta+nJHTX8N7mjp0wM1/TZ4OIihpG9PePoHAPWA9RM=
       "]]}, 
     {RGBColor[1, 0, 0], PointSize[
       NCache[
        Rational[1, 120], 0.008333333333333333]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAmIQDQEf7Mvvz8wpWcPhABVw+G7Oe8R4OozP4fBt2/b7
3eEwvoCDQt0hvdNv2aF8EYcrom0CpVEwvoSD5YW9b53msUH5Mg7/q15zqO1i
hfIVHO7cuxDrtZ4Fyldy0DrmIi9dzwzlqzhk9Ors9dRmgvLVHGxOXP96YysD
lK/h8MZ8FUus0z97CF/LoeNhxfz4B7+gfB2HBv8NsY99vkP5eg4fErdvFpr4
Gco3cMg4rZOSUvQeyjd02HCgI1Jm7XMo38jhAtMrzamsD6B8YweBx4Z1eyZf
hPJNHBhKGO8/j9sM5Zs6HHhypGFr3pb9EL6ZQ8PKRIcJfsehfHOHhHnuoulN
56B8CwcFVw3uPfwXoXxLhwv+wfcmfoLxrRwu+Eks77O6BOVbOzAEIMvbOBig
6Ld1WIBivp3DAxT77R0cHiO7z8HBAdn9DQ4OBSj+c3Q4gez/BkeHByjh4+Sg
gBx+DU4ODEnI4evskIIc/g3ODiUo8eOCGn8NLg52KPHr6hCBHP8Nrg46KOnD
zeEJcvppcENLX+6o6a/BHS19eqCm3wYPh6co6dsTnv4BQ8Leow==
       "]]}, 
     {RGBColor[1, 0, 0], PointSize[
       NCache[
        Rational[1, 120], 0.008333333333333333]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAmIQDQEf7G/ptktdURFwgAo4fOH6IX1SCsbncNBqPbuq
8Cc/lC/g0LFXIGf1VBhfxIE/4vChl1wwvoSDqjjba/koPihfxmHC+lM7+lt4
oXwFh0WZu5UudfNA+UoORvcY2J8UckP5Kg7blM+5W1pyQflqDjKSZ9bdfMIB
5Ws48K+569BbwQ7lazlUzpdrUPzJCuXrODgYp2+6nsMC5es5KGyt9xC/wwTl
GzhsOmt9rz+IEco3dAgwsDXiPPTfHsI3crDQLH+1zv4vlG/sIPDif83xpN9Q
vonDEqu5Gm/rf0H5pg4KzCZnbt2H8c0cKuZeXv5k0h8o39zBwb9abHIazHwL
Bw/hV9Oc22D2Wzr8aNUs3jafGcq3ctgfLn545wOYf6wdvqHI2ziEoei3dXBB
Md/OIQfFfnsHHRT3OTj0ILu/wcGBB8V/jg4OyP5vcHRIQQkfJ4dVyOHX4OQg
gRK+zg52yOHf4OxQihI/Lqjx1+DiIIQSv64OG5Djv8HVQQslfbg5LEZOPw1u
aOnLHTX9NbijpU8P1PTb4OGgjpK+PeHpHwA/SMt6
       "]]}, 
     {RGBColor[1, 0, 0], PointSize[
       NCache[
        Rational[1, 120], 0.008333333333333333]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAmIQDQEf7D+I75ZU+yHiABVwiNofftrtHYzP4aBhXB++
8wKML+AwoexU9Pr5ML6IA8/8zR410TC+hIN52u0p01hgfBmHsj2fps2cLQzl
KzhM651k4aEI4ys5CLDpnJ0wTQjKV3GQXaxYPemPIJSv5hBVc+/akhAYX8Ph
ic2raUkLBKB8LYebLqsiCg/zQ/k6DpNXzFf9bsoH5es5qHZ0L+WaxwPlGzgw
hi+fso+JG8o3dJjzoLHjaw4nlG/kYCma/Onjc3Yo39hh8/97E740skH5Jg6b
pF/tX+3DCuWbOuSFtIs+iGGB8s0cnoUZb8s9wQzlmzssu1lfcXchjG/h8O7Y
NJfdn2B8S4dfAoyvFXbA9Fs5/DbecXjnA5j51g5MgsjyNg7fUPTbOqxAMd8O
zX57hywU9zk4rEF2f4ODwzoU/zmi+r/B0WEdSvg4ObAjh1+Dk4McSvg6O0xA
Dv8GZ4cHKPHjghp/DS4OYSjx6+oggxz/Da5o6cPNYRZy+mlwQ0tf7qjpr8Ed
LX16oKbfBg8HVZT07QlP/wBzic0h
       "]]}, 
     {RGBColor[1, 0, 0], PointSize[
       NCache[
        Rational[1, 120], 0.008333333333333333]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAmIQDQEf7Nm517dZTpN0gAo45LLYBsv0wPgcDm9aEw0u
58L4Ag7nv56d3WkN44s4aLtOSez4KgHlSzjoH1ssYzYHxpdxyEo48UfcAMZX
cOjJKn92aaM4lK/kUNT6nlNXCcZXcXhVPkVaoEkMyldzOP8vJ6PnkiiUr+Fw
5Lup5F0RGF/LQT/aXDzPSwTK13HgOyRr/KREGMrXcxD6si9LY5oQlG/gEBD0
o7x8gyCUb+ggtPaOZvkxASjfyGGd/OUZy7bxQ/nGDqdLH5Yef8oL5Zs4/H3h
PXe7Mg+Ub+qQefPnzr/VXFC+mcOlZ88Lp/7hgPLNHa4kidW+3MoO5Vs4TF3i
IvNtJxuUb+mQl1m9hkMKxrdykNuveO3uc1Yo39ohA0XexmEBin5bh/so5tuh
2W/vkIXiPgeH78jub3BwOIriP0eHbcj+b3B0EEMJHycHH+Twa3By4EMJX2fU
8G9wdjBAiR8X1PhrcHE4hxK/rg4vkeO/wdWhECV9uDn0IaefBje09OWOmv4a
3NHSpwdq+m3wcHiNkr494ekfAKU5yi4=
       "]]}, 
     {RGBColor[1, 0, 0], PointSize[
       NCache[
        Rational[1, 120], 0.008333333333333333]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAmIQDQEf7Ou68j4o+Mg6QAUcIniZji52hPE5HBRUdj+w
UILxBRyWeBYrsL2TgfJFHD6KJqz0WgrjSzhIvGD+E+cB48s4/DtYL7r1ujSU
r+DAIHll2Y1gGF/JoVvwW07+XikoX8XhTYXgTktRGF/NQdIjzU44RhLK13B4
N2ej85dJElC+lkMZu0rS513iUL6Og8cpO16Pq2JQvp7Drl3iFn6PRaF8Awdr
Yf2J3c9EoHxDhwsR9czbHwhD+UYOGb7nKg5fFoLyjR0unehwe39QEMo3cTj4
LdDh1loBKN/UIV+3T8vLlB/KN3PY8PWSoZUEL5Rv7mDXZcr6jpcbyrdwaJno
H6KnxAnlWzo07VOYtymZHcq3cti3IOva3eesUL61Qz2KvI3DRBT9tg6uKObb
OaxHsd/eIQ3FfQ4O+5Dd3+DgcA7Ff44OWcj+b3B0uIISPk4OFsjh1+DksAMl
fJ0d3JHDv8EZLX5cUOOvwcVBHCV+XVHjv8HVoRMlfbg5sCCnnwY3tPTljpr+
GtzR0qcHavpt8HCQQUnfnvD0DwDVRbxm
       "]]}, 
     {RGBColor[1, 0, 0], PointSize[
       NCache[
        Rational[1, 120], 0.008333333333333333]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAmIQDQEf7APyOY7kbJZ3gAo4zPqTt2HhChifw8Gh5N4T
7w4YX8DBUd5leW8QjC/i4CGh9Xc+O4wv4eBoLNR2abkclC/j8Leq16PbGMZX
cGBmZi9xWy0L5Ss5bNHjlZrGD+OrOJh8+PlIMVEGyldzKK4PPLxsgTSUr+HQ
vcJi57dzUlC+lsOFPO85P95IQvk6Dhe6IvhW/JaA8vUccqUuLxT9Iw7lGzio
RcWGpL8Xg/INHTZ2Lum6eU0UyjdyENvseOnAZhEo39ghenHAlZ52YSjfxCHo
krvS2WAhKN/UQabs+wcLKUEo38zhSZCFdPlOfijf3OHMz1XWgta8UL6FA/t8
N5bqfVxQvqXDUsuN+4y8OKB8K4env38pPXnOCuVbOyxCkbdxEELRb+twDsV8
O4cHKPbbO0ihuM8B1f0NDg4RKP5zdJBA9n+Do8MWlPBxclBGDr8GJ4cslPB1
djiHHP4Nzg4XUeLHBTX+GlwcClHi19XBGDn+G1zR0oebAxty+mlwQ0tf7qjp
r8EdLX16oKbfBg8He5T07QlP/wC+78PH
       "]]}}, {{}, {}}}, {{}, {{}, {}, 
     {RGBColor[0, 0, 1], PointSize[
       NCache[
        Rational[1, 120], 0.008333333333333333]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAmIQDQEf7Ke6Xr6/pUD+AFTA4f4lyzMvU2F8DodGr5UM
U1xhfAGH8q98h6/yw/giDqXvvki8OCIH5Us4FHPeXSiVCuPLOKgHRqRc/iAL
5Ss4qN682N+XAeMrOexluWF674wMlK/iYHvsyL9MORhfzSE9VOb+u1hpKF/D
Ib+O+apdjxSUr+Ww2EVsh8MqSShfx6E3QVnrww4JKF/PgfPD3L2xO8WhfAOH
hfoaBevXiEH5hg6c8fnLFKeIQvlGDp4dPO84CkWgfGOH2ArpD1dchKF8EwfZ
5UJ2ooJCUL6pw3KvQzyN1wWgfDMHt99ng9hN+KF8c4e6hQ7FC7fyQPkWDtdc
71hzW3JB+ZYOQffdvh06wg7lWzkYzZwQVZLECuVbO7ihyNs43EPRb+tQhWK+
nYMViv32DotR3OfgII7s/gYHh0gU/zk6BCP7v8HRgRclfJwcZiOHX4MTWvg6
O3Qih3+Ds8NMlPhxQY2/BheHTJT4dXVwRI7/BleHgyjpww01/TS4oaUvd9T0
1+COlj49UNNvg4dDM0r69oSnfwBKR9p/
       "]]}, 
     {RGBColor[0, 0, 1], PointSize[
       NCache[
        Rational[1, 120], 0.008333333333333333]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAmIQDQEf7J0TLXkyOWUPQAUcVJ+cefD6nwyUz+Hw9lfr
n4b7ML6AQ66CnY3fahhfxGHrG62jk5JgfAmHu/vOiS9nhfFlHI7O8DL8O0Ua
yldwOP5+3iEFQRhfycH1xYGO7VVSUL6Kw1r/O1caL0lC+WoO1+UMo6IlYXwN
h4XFNfE2ARJQvpaD7r13tdYV4lC+jgP7Qk7NCZPEoHw9h9SJj4KnLRCF8g0c
7r78uebyYhEo39ChWN9L/v9cYSjfyIFVZeYU7olCUL6xQ+T84CTzekEo38TB
8axMjFK2AJRv6mB1Sznp1no+KN/MwWtRRuapSTxQvrnDMbPTNnUdXFC+hcM2
26fd++ZwQPmWDlFZ26463WOD8q0cwuY+4c1LYoXyrR3SUORtHJah6Ld12Idi
vp2DG4r99g52KO5zcLBEdn+Dg0Mwiv8cHf4qI/m/wdGhECV8nByuI4dfgxNa
+Do7MCKHf4OzgzFK/Ligxl+Di8NDlPh1ddiIHP8Nrg7uKOnDzeEkcvppcENL
X+6o6a/BHS19eqCm3wYPh/so6dsTnv4BiWnj4A==
       "]]}, 
     {RGBColor[0, 0, 1], PointSize[
       NCache[
        Rational[1, 120], 0.008333333333333333]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAmIQDQEf7KUfVS5qDJY8ABVw6LzNnp/iCeNzOPyN0fGR
1obxBRwenpmx/eIPCShfxMFYJr72wiYYX8LBfG6eRV0kjC/jUGo+WSLhrTiU
r+Aw3dGJSTofxldySI3ZpVp6XwzKV3F46BdvHmEP46s5HLxq3nKlXxTK13BY
eY7BVPWSCJSv5SBqxGS8jR3G13H4OuOFn46RMJSv53D3VGdbQbAQlG/gwKt5
ePL+XEEo39DhcPNy1/3NAlC+kcO/MxkXzAz5oXxjBybl8rXhCbxQvonDs6kP
r7jP44byTR3E2vo/9n7jhPLNHPwm165ULeeA8s0d3PjXbKk0YIfyLRx2BdwK
bjNhg/ItHYpEBZ/MmMIK5Vs5rOK6zJuXBONbO6ShyNs4bELRb+vghWK+nYMX
iv32Dnoo7nNweIXs/gYHh29KyP5zRPV/g6PDeZTwcXLgRA6/BieHxyjh6+zw
Gzn8G5wdxFHixwU1/hpcHPajxK+rw0vk+G9wdUhESR9uDr3I6afBDS19uaOm
vwZ3tPTpgZp+GzwcfqOkb094+gcAqP/VNw==
       "]]}, 
     {RGBColor[0, 0, 1], PointSize[
       NCache[
        Rational[1, 120], 0.008333333333333333]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAmIQDQEf7C+/azXN2ypyACrg4DhN6Xnfahifw0GWy6uY
sQ/GF3BI951a/j0GxhdxeFhal3JEAsaXcBC0Xbbh3kFhKF/GwX3y3k0PI2B8
BYfClNiQCfeEoHwlh4t3vr24EQzjqzjcr3wz7dZOQShfzYE1eOWnN4IwvobD
XOGtm1bFCkD5Wg5Sn+wnMNrxQ/k6DrNCTWPbN/BC+XoOYqaKd2dJ8ED5Bg6r
mG3P+NVyQfmGDmK94gdan3NA+UYOWQd/aDYlsUP5xg6TVpecaPnDCuWbOHgd
r/9ufZwFyjd1uPdfxrfgOjOUb+YgxHTy7V8nGN/cYV+L6IZcGRjfwkGqSKfG
OxfGt3SI2zNNaaMRzDwrh3mygr89o2H2WTtUocjbOCih6Ld1OIZivp0DG4r9
9g63UNzn4OCG7P4GB4dFKP5zdMhD9n+Do4MaSvg4OSxCDr8GJwc5lPB1Rg3/
BmcHJZT4cUGNvwYXh79ByPHr6nATOf4bXB3Oo6QPN4dk5PTT4IaWvtxR01+D
O1r69EBNvw0eDvwo6dsTnv4B6M/diQ==
       "]]}, 
     {RGBColor[0, 0, 1], PointSize[
       NCache[
        Rational[1, 120], 0.008333333333333333]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAmIQDQEf7NXYluRYHOE/ABVwCDrQmq+0AcbncOjTT37E
WALjCzjcS1+22FoAxhdxcGOK/FXZygflSzi4HZyttOEKL5Qv47AuMuGD/H8e
KF/BoUw4MCqJDcZXcljWPs2u5A0XlK/iwHQ2uf7kZk4oX83h08HEZ5nxHFC+
hkNeSHGF7Gc2KF/Lwcx9y/aNxaxQvo6D3q0/L9OfM0P5eg5M0aINy8OYoHwD
h6iii6IKZxmgfEMHl7KMhZrb/+2H8I0cQrIXRZ43+QPlGztcUdV+8zz8F5Rv
4uBScmI6b+lPKN/Uocc63vr3FRjfzMHn+j8x1o7fUL65w5GeZa2bo2HmWzgo
bak/d5mBEWq/pcM2jf2r3KRg7rVySLvy8pdnNMw/1g6nUORtHPRQ9Ns6vEEx
387BBsV+e4cUFPc5OKggu7/BweEIiv8cHUqQ/d/g6GCCEj5ODknI4dfg5MCG
Er7ODnLI4d/g7KCEEj8uqPHX4OLwCiV+XR1enUGK/wZXh3Uo6cPNIQ85/TS4
oaUvd9T01+COlj49UNNvg4dDE0r69oSnfwAhcuWw
       "]]}, 
     {RGBColor[0, 0, 1], PointSize[
       NCache[
        Rational[1, 120], 0.008333333333333333]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAmIQDQEf7PWm6i9hUec4ABVwOPV20e/DgjA+h8OxHF9x
mUvsUL6Ag5ZJRFp0Bowv4vDqtLQH61U2KF/CIastWPWyBIwv4xBn2OiwzYQV
yldwqJqaNvWWJguUr+QgVXsrbPVPJihfxWGfy6EvN5cyQvlqDkwNubqZBgxQ
vobDmRVXi2vN/+6H8LUcjgQv4Wu4+hPK13GoOXz7DLPTNyhfz8HixiMl47ZP
UL6Bw4y9zU5LY95C+YYOBbvum8dOfwrlGzkU8DQJrLl/G8o3dnBgP1Bac+EU
lG/iwGB0ubesvRXKN3VQOMrqHt53yB7CN3NwuM9yvGfpeSjf3MEh4+vZjTmX
oXwLh4KXlX5W1lehfEuHgmPLFAXkrkH5Vg4J9+Z84UmD8a0dGlDkbRwaUPTb
OgSgmG/nwIBiv71DA4r7HBwYdJDc3+DgsIAN2X+ODgnI/m9wdMhACR8nBw/k
8GtwcpBBCV9nhxzk8G9wdliDEj8uqPHX4OLAhRK/rg6bkOO/wdWBDyV9uDm0
IaefBje09OWOmv4a3NHSpwdq+m3wcDiFkr494ekfAHp15TE=
       "]]}, 
     {RGBColor[0, 0, 1], PointSize[
       NCache[
        Rational[1, 120], 0.008333333333333333]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAmIQDQEf7JnLg2qyEjgdoAIOTIELTaq8YXwOh8WipSzH
eGB8AYeD6tmOS5ZwQPkiDqs3fFBcJgzjSzhI1x/7ODOKHcqXcZguJLCsr4oN
yldwCJr+PfdmCSuUr+Tgd/SWg5w3C5Sv4jDvdi5f7H8mKF/NoWxttCfbFEYo
X8PhhJZ/kjQPA5Sv5RBzukTu2LU/9hC+joODodzn2tyfUL6eQ8CjWXElL79C
+QYOPO17+t7EfILyDR0qynkKlx55C+UbOUjYS3a8cngO5Rs7RIT7cSrNeQjl
mzgsuPZn+qWNt6B8U4eAZFkeljVXoXwzhw9LJ8sFfrwM5Zs7NPjfVm31vgLl
WzhMMN54TzMQpt7SQWH7hyu5ctegfCuHBZvcfvOkwfjWDg4o8jYOG1D02zpc
QDHfzoFhGbL99g4LUNzn4GCA7P4GBwcHFP85Ojgg+7/B0WEBSvg4OQggh1+D
k4MPSvg6O7ggh3+Ds0MISvy4oMZfg4tDBUr8ujpMQY7/BleHIJT04ebghZx+
GtzQ0pc7avprcEdLnx6o6bfBw2EJSvr2hKd/AFp8zM8=
       "]]}, 
     {RGBColor[0, 0, 1], PointSize[
       NCache[
        Rational[1, 120], 0.008333333333333333]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAmIQDQEf7O84TJubcVzAASrg0DLvil7hXhifw2Ea1/R5
s+fD+AIOC26UZkjlwfgiDqeq1i9z0oTxJRymlu9wl17MD+XLOHDcbV5kdp4P
yldweMO+91n2DV4oX8nhEuMkzvUHeKB8FQdj5pV6yV3cUL6aA/elX7cLLbig
fA2HHdem9OSe44DytRzuGERzHAtgh/J1HGZZ2KhIHmWF8vUcXh3SfrbRiAXK
N3Awa53YFbKYCco3dLCxzrbrVGGE8o0cZOY57Q2e/N8ewjd2WGB4MmZq7F8o
38QhZdNzdfNvv6F8U4cVvxsmndoB45s5lCjNa455/AfKN3dwmbl7YWsyzDwL
hwVrnJ4+LILZZ+lg0a3/tqODGcq3cmCYtejGvgsw91s7GKHI2zgsQtFvi2a+
nUMNiv32DjtQ3OfgkIDs/gYHhxko/nN0UEH2f4OjgxtK+Dg5WCCHX4OTwxuU
8HV2mIIc/g3ODndR4scFNf4aXBw4UeLX1UEPOf4bXNHSh5vDe+T00+CGlr7c
UdNfgzta+vRATb8NHg5TUNK3Jzz9AwDkRdBK
       "]]}, 
     {RGBColor[0, 0, 1], PointSize[
       NCache[
        Rational[1, 120], 0.008333333333333333]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAmIQDQEf7N/nmDlNnijqABVwyNj032FZO4zP4XD8m7zS
+0wYX8DhXe+kg3MtYHwRh1frnRqYvohA+RIOHoaFDv1zYHwZBwcXw9c3jGB8
BYeIY9NXzNwuDOUrOWSt+8OxRRvGV3HQMNWpNp8gBOWrOYisD5qW9kwQytdw
eBV18+9+fRhfy+G1w0Zm7jwBKF/HIW3x78LLbvxQvp7Du7TTZ54u4YXyDRxY
o56+WveHG8o3dFDeKs9rEMYF5Rs5fFt04dP83RxQvrHD7OtbVhlYsUP5Jg6z
dlf4vnvECuWbOuwJrIn0Pc0C5Zs5+EToCYfwwPjmDj/kmnwW72OG8i0cNtkY
XzzzCca3dNBTFZj8ciVMvZWD3v3O7icXYOZbOxihyNs4bEPRb+vwDcV8O4cQ
FPvtHfahuM/BYSKy+xscHOah+M/R4QOy/xscHTRQwsfJgQk5/BqcHL6ihK+z
Qypy+Dc4O7xCiR8X1PhrcHEQRYlfVwcV5PhvcHXIQUkfbg6RyOmnwQ0tfbmj
pr8Gd7T06YGafhs8HI6hpG9PePoHACsyyvo=
       "]]}, 
     {RGBColor[0, 0, 1], PointSize[
       NCache[
        Rational[1, 120], 0.008333333333333333]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAmIQDQEf7LsXLT4rzCnlABVw+Fl00+HBP0kon8PBnGfq
ouAHML6Aw5v3f2VnrIXxRRwOff5u/SUNxpdw2O/s63OaB8aXcVDeoMc5b74E
lK/gwPMurZ1bAcZXcpjtb9R3qU8cyldx+MiRX3v5jRiUr+bwYmLKTyFrGF/D
oW47/+q9VaJQvpbDBCGDNt21IlC+jsOMGYEWHy8LQ/l6DlphR9dc+yAE5Rs4
aOqf+/mTFcY3dDBzqJh9S1QQyjdyWLPp6LRKZQEo39hh9olDS9hT+aB8E4c/
G0J/i/fzQPmmDhv/chxYeYELyjdzmKByNMvNghPKN3eo8lq768V1dijfwmHj
GoecziNsUL6lgzpn4edtwjC+lYO6x9zuJxdYoXxrBx0UeRuHrSj6bR0qUMy3
c5iNYr+9w1YU9zk4/EV2f4ODwwwU/zk6rEb2f4OjgzlK+Dg5qCGHX4OTgw5K
+Dqjhn+DM1r8uKDGX4MLWvy6OrxHjv8GV4cZKOnDzYEPOf00uKGlL3fU9Nfg
jpY+PVDTb4MHWvr2hKd/AIzmzMU=
       "]]}, 
     {RGBColor[0, 0, 1], PointSize[
       NCache[
        Rational[1, 120], 0.008333333333333333]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAmIQDQEf7OWurr3DOkHWASrgkN6mtKe8FcbncKgUkN53
MxXGF3DwVl/IF2gI44s4FF7bvEz6hQyUL+Hgkbk5bEIXjC/jMGNXwG05SRhf
wcE0VZwlYIo0lK/kcObZw69H/0hB+SoOJdoPp9sEw/hqDio3P9l3zZCE8jUc
rkeu3r3grASUr+WQXCn0oO+zOJSv4xAXvflOEzeMr+dg4T9l1VkxMSjfwOH9
VAWpF2KiUL6hw/aXui5VvCJQvpEDW/KatrQ/QlC+sUPA+9Pnbz4VhPJNHM5s
W/4o+YwAlG/qMCVhgZh5Gj+Ub+Zw69KymSuseaF8c4eDwvFON5S4oXwLB81e
zllZGpxQvqXD7i7Xhkcx7FC+lUOT0bzG2pusUL61wyYUeRsHPRT9tg77UMy3
c7iJYr+9QzeK+xwcTiC7v8HBwR/Ff44OrMj+b3B02IkSPk4Ob5HDr8HJwRQl
fJ0dopHDv8HZIRElflxQ46/BxUERJX5dHcqQ47/B1eEUSvpwczBGTj8Nbmjp
yx01/TW4o6VPD9T02+DhUIaSvj3h6R8AAZXGEw==
       "]]}, 
     {RGBColor[0, 0, 1], PointSize[
       NCache[
        Rational[1, 120], 0.008333333333333333]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAmIQDQEf7A8pL037dEzeASrgYHBGaorCHhifw+HnhKCK
bbNhfAGHc6sny11LhfFFHCqPiWvukILxJRwEdP6uWL1LDsqXcegQevBc1A3G
V3CIkPykUrRXFspXcpgz39AjUBHGV3E45ZvXH1kkA+WrOWQpm1u5bZSG8jUc
Pu26Yv38nhSUr+UwWTfpr8IfSShfx0G/pNjuDSeMr+dwaFqEZhinBJRv4CBx
L3JXw28xKN/Q4fnv1SsXPxSF8o0ctpn3K/HtFYHyjR3EDDfs0+wXhvJNHE4c
bOusjxSC8k0dGnJPhx2QFYTyzRwqf9pELd3ND+WbO6hfWLb4ijkvlG/hIPDp
3IvErVxQvqXDwr72fhlrDijfyuG09+nG2pusUL61wxwUeRs0/bYOKijm2zkU
odhv71CP4j4HVPc3ODiIoPjP0WE3sv8bHB2eoISPk4MIcvg1OKGFr7ODLnL4
Nzg7TEKJHxfU+GtwcchEiV9Xh7PI8d/g6jATJX24oaafBje09OWOmv4a3NHS
pwdq+m3wcPiOkr494ekfADaSxu4=
       "]]}}, {{}, {}}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0., 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, {0}},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{-3., 3.},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{{3.87847668287*^9, 3.878476698837914*^9}, {
  3.878476740597302*^9, 3.878476759001354*^9}, {3.8784767944653826`*^9, 
  3.8784768419741*^9}},
 CellLabel->"Out[53]=",
 CellID->178049117,ExpressionUUID->"bd1c46ed-4cbb-44a8-9c24-27bc648be126"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"bandsup", ",", "bandsdo"}], "}"}], "=", 
   RowBox[{"First", "/@", 
    RowBox[{"{", 
     RowBox[{"bdup", ",", "bddo"}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bandsup", "=", 
   RowBox[{"Most", "@", "bandsup"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bandsdo", "=", 
   RowBox[{"Most", "@", "bandsdo"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bands", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"bandsup", ",", "bandsdo"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"FreeEnergy", "[", 
  RowBox[{"Temp", ",", "bands", ",", "\[Mu]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.878476510809159*^9, 3.878476515589432*^9}, {
  3.878476549529373*^9, 3.878476581463199*^9}, {3.878476617851281*^9, 
  3.878476650024121*^9}},
 CellLabel->"In[54]:=",
 CellID->202423183,ExpressionUUID->"0138768f-a219-499c-ad77-99430c1ebc31"],

Cell[BoxData[
 RowBox[{"-", "129.17696063974745`"}]], "Output",
 CellChangeTimes->{3.87847685543187*^9},
 CellLabel->"Out[58]=",
 CellID->199442416,ExpressionUUID->"86364a3f-2b48-420b-bf37-2162077e8c02"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", " ", 
   RowBox[{"AFM", " ", "configuration"}], " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"spinconfig", "=", 
     RowBox[{"{", "\[IndentingNewLine]", "\t", 
      RowBox[{
       RowBox[{"{", 
        RowBox[{
        "0", ",", "1", ",", "1", ",", "0", ",", "0", ",", "1", ",", "1", ",", 
         "0", ",", "0", ",", "1", ",", "1", ",", "0"}], "}"}], ",", 
       RowBox[{"{", 
        RowBox[{
        "1", ",", "0", ",", "0", ",", "1", ",", "1", ",", "0", ",", "0", ",", 
         "1", ",", "1", ",", "0", ",", "0", ",", "1"}], "}"}]}], 
      "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"AbsoluteTiming", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{"bdup", ",", "bddo", ",", "\[Mu]", ",", "occnumbers"}], "}"}], 
      "=", 
      RowBox[{"HubbardMeanField", "[", 
       RowBox[{"ruc", ",", "T", ",", "klist", ",", "U", ",", "t1", ",", 
        RowBox[{"\"\<Temperature\>\"", "\[Rule]", "Temp"}], ",", 
        RowBox[{"\"\<SpinDensityScaleFactor\>\"", "\[Rule]", "2"}], ",", 
        RowBox[{"\"\<CMonitor\>\"", "\[Rule]", "True"}], ",", 
        RowBox[{"\"\<SpinConfiguration\>\"", "\[Rule]", "spinconfig"}]}], 
       "]"}]}], ";"}], "]"}]}]}]], "Input",
 CellChangeTimes->{3.8784769120741086`*^9},
 CellLabel->"In[59]:=",
 CellID->780751736,ExpressionUUID->"6cbbba6b-bcb0-437b-b0bf-f8e5734f568d"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  TagBox["\<\"HubbardMeanField initial spin density:\"\>",
   "EchoLabel"], " ", 
  GraphicsBox[{{
     {RGBColor[1, 0, 0], Opacity[0.5], DiskBox[{0., 0.}, 1.]}, 
     {RGBColor[0, 0, 1], Opacity[0.5], 
      DiskBox[{-0.71, 1.2297560733739028`}, 1.]}, 
     {RGBColor[0, 0, 1], Opacity[0.5], DiskBox[{1.42, 0.}, 1.]}, 
     {RGBColor[1, 0, 0], Opacity[0.5], 
      DiskBox[{2.13, 1.2297560733739028`}, 1.]}, 
     {RGBColor[1, 0, 0], Opacity[0.5], DiskBox[{4.26, 0.}, 1.]}, 
     {RGBColor[0, 0, 1], Opacity[0.5], 
      DiskBox[{3.55, 1.2297560733739028`}, 1.]}, 
     {RGBColor[0, 0, 1], Opacity[0.5], DiskBox[{5.68, 0.}, 1.]}, 
     {RGBColor[1, 0, 0], Opacity[0.5], 
      DiskBox[{6.39, 1.2297560733739028`}, 1.]}, 
     {RGBColor[1, 0, 0], Opacity[0.5], DiskBox[{8.52, 0.}, 1.]}, 
     {RGBColor[0, 0, 1], Opacity[0.5], 
      DiskBox[{7.81, 1.2297560733739028`}, 1.]}, 
     {RGBColor[0, 0, 1], Opacity[0.5], DiskBox[{9.94, 0.}, 1.]}, 
     {RGBColor[1, 0, 0], Opacity[0.5], 
      DiskBox[{10.649999999999999`, 1.2297560733739028`}, 1.]}}, 
    {GrayLevel[0.5], Opacity[0.1], DiskBox[{0., 0.}, 0.3], 
     DiskBox[{-0.71, 1.2297560733739028`}, 0.3], DiskBox[{1.42, 0.}, 0.3], 
     DiskBox[{2.13, 1.2297560733739028`}, 0.3], DiskBox[{4.26, 0.}, 0.3], 
     DiskBox[{3.55, 1.2297560733739028`}, 0.3], DiskBox[{5.68, 0.}, 0.3], 
     DiskBox[{6.39, 1.2297560733739028`}, 0.3], DiskBox[{8.52, 0.}, 0.3], 
     DiskBox[{7.81, 1.2297560733739028`}, 0.3], DiskBox[{9.94, 0.}, 0.3], 
     DiskBox[{10.649999999999999`, 1.2297560733739028`}, 0.3]}}]}]], "Echo",
 CellChangeTimes->{3.878476913738205*^9},
 CellID->16937823,ExpressionUUID->"3defe828-d377-4714-9365-5f37b2b57616"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"HubbardMeanField SCE convergence:\"\>",
   "EchoLabel"], " ", 
  GraphicsBox[{{}, 
    {RGBColor[0.368417, 0.506779, 0.709798], PointSize[0.012833333333333334`],
      AbsoluteThickness[1.6], 
     PointBox[{{1., 1.525378450504493}, {2., 0.4739312064044177}, {3., 
      0.17648489577915846`}, {4., 0.07022768724878115}, {5., 
      0.028830437573479153`}, {6., 0.012013359232340055`}, {7., 
      0.0050407393495528995`}, {8., 0.0021217752206519605`}, {9., 
      0.0008943813007450149}, {10., 0.0003772436092894455}, {11., 
      0.00015916364804290063`}, {12., 0.00006716154047759676}, {13., 
      0.000028341442668450532`}, {14., 0.000011960086773956965`}, {15., 
      5.047214342875427*^-6}, {16., 2.1299601852498263`*^-6}, {17., 
      8.988605113490063*^-7}}]}, {{}, {}}},
   AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
   Axes->{True, True},
   AxesLabel->{None, None},
   AxesOrigin->{0., 0},
   DisplayFunction->Identity,
   Frame->{{False, False}, {False, False}},
   FrameLabel->{{None, None}, {None, None}},
   FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
   GridLines->{None, None},
   GridLinesStyle->Directive[
     GrayLevel[0.5, 0.4]],
   ImagePadding->{{20, 20}, {20, 20}},
   ImageSize->{225., 150.},
   Method->{
    "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
     "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
         Identity[
          Part[#, 1]], 
         Identity[
          Part[#, 2]]}& ), "CopiedValueFunction" -> ({
         Identity[
          Part[#, 1]], 
         Identity[
          Part[#, 2]]}& )}},
   PlotLabel->FormBox[
    "\"occ. numbers \[CapitalDelta]-convergence\"", TraditionalForm],
   PlotRange->{{0., 17.}, {-0.01, 1}},
   PlotRangeClipping->True,
   PlotRangePadding->{{
      Scaled[0.02], 
      Scaled[0.02]}, {0, 0}},
   Ticks->{Automatic, Automatic}]}]], "Echo",
 CellChangeTimes->{3.878476918636485*^9},
 CellID->594250686,ExpressionUUID->"19462126-a065-42ad-b22a-c9a687ae4123"],

Cell[BoxData[
 RowBox[{
  TagBox["\<\"HubbardMeanField final spin density:\"\>",
   "EchoLabel"], " ", 
  GraphicsBox[{{
     {RGBColor[1, 0, 0], Opacity[0.5], 
      DiskBox[{0., 0.}, 0.039927596486628525]}, 
     {RGBColor[0, 0, 1], Opacity[0.5], 
      DiskBox[{-0.71, 1.2297560733739028`}, 0.2582162340517055]}, 
     {RGBColor[0, 0, 1], Opacity[0.5], 
      DiskBox[{1.42, 0.}, 0.050550299010317934]}, 
     {RGBColor[1, 0, 0], Opacity[0.5], 
      DiskBox[{2.13, 1.2297560733739028`}, 0.020152887881496884]}, 
     {RGBColor[1, 0, 0], Opacity[0.5], 
      DiskBox[{4.26, 0.}, 0.015830441067375522]}, 
     {RGBColor[0, 0, 1], Opacity[0.5], 
      DiskBox[{3.55, 1.2297560733739028`}, 0.02178728170388816]}, 
     {RGBColor[0, 0, 1], Opacity[0.5], 
      DiskBox[{5.68, 0.}, 0.01583044106553455]}, 
     {RGBColor[1, 0, 0], Opacity[0.5], 
      DiskBox[{6.39, 1.2297560733739028`}, 0.021787281701462047]}, 
     {RGBColor[1, 0, 0], Opacity[0.5], 
      DiskBox[{8.52, 0.}, 0.05055029900532987]}, 
     {RGBColor[0, 0, 1], Opacity[0.5], 
      DiskBox[{7.81, 1.2297560733739028`}, 0.02015288787638958]}, 
     {RGBColor[0, 0, 1], Opacity[0.5], 
      DiskBox[{9.94, 0.}, 0.0399275964815789]}, 
     {RGBColor[1, 0, 0], Opacity[0.5], 
      DiskBox[{10.649999999999999`, 1.2297560733739028`}, 
       0.25821623404712196]}}, 
    {GrayLevel[0.5], Opacity[0.1], DiskBox[{0., 0.}, 0.3], 
     DiskBox[{-0.71, 1.2297560733739028`}, 0.3], DiskBox[{1.42, 0.}, 0.3], 
     DiskBox[{2.13, 1.2297560733739028`}, 0.3], DiskBox[{4.26, 0.}, 0.3], 
     DiskBox[{3.55, 1.2297560733739028`}, 0.3], DiskBox[{5.68, 0.}, 0.3], 
     DiskBox[{6.39, 1.2297560733739028`}, 0.3], DiskBox[{8.52, 0.}, 0.3], 
     DiskBox[{7.81, 1.2297560733739028`}, 0.3], DiskBox[{9.94, 0.}, 0.3], 
     DiskBox[{10.649999999999999`, 1.2297560733739028`}, 0.3]}}]}]], "Echo",
 CellChangeTimes->{3.8784769186854877`*^9},
 CellID->11367142,ExpressionUUID->"3ca41c94-1bcc-490f-851a-12772ce81571"]
}, Open  ]],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"5.277313636405105`", ",", "Null"}], "}"}]], "Output",
 CellChangeTimes->{3.878476918989505*^9},
 CellLabel->"Out[60]=",
 CellID->104815728,ExpressionUUID->"578ee3b0-dc8b-44b0-8278-d3f8c0a83081"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"plotbands", "[", 
  RowBox[{"bdup", ",", "bddo", ",", "\[Mu]"}], "]"}]], "Input",
 CellChangeTimes->{3.878476927730005*^9},
 CellLabel->"In[61]:=",
 CellID->806929819,ExpressionUUID->"bd336d60-d006-42fd-9d81-19817e3c9307"],

Cell[BoxData[
 GraphicsBox[{{{}, {{}, {}, 
     {RGBColor[1, 0, 0], PointSize[
       NCache[
        Rational[1, 120], 0.008333333333333333]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAmIQDQEf7J+ZzzCQXyx3ACrgcOrKz/aAGTA+h8MKR8XP
78thfAEHnVChmfJOML6IQxQnk7fEd1koX8Lhza7CWM3pML6MA9/l8uIdSjC+
goMbs6yd4ywZKF/Joepvi1HoP2koX8Xh2tpVVrP9YXw1h5Qfr1PP90lB+RoO
fLtWLTi0RxLK13JwqzavjbolAeXrONya2C0z8YU4lK/n8OLvde/SF2JQvoFD
zK83X7Vui0L5hg7z/EzF3xwUgfKNHFisPGq45glD+cYOCd927/lUIATlmzhs
OOesZWgjCOWbOpR02z+rZBSA8s0cKmKygnNaeaF8cwcDuX07TFi4oXwLB4N0
I/PpLRxQvqWDw762gy68bFC+lcOcgG2zKrYxQ/nWDi4o8jYOGij6bR1UUMy3
c6hBsd8ezX0ODiuQ3d/g4JCB4j9HBw5k/zc4OixBCR8nhyjk8GtwcniDEr7O
qOHf4OwQgBI/Lqjx1+DikIASv64OV5Djv8HVoQYlfbg5BCCnnwY3tPTljpr+
GtzR0qcHavpt8HBYgJK+PeHpHwAhrNom
       "]]}, 
     {RGBColor[1, 0, 0], PointSize[
       NCache[
        Rational[1, 120], 0.008333333333333333]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAmIQDQEf7EUsk/TtQmQOQAUcfH5UBu3whPE5HA7xN1ob
a8H4Ag45l3ZlX/kqDeWLOCjNvJFzaw2ML+HwrrH2/hx/GF/G4Yyk0rSee1JQ
voLDrq6Vh42jYHwlhyMvHD3MDktC+SoOFmITtYOkYHw1h4ZVbpEJCRJQvoaD
WeixvaHTxKF8LYdzT/+9cdkrBuXrOER8mtSfcE0Uytdz+MCo+fbfIxEo38CB
JapTaP4TYSjf0GGHw2vfD3eEoHwjh1n8WaJ3zwpC+cYOX1LyP8zaKQDlmzgc
ydtR1uzKD+WbOoT88ze4LcEL5Zs5zOESO33/CxeUb+4gc/PORPXHHFC+hcOO
DU/+vnvPBuVbOux4L995V4sVyrdyuJIglfV+BTOUb+1wAkXexmEJin5bBwkU
8+0cFqDYb+/QguI+B4cNyO5vcHD4geI/R4c5yP5vcHTYgxI+Tg5MyOHX4IQW
vs4OCcjh3+DscAYlflxQ46/BxaENJX5dHfSQ47/B1WEHSvpwc9iHnH4a3NDS
lztq+mtwR0ufHqjpt8EDLX17wtM/AOZX6wY=
       "]]}, 
     {RGBColor[1, 0, 0], PointSize[
       NCache[
        Rational[1, 120], 0.008333333333333333]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAmIQDQEf7Ock67t82ypxACrgwLPq+oOzq2F8DodbSXe+
JPXC+AIOz5wD/R9EwfgiDgqaKRN7RWB8CYek6ZMXnd8lDuXLOFxTbknR9IPx
FRwS9uzcaXNeDMpXcghTjf192g7GV3EQaXFj2zNXFMpXc3gQ7i0h/lYEytdw
0LtZcU5AD8bXcghx6d7GnSQM5es4ZDFcEF3YJQTl6zl0/Pl/avVKQSjfwOGe
19me8IMCUL6hwwQFvqqcFfxQvpFDyDZxod2neKF8YweWq5bb5D5yQ/kmDgIW
Cc/vqnBB+aYOPLEFrxsLOaB8MwePuik5IU/ZoHxzhwdbea5OmsgK5Vs4SFTb
1B7sZIHyLR1EGLNW+j9khvKtHEqetHZ3L4PxrR10UORtHERQ9Ns6PEEx3w7N
fnsHART3OThoILu/wcHhzhVk/zk6JCD7v8HRoQUlfJxQw6/ByaEHJXydHYqQ
w7/B2SECJX5cUOOvwcXhBUr8ujpwIMd/g6tDAEr6cHPIQE4/DW5o6csdNf01
uKOlTw/U9Nvg4XANJX17wtM/AKLP2wA=
       "]]}, 
     {RGBColor[1, 0, 0], PointSize[
       NCache[
        Rational[1, 120], 0.008333333333333333]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAmIQDQEf7P0imB8baYscgAo4aOj/jfdVhPE5HPo2LWBZ
ywzjCzg03S3tabokDOWLOMTc1Lor3wfjSzh8+XFP5qcZjC/j0FQVHL/srBCU
r+CwY0+n+LMgGF/JQS/5/cQFxwWhfBUHgS3St9/owPhqDg7swkvFWwSgfA2H
HMUt/yPn8kP5Wg42bL5mPLJ8UL6Ow4690Yt2dvNA+XoOf56VvD73jgvKN3CY
8P1nG4MvJ5Rv6DDh1KrrO9axQ/lGDjHW+2TXyLFB+cYOO3qfr+1dxQLlmzhw
eHxv2JvMDOWbOuTMmPw7N54JyjdziBB04TPdygjlmzv0nEqpP1YF41s4PJm4
dqbOXhjf0sGF5119fDVMv5WDxsrbs7OWwMy3RpO3cXiDot/WoQTFfDuHEhT7
7R0aUNzn4PDDHcn9DQ4OJ1D85+jgg+z/BkeHBSjh4+TQghx+DU4OX1DC19lh
A3L4Nzg7WKDEjwtq/DW4ONihxK+rAx9y/De4oqUPN4djyOmnwQ0tfbmjpr8G
d7T06YGafhs8HGagpG9PePoHAIxm4A4=
       "]]}, 
     {RGBColor[1, 0, 0], PointSize[
       NCache[
        Rational[1, 120], 0.008333333333333333]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAmIQDQEf7FN6F2ke2sZ3ACrgsCKgVPnwIhifw2GFIfec
52kwvoDDE9uQs1OYYXwRB46VP2tKK3mhfAmHByeto2pP8kD5Mg5zkqf4vvvC
DeUrOPww3VSc8JcLyldy8GCwf3X2CSeUr+IwxcXTfslaDihfzeEE2470e1Hs
UL6Gw4MpfK+0P7BC+VoOP6SOvNMpYoHydRw0vKfxXHjGBOXrOfy4syf8eSgj
lG/gILE6SMBgyv/9EL6hg4K5yZJNS/5A+UYOPy7Ha+dw/ILyjR02tHj/4f/7
Hco3cbBInOHkdeUblG/qICFwUDfwEYxv5uAR/cv/h/8PKN/coeK9XczlnzDz
LBwEDqXJPer9B+VbOtxYs+1RdhzMfVYOCdfKfkrOZIbyrR2eoMjbOEig6LdF
M9/OIQHFfnsHDRT3OTgkILu/wcHhBIr/HB1eIPu/wdEhAiV8nBwYkMOvwcnh
C0r4Ojt4IId/g7PDF5T4cUGNvwYXtPh1RY3/BlcHG5T04eYgYIaUfhrc0NKX
O2r6a3BHS58eqOm3wQMtfXvC0z8AMgbxnw==
       "]]}, 
     {RGBColor[1, 0, 0], PointSize[
       NCache[
        Rational[1, 120], 0.008333333333333333]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAmIQDQEf7DNWdyyZcortAFTAIYdvwdWqrTA+h8OLksUn
PMpgfAGHkrvVzwJ4YXwRB4YzT7pkq1mhfAmHipOR24oOsED5Mg4Lrr25EnCP
GcpXcJihYiHz8yoTlK/kYCF+L/zLCkYoX8Vhyd8vXbKRDFC+msMFl2s9qRf/
7ofwNRxObI7f/GDLLyhfy0Fi8rct1cnfoXwdhx0F3Rrfnn6G8vUc1mhrfBfw
+ADlGzgsuMfgI2D6Eso3dNBolXG49fYhlG/kwFBVHhEodw3KN3ZIyM3ZIn7w
CJRv4tBQK1x+o2AplG/qwFDz7VAISxuUb+bA0P2t7kD6Qijf3IHBQ29jbM4G
KN8CqP+V71TzbVC+pUPDt8PvxNfvhPKtHBx67VVYr+2C8q3R5G0cHFD026KZ
b+fQgGK/vQNDBbL7HBwY6pHc3+Dg0IDiP0eHA5VI/m9wdHBACR8nhwTk8Gtw
ctiAEr7ODjOQw7/B2UEDJX5cUOOvwcXhBkr8ujpsQY7/BlcHB5T04eawBjn9
NLihpS931PTX4I6WPj1Q02+Dh8MPlPTtCU//AKmL9l4=
       "]]}, 
     {RGBColor[1, 0, 0], PointSize[
       NCache[
        Rational[1, 120], 0.008333333333333333]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAmIQDQEf7N9qGRZwbuRygAo43Oz1WPh+NozP4dDyxXvK
3hgYX8BBL1Zl09HPnFC+iAOjT2/YpEQYX8JhnidT0/NlHFC+jIN++NQFR4+w
Q/kKDrOWPnieu4cNyldyODCjTTmznxXKV3G4Vz83bJI9C5Sv5pCwVHiS+nkm
KF/D4U9shOpTB0YoX8thxVx3n1SD//YQvo5DTt2d/fc3/Yby9Rx6bCv7fon8
gPINHBLaAvcWpn+B8g0dchLit187/AHKN3II4Lp36/eKV1C+sQND/V5pyVNP
oHwThwNbhLc9+PAAyjd1KLgdw3zy8X0o38zhAvckM/8NMHlzhwVFJ57ELX8I
5Vs4vPgVf+NowiMo39Lhh2a1zrbzML6Vw4E5Wpcnf4HxrR0+oMjbOHxA0W/r
UIBivh2a/fYOE1Dc5+BwA9n9DQ5o/nN0SED2f4OjQwlK+Dg5hCCHX4OTQw5K
+Do7lCCHf4OzwxKU+HFBjb8GF7T4dUWN/wZXh30o6cPNYQZy+mlwQ0tf7qjp
r8EdLX16oKbfBg+HVpT07QlP/wCW4uUE
       "]]}, 
     {RGBColor[1, 0, 0], PointSize[
       NCache[
        Rational[1, 120], 0.008333333333333333]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAmIQDQEf7I/UL62a7SfoABVwyHvY9322C4zP4fDg4k3j
dWowvoDDn/C6MyxfBaB8EYd5vIEqX9fD+BIO92U/Cf0Mh/FlHPKv2kgm3+aH
8hUcjiyPsr/6mA/KV3LYVPh8q9NpXihfxeHi1o9cklN4oHw1hy3lCcbBjtxQ
voZDBuv2rQuucUL5Wg7Pu3J2LYzggPJ1HLx22d1wOcsG5es5/PJKVY6xYYXy
DRxEDl283LOBGco3dLBqOyR7zoIJyjdyeBQY8XDVKwYo39ghwXfO5J8n/9tD
+CYOMUovbxov/Aflmzp8OCV41Go9jG/mINK19HMBH0y/uUPd1eOVccmMUL6F
g9PB27dSdWH2Wzos4I9f98AF5j4rh+8e8kf76tmhfGuHeSjyNg5uKPpt0cy3
c5BAsd/e4QmK+xwcQpDd3+DgkILiP0dU/zc4OpihhI+TAw9y+DU4OfxACV9n
1PBvcHZ4iBI/Lqjx1+CCFr+uDueQ47/BFS19uDkcR04/DW5o6csdNf01uKOl
Tw/U9NvggZa+PeHpHwDCftQ1
       "]]}, 
     {RGBColor[1, 0, 0], PointSize[
       NCache[
        Rational[1, 120], 0.008333333333333333]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAmIQDQEf7A9NvO6RKyfmABVw6Mq4eLRdBMbncPjzuiTr
+TdRKF/A4ZWY16c9R2F8EYfjQv+dohphfAkHN6PNTcZaML6Mw+XN6kcfHBCB
8hUcuL7F1iq4wfhKDklzDn+/tUsYyldxsH773kFdAcZXc4hweM4VVC4E5Ws4
7PFcl/r8oCCUr+XAuudXwwFGGF/HYYk4k7m4pQCUr+fAHSG73fkqH5Rv4OCY
sSio1JgXyjd02G8VvFh3KjeUb+RwblXaSwVWLijf2KH6T38l00QOKN/E4f7W
+T5GXuxQvqmDD6vN8UeubFC+mUNO7ZubK2ezQvnmDqdMeb2tE2F8Cwexv6Gp
CxfD+JYOu8qneV9JhOm3chDhbUm/3wUz3xpN3sZBAkW/rcMlFPPtHNJQ7Ld3
cEFxn4PDTWT3Nzg4NKD4z9HhKrL/Gxwd9qCEj5ODDXL4NTg58KKEr7PDcuTw
b3B2YEKJHxfU+GtwcQhDiV9XByvk+G9wdUhASR9uDjzI6afBDS19uaOmvwZ3
tPTpgZp+Gzwc/qKkb094+gcAoMLArw==
       "]]}, 
     {RGBColor[1, 0, 0], PointSize[
       NCache[
        Rational[1, 120], 0.008333333333333333]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAmIQDQEf7N/OYV5lsFLKASrgEP14tRvHfBifw8Fozoao
uQ0wvoCDaa3qVik/GF/EoSDJ4vtxdhhfwmHDhXQOrnWSUL6Mg2hsxKlkRxhf
wWHh11758kMSUL6SQ3ucYSKbEYyv4mCwVyrn2wRxKF/NgWuifF3gAzEoX8PB
RsjXxFsRxtdy8K+Nl3ELFYXydRziLJdU364VgfL1HPxNrxg8myMM5Rs49DQv
/DRxixCUb+hw3OP2ooLjglC+kUOT8IN3028IQPnGDiaujxonX+eH8k0ceFdw
bA7i5oPyTR3szkhs/xbOA+WbOTx9Y2Nx8jQXlG/ucF556wL2Ck4o38Ih/sUT
D7MCDijf0kEgT6j0yHF2KN/K4bmTXjhDL4xv7cCNIm/jkIqi3xbNfDuHOyj2
2zvYorjPwYEV2f0NDg6mKP5zdGhB9n+Do8MJlPBxcuhCDr8GJwdflPB1dohB
Dv8GZwcflPhxQY2/BhcHTpT4dXXQR47/BleHNpT04eawCDn9NLihpS931PTX
4I6WPj1Q02+Dh4MBSvr2hKd/AP2luaU=
       "]]}, 
     {RGBColor[1, 0, 0], PointSize[
       NCache[
        Rational[1, 120], 0.008333333333333333]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAmIQDQEf7DmLzKZWuMs5QAUcvAz9dnyygfE5HPZ4hC7M
lYXxBRyyuPsv8r2UhfJFHJQurbkksgDGl3C4vSvQ9boTjC/jcCjo2+9jF2Wg
fAWHlYdrNfN8YXwlhxWKYusKtklD+SoOIv6pE3t4YXw1h/jHUvtnBUtB+RoO
TH2zlCd0SkL5Wg59cpeD6jdIQPk6Duza6V9nnRSH8vUcGqz+BlleE4PyDRwa
JsVW3LwuCuUbOqhU7t+sdUEEyjdyeO1uVy1+UBjKN3YQm+scdnWNEJRv4pCU
b6D4Z6oglG/q8Mbsz9/l9QJQvpnD1Mp900Ju80H55g557q2xc07yQPkWDhFy
vSeTr3FB+ZYOW2NOhAQJckL5Vg4bjh4yTelnh/KtHZajyNs4pKDot3UoQDHf
zmEaiv32Di9R3OfgEI3s/gYHBxkU/zk6fED2f4OjgxJK+Dihhl+Dk0M9Svg6
o4Z/g7NDL0r8uKDGX4OLQyxK/Lo6CCPHf4MrWvpwQ00/DW5o6csdNf01uKOl
Tw/U9Nvg4bAbJX17wtM/ANnSxIU=
       "]]}, 
     {RGBColor[1, 0, 0], PointSize[
       NCache[
        Rational[1, 120], 0.008333333333333333]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAmIQDQEf7MUtzE7reCs4QAUc+tielx11hfE5HH7sqdKZ
agrjCzjsdiv+v0YKxhdxWOR4bUPQK3koX8JB5bPr4eQuGF/GwYzb5+YnURhf
wSHP+uPi6l45KF/JYZJp5Iz+j7JQvorD1ad1C646wfhqDuEGB05zNslA+RoO
jz7Wsf1dLw3lazmwb+Z+POWsFJSv41B8Mr7p9G1JKF/PIcx0zcb1tyWgfAOH
uYYHo1PPiUP5hg7rWjlr1baKQflGDg8LZB65TBSF8o0d/uhMUNJNEYHyTRy+
sUhMyNYXhvJNHUIOCvts+SII5Zs5rE7u7P+wVQDKN3d43p7WsvIVH5Rv4bDo
/C0mnmweKN/SwUFVv3fnZ04o38rh6dG4tLdz2KF8awd7FHkbhxUo+m0dnqKY
b+ewAsV+e4dAFPc5OHxAdn+Dg8NvFP85OjxC9n+DI1r4ODnMQQ6/BieHIJTw
dXYoQQ7/BmcHFpT4cUGNvwYXhxCU+HV1uIYc/w2uDpNR0oebQz5y+mlwQ0tf
7qjpr8EdLX16oKbfBg+H7yjp2xOe/gH908wK
       "]]}}, {{}, {}}}, {{}, {{}, {}, 
     {RGBColor[0, 0, 1], PointSize[
       NCache[
        Rational[1, 120], 0.008333333333333333]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAmIQDQEf7BtMZhjIL5Y7ABVwqLj4sz1gBozP4eBhp/j5
fTmML+BwKVBoprwTjC/i8IeVyVviuyyUL+HQsr0wVnM6jC/j0HO+vHiHEoyv
4HDqv4yd4ywZKF/J4dHPFqPQf9JQvoqDxqpVVrP9YXw1hwVfXqee75OC8jUc
LLatWnBojySUr+UQUG5eG3VLAsrXcdjW2y0z8YU4lK/n0PbzunfpCzEo38Dh
wNc3X7Vui0L5hg7nPE3F3xwUgfKNHP6ZeNRwzROG8o0dlD7u3vOpQAjKN3Fg
OemsZWgjCOWbOkS02j+rZBSA8s0cHPyzgnNaeaF8c4c5/Pt2mLBwQ/kWDjrh
RubTWzigfEuHkDVtB1142aB8K4cJ0ttmVWxjhvKtHRxQ5G0cFFD026KZb+dg
gmK/vUMUivscHDiQ3d/g4CCE4j9HVP83ODpcQAkfJ4d9yOHX4OTQhRK+zg4b
kMO/wdkhAiV+XFDjr8HFYR1K/Lo6GCHHf4OrwxOU9OHmcAQ5/TS4oaUvd9T0
1+COlj49UNNvg4eDC0r69oSnfwCGWN1u
       "]]}, 
     {RGBColor[0, 0, 1], PointSize[
       NCache[
        Rational[1, 120], 0.008333333333333333]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAmIQDQEf7I3MkvTtQmQOQAUcKr5WBu3whPE5HN7wNFob
a8H4Ag5zzu/KvvJVGsoXcQiYdiPn1hoYX8KBo772/hx/GF/G4ZGY0rSee1JQ
voLDsfaVh42jYHwlhyNPHT3MDktC+SoOGsITtYOkYHw1h5TlbpEJCRJQvoYD
V9CxvaHTxKF8LYdpj/69cdkrBuXrOHC9n9SfcE0UytdzKPun8fbfIxEo38Ch
KKxTaP4TYSjf0IHD9rXvhztCUL6RwwnuLNG7ZwWhfGOHbwn5H2btFIDyTRwC
0naUNbvyQ/mmDiVf/Q1uS/BC+WYOGoxip+9/4YLyzR1enLszUf0xB5Rv4fBl
6ZO/796zQfmWDhZP5DvvarFC+VYOJyykst6vYIbyrR1UUORtHJ6g6Ld1+IBi
vp2DAor99g4FKO5zQHV/g4PDDxT/OTocQfZ/g6MDF0r4ODnkIYdfg5NDCUr4
Ojt8e4cU/g3OaPHjghp/DS4ORSjx64oa/w2uDodQ0oebwznk9NPghpa+3FHT
X4M7Wvr0QE2/DR4OH1DStyc8/QMAq0DpTA==
       "]]}, 
     {RGBColor[0, 0, 1], PointSize[
       NCache[
        Rational[1, 120], 0.008333333333333333]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAmIQDQEf7E8l6Lt82ypxACrgYLD8+oOzq2F8Dodf8Xe+
JPXC+AIOHI6B/g+iYHwRBw+1lIm9IjC+hEPLlMmLzu8Sh/JlHG4otKRo+sH4
Cg4xO3futDkvBuUrOTgpxf4+bQfjqzhcaXBj2zNXFMpXc9gQ4i0h/lYEytdw
uHC14pyAHoyv5XDLoXsbd5IwlK/j8OTPedGFXUJQvp7Djh//T61eKQjlGzi8
czvbE35QAMo3dDCQ4KvKWcEP5Rs57FgrLrT7FC+Ub+xw4bTlNrmP3FC+icMK
vYTnd1W4oHxTB4bggteNhRxQvpnDnuIpOSFP2aB8c4cPq3iuTprICuVbONzJ
t6k92MkC5Vs6HPiaudL/ITOUb+Xgcaa1u3sZjG/tsANF3sbhBYp+W4c3KObb
ORxBsd/e4UcQsvscHGYgu7/BweEBiv8cHbYg+7/B0cEDJXycHO4gh1+DE1r4
OjvcQg7/BmeHKyjx44Iafw0uaPHrihr/Da4OHijpw80hATn9NLihpS931PTX
4I6WPj1Q02+Dh8MPlPTtCU//AIJj6GE=
       "]]}, 
     {RGBColor[0, 0, 1], PointSize[
       NCache[
        Rational[1, 120], 0.008333333333333333]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAmIQDQEf7MVCmR8baYscgAo43NH+G++rCONzOHitX8Cy
lhnGF3AwulXa03RJGMoXcZC5pnVXvg/Gl3Ao+3pP5qcZjC/jwFIeHL/srBCU
r+CgtrNT/FkQjK/kkBL/fuKC44JQvoqDyQbp2290YHw1Bz1m4aXiLQJQvobD
H4kt/yPn8kP5Wg4Jf33MeGT5oHwdh4wt0Yt2dvNA+XoOL+6UvD73jgvKN3B4
8OZnG4MvJ5Rv6KCyf9X1HevYoXwjBwf9fbJr5NigfGOHLw3P1/auYoHyTRxa
rL437E1mhvJNHTq6Jv/OjWeC8s0cEphd+Ey3MkL55g4r9qTUH6uC8S0clrSs
namzF8a3dLjy/219fDVMv5VDz+rbs7OWwMy3djiCIm/jMANFv63DEhTz7Rwi
UOy3d2hBcZ+DQwOy+xscHP6g+M8R1f8Njg4GKOHj5HAFOfwanBzeoISvs0MM
cvg3ODuEoMSPC2r8Nbg46KDEr6uDBXL8N7g6ZKGkDzcHFeT00+CGlr7cUdNf
gzta+vRATb8NHg5+KOnbE57+AZm84VQ=
       "]]}, 
     {RGBColor[0, 0, 1], PointSize[
       NCache[
        Rational[1, 120], 0.008333333333333333]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAmIQDQEf7ANaF2ke2sZ3ACrg0OJRqnx4EYzP4VCjyT3n
eRqML+AwxTTk7BRmGF/E4cCCnzWllbxQvoQDz0HrqNqTPFC+jENF1BTfd1+4
oXwFhxqdTcUJf7mgfCUHlW92r84+4YTyVRyuWHraL1nLAeWrOXj83p5+L4od
ytdwiOjge6X9gRXK13Iw4D3yTqeIBcrXcXhiPY3nwjMmKF/PYc3pPeHPQxmh
fAOHD81BAgZT/u+H8A0dHnCZLNm05A+Ub+SQsDBeO4fjF5Rv7GDh4/2H/+93
KN/EoUFlhpPXlW9QvqlDw6UDuoGPYHwzhwsKv/x/+P+A8s0dKnbZxVz+CTPP
wqFhcprco95/UL6lw4EZ2x5lx8HcZ+Xw4X/ZT8mZzFC+tcMWFHkbhwgU/bYO
BSjm26HZb+/QgeI+B4cOZPc3OKD5z9GhAdn/DY5o4ePkcAE5/BqcHFaghK+z
wxXk8G9wdlBBiR8X1PhrcHFwQYlfV4c7yPHf4IqWPtwcWpDTT4MbWvpyR01/
De5o6dMDNf02eDhUoKRvT3j6BwAlhvIt
       "]]}, 
     {RGBColor[0, 0, 1], PointSize[
       NCache[
        Rational[1, 120], 0.008333333333333333]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAmIQDQEf7B02diyZcortAFTAQUdkwdWqrTA+h8OaqsUn
PMpgfAEHncfVzwJ4YXwRhwsXn3TJVrNC+RIOEucjtxUdYIHyZRx87ry5EnCP
GcpXcNDQspD5eZUJyldymCJzL/zLCkYoX8XhBtPXLtlIBihfzcHB71pP6sW/
+yF8DQeNPfGbH2z5BeVrOVTM/LalOvk7lK/jwFHSrfHt6WcoX8+hQFPju4DH
ByjfwOHGMQYfAdOXUL6hwwN3GYdbbx9C+UYOBmllEYFy16B8YweHA+lbxA8e
gfJNHBpU35fdKFgK5Zs6MLjpHgphaYPyzRwYGA7VHUhfCOWbOzQki2yMzdkA
5Vs4HHh4wXeq+TYo39LhQN2qd+Lrd0L5Vg4HFNVUWK/tgvKtHRrqkeVtHBoe
Ieu3RTPfzqGBGdl+ewcGO2T3OTg0qCC5v8EBzX+ODg7I/m9wdPiAEj5ODi+Q
w6/ByaEFJXydHW4UI4V/g7NDAUr8uKDGX4OLgwdK/Lo6XEGO/wZXhw6U9OHm
wIOcfhrc0NKXO2r6a3BHS58eqOm3wQMtfXvC0z8Ah83xRw==
       "]]}, 
     {RGBColor[0, 0, 1], PointSize[
       NCache[
        Rational[1, 120], 0.008333333333333333]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAmIQDQEf7GOkDAs4N3I5QAUc9Go9Fr6fDeNzOGx97D1l
bwyML+Ag6KOy6ehnTihfxKHQqjdsUiKML+FQbs7U9HwZB5Qv4+DqMnXB0SPs
UL6Cw66JD57n7mGD8pUcVjS3KWf2s0L5Kg4WmXPDJtmzQPlqDtt6hCepn2eC
8jUcZjlFqD51YITytRw4Etx9Ug3+20P4Og4u5nf239/0G8rXc3jxoqLvl8gP
KN/AIUE2cG9h+hco39BB5Xrc9muHP0D5Rg4CHXdu/V7xCso3dtiht1ta8tQT
KN/E4YC4wLYHHx5A+aYOC9qCmU8+vg/lmzk4yPea+W+AyZs7nGg5/CRu+UMo
38IhQzj6xtGER1C+pYODe5nOtvMwvpXDit2qlyd/gfGtHQxQ5G0cAlD02zo8
QDHfzsEDxX57hw0o7nNwuIDs/gYHhxko/nN0+NCO5P8GRwcDlPBxcshBDr8G
J4cHKOHr7BCAHP4Nzg4MKPHjghp/DS4Oa1Di19XBCDn+G1wdFqCkDzeHPcjp
p8ENLX25o6a/Bne09OmBmn4bPBy2oaRvT3j6BwAFT9vC
       "]]}, 
     {RGBColor[0, 0, 1], PointSize[
       NCache[
        Rational[1, 120], 0.008333333333333333]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAmIQDQEf7K/VLq2a7SfoABVwqLjf9322C4zP4fDm/E3j
dWowvoADQ1jdGZavAlC+iMNM7kCVr+thfAmHC9KfhH6Gw/gyDqYXbSSTb/ND
+QoO6Yuj7K8+5oPylRzMc59vdTrNC+WrOFhs/MglOYUHyldz+FiUYBzsyA3l
azi0M2zfuuAaJ5Sv5fCgNWfXwggOKF/HwW+r3Q2Xs2xQvp6DnluqcowNK5Rv
4HBt78XLPRuYoXxDh7TmQ7LnLJigfCOHmMCIh6teMUD5xg4dIXMm/zz53x7C
N3G4YPLypvHCf1C+qcOWF4JHrdbD+GYOeXOWfi7gg+k3d/j3/HhlXDIjlG/h
wHfp9q1UXZj9lg5T5OLXPXCBuc/K4Wup/NG+enYo3xpN3saBC0W/rQPTC2Tz
7RxyUOy3d7iC4j4HhyPI7m9wQPOfo0MKsv8bHB2SUMLHyeEOcvg1ODkYoISv
s4Mbcvg3ODs8QYkfF9T4a3BxeIcSv64Ousjx3+DqYICSPtwcUpHTT4MbWvpy
R01/De5o6dMDNf02eKClb094+gcAmtvQqg==
       "]]}, 
     {RGBColor[0, 0, 1], PointSize[
       NCache[
        Rational[1, 120], 0.008333333333333333]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAmIQDQEf7L/1X/fIlRNzgAo47Eu7eLRdBMbncDB4VZL1
/JsolC/gICXq9WnPURhfxOGbwH+nqEYYX8Ihz2Bzk7EWjC/j8G2j+tEHB0Sg
fAUHjS+xtQpuML6SQ8Wsw99v7RKG8lUcAl6/d1BXgPHVHFLsnnMFlQtB+RoO
59zXpT4/KAjlazkI7frVcIARxtdx2CPKZC5uKQDl6zmEhchud77KB+UbOBxJ
WRRUaswL5Rs6TDIPXqw7lRvKN3KwWZH2UoGVC8o3djjxq7+SaSIHlG/i4L91
vo+RFzuUb+rgwGZz/JErG5Rv5sDS8ObmytmsUL65wwlLXm/rRBjfwuEPY1jq
wsUwvqXDvZpp3lcSYfqtHGwNWtLvd8HMt3Z4giJv4/AFRb+twxUU8+0c/tQj
22/vYIXiPgcHL2T3Nzg47EPxn6ODM7L/GxwdJqKEj5PDIeTwa3ByiEIJX2eH
3cjh3+DsIIYSPy6o8dfg4pCIEr+uDv7I8d/g6lCOkj7cUNNPgxta+nJHTX8N
7mjp0wM1/TZ4OBiipG9PePoHAJojv/g=
       "]]}, 
     {RGBColor[0, 0, 1], PointSize[
       NCache[
        Rational[1, 120], 0.008333333333333333]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAmIQDQEf7PfOZl5lsFLKASrgoP1otRvHfBifw4Fx9oao
uQ0wvoADc43qVik/GF/EwT7R4vtxdhhfwqHmfDoH1zpJKF/G4Ul0xKlkRxhf
wSHvS698+SEJKF/JISTWMJHNCMZXcfizWyrn2wRxKF/N4Va/fF3gAzEoX8OB
X9DXxFsRxtdyUK2Jl3ELFYXydRwcLJZU364VgfL1HGxMrhg8myMM5Rs4dDYt
/DRxixCUb+hwz/32ooLjglC+kcMBoQfvpt8QgPKNHVhcHjVOvs4P5Zs4pC7n
2BzEzQflmzrYnZHY/i2cB8o3c9j01sbi5GkuKN/coV916wL2Ck4o38KB8/UT
D7MCDijf0iG1UKj0yHF2KN/KIT9ML5yhF8a3dkhHkbdx4EHRb+swEcV8O4dV
KPbbO1iiuM/BIRnZ/Q0ODpwo/nNE9X+DI1r4ODl0IIdfg5ODJUr4OjvYIYd/
g7ODGkr8uKDGX4OLw02U+HV1+IUc/w2uDkEo6cMNNf00uKGlL3fU9NfgjpY+
PVDTb4MHWvr2hKd/AF4Luhk=
       "]]}, 
     {RGBColor[0, 0, 1], PointSize[
       NCache[
        Rational[1, 120], 0.008333333333333333]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAmIQDQEf7NsKzaZWuMs5QAUcjhv47fhkA+NzOFh5hC7M
lYXxBRxecvVf5HspC+WLOCy8uOaSyAIYX8IhYleg63UnGF/GwSno2+9jF2Wg
fAUHrcO1mnm+ML6Sg46i2LqCbdJQvorDdL/UiT28ML6aw4tHUvtnBUtB+RoO
E3tnKU/olITytRyU5S4H1W+QgPJ1HJZppX+ddVIcytdz0LT6G2R5TQzKN3Cw
nBRbcfO6KJRv6PCqYv9mrQsiUL6Rw0l3u2rxg8JQvrGDyFznsKtrhKB8E4e6
fAPFP1MFoXxTB3vzP3+X1wtA+WYOJ6v2TQu5zQflmzuYeLbGzjnJA+VbOFxR
6D2ZfI0Lyrd0uBV/IiRIkBPKt3Ko2XPINKWfHcq3djiLIm/jcBVFv62DLYr5
dg67Uey3d7BDcZ+DQwOy+xscHMRQ/OfocArZ/w2ODu9QwsfJwQw5/BqcHDRQ
wtfZYSly+Dc4O6igxI8Lavw1uDi8RIlfV9T4b3B10EZJH26o6afBDS19uaOm
vwZ3tPTpgZp+GzzQ0rcnPP0DAIcWxm8=
       "]]}, 
     {RGBColor[0, 0, 1], PointSize[
       NCache[
        Rational[1, 120], 0.008333333333333333]], AbsoluteThickness[1.6], 
      LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAmIQDQEf7J0tzE7reCs4QAUcdrM9LzvqCuNzOKjvrdKZ
agrjCzi8cSv+v0YKxhdxYHO6tiHolTyUL+HQ99n1cHIXjC/jsIrb5+YnURhf
weGd9cfF1b1yUL6Sg6xZ5Iz+j7JQvopD7rO6BVedYHw1h38GB05zNslA+RoO
Sz7Vsf1dLw3laznc2cz9eMpZKShfxyHjVHzT6duSUL6eQ7rZmo3rb0tA+QYO
14wORqeeE4fyDR0E2jlr1baKQflGDqVFMo9cJopC+cYOp/QmKOmmiED5Jg6c
7BITsvWFoXxTh32HhX22fBGE8s0cqtM6+z9sFYDyzR3K+tJaVr7ig/ItHNyv
32LiyeaB8i0d7unq9+78zAnlWzm86YtLezuHHcq3driPIm+Dpt/WoRTFfDuH
ChT77R32oLjPwYEL2f0NDg5nUfzn6FCC7P8GRwchlPBxcriCHH4NTg5pKOHr
7JCGHP4Nzg63UeLHBTX+GlzQ4tfVIQc5/htcHaRR0oebw1vk9NPghpa+3FHT
X4M7Wvr0QE2/DR5o6dsTnv4BMdrKCw==
       "]]}}, {{}, {}}}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->{True, True},
  AxesLabel->{None, None},
  AxesOrigin->{0., 0},
  DisplayFunction->Identity,
  Frame->{{False, False}, {False, False}},
  FrameLabel->{{None, None}, {None, None}},
  FrameTicks->{{Automatic, Automatic}, {Automatic, Automatic}},
  GridLines->{None, {0}},
  GridLinesStyle->Directive[
    GrayLevel[0.5, 0.4]],
  Method->{
   "OptimizePlotMarkers" -> True, "OptimizePlotMarkers" -> True, 
    "CoordinatesToolOptions" -> {"DisplayFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& ), "CopiedValueFunction" -> ({
        Identity[
         Part[#, 1]], 
        Identity[
         Part[#, 2]]}& )}},
  PlotRange->{-3., 3.},
  PlotRangeClipping->True,
  PlotRangePadding->{{
     Scaled[0.02], 
     Scaled[0.02]}, {
     Scaled[0.05], 
     Scaled[0.05]}},
  Ticks->{Automatic, Automatic}]], "Output",
 CellChangeTimes->{3.87847692869406*^9},
 CellLabel->"Out[61]=",
 CellID->356402827,ExpressionUUID->"73ad917d-57fa-40b2-9b89-b0df300e369a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"{", 
    RowBox[{"bandsup", ",", "bandsdo"}], "}"}], "=", 
   RowBox[{"First", "/@", 
    RowBox[{"{", 
     RowBox[{"bdup", ",", "bddo"}], "}"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bandsup", "=", 
   RowBox[{"Most", "@", "bandsup"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bandsdo", "=", 
   RowBox[{"Most", "@", "bandsdo"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bands", "=", 
   RowBox[{"Join", "[", 
    RowBox[{"bandsup", ",", "bandsdo"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"FreeEnergy", "[", 
  RowBox[{"Temp", ",", "bands", ",", "\[Mu]"}], "]"}]}], "Input",
 CellChangeTimes->{3.8784769535614824`*^9},
 CellLabel->"In[62]:=",
 CellID->301794949,ExpressionUUID->"d244a178-f1a2-4f7b-9da3-86be8bf91642"],

Cell[BoxData[
 RowBox[{"-", "128.97659643597464`"}]], "Output",
 CellChangeTimes->{3.8784769547345486`*^9},
 CellLabel->"Out[66]=",
 CellID->244172380,ExpressionUUID->"0a25ae49-b2b1-43c2-b628-f0eab15b20f8"]
}, Open  ]]
}, Closed]],

Cell["\<\
It follows from this calculation that FM configuration is more stable than \
AFM one. This is in contradiction with Magda2014 work...\
\>", "Text",
 CellChangeTimes->{{3.878476504431794*^9, 3.8784765048248167`*^9}, {
  3.878477022162407*^9, 3.878477079038659*^9}},
 CellID->427396307,ExpressionUUID->"27e4f825-31ef-48a2-bd17-5ca9e549d400"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Half-metallic graphene nanoribbons", "Subsubsection",
 CellChangeTimes->{{3.878132221011133*^9, 3.878132233512848*^9}},
 CellID->152948105,ExpressionUUID->"0cb9b211-6e52-451d-9eab-bca6f29d7a4b"],

Cell[TextData[{
 "XXXX ",
 ButtonBox["Y.-W. Son, M. L. Cohen, and S. G. Louie, ",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1038/nature05180"], None}],
 StyleBox[ButtonBox["Nature",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1038/nature05180"], None}],
  FontSlant->"Italic"],
 ButtonBox[" ",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1038/nature05180"], None}],
 StyleBox[ButtonBox["444",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1038/nature05180"], None}],
  FontWeight->"Bold"],
 ButtonBox[", 347 (2006)",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1038/nature05180"], None}],
 "."
}], "Text",
 CellChangeTimes->{{3.87813231799168*^9, 3.87813232920132*^9}, {
  3.878132372490797*^9, 3.8781323726048036`*^9}},
 CellID->83376063,ExpressionUUID->"9c0c6b61-f7f2-4fdc-b5f4-618b0e0c7997"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Triangulene", "Subsubsection",
 CellChangeTimes->{{3.878131274689007*^9, 3.878131278094201*^9}},
 CellID->77061337,ExpressionUUID->"0fa9474d-ac4a-4e3f-bda9-5e61b5255357"],

Cell[TextData[{
 "Based on paper ",
 ButtonBox["S. Mishra et al., ",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1002/anie.202002687"], None}],
 StyleBox[ButtonBox["Angew. Chemie Int. Ed.",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1002/anie.202002687"], None}],
  FontSlant->"Italic"],
 ButtonBox[" ",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1002/anie.202002687"], None}],
 StyleBox[ButtonBox["59",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1002/anie.202002687"], None}],
  FontWeight->"Bold"],
 ButtonBox[", 12041 (2020)",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1002/anie.202002687"], None}],
 "."
}], "Text",
 CellChangeTimes->{{3.878131377364879*^9, 3.878131402301306*^9}, {
  3.8781314964136887`*^9, 3.878131496528695*^9}},
 CellID->419431593,ExpressionUUID->"b7a8bf63-fe2f-450e-911c-207a03802772"],

Cell[CellGroupData[{

Cell["XXXX", "Text",
 CellID->179323992,ExpressionUUID->"07f65a40-55a2-4e0d-bd61-de6fdc1062f8"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"uc", ",", "T", ",", "a0"}], "}"}], "=", 
    RowBox[{"IVGroupQuantumDot", "[", 
     RowBox[{"3", ",", "1"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"AtomicStructure", "[", 
  RowBox[{"data", ",", 
   RowBox[{"PlaneProjection", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", "0"}], "}"}]}], ",", 
   RowBox[{"AtomEnumeration", "\[Rule]", "True"}]}], "]"}]}], "Input",
 CellChangeTimes->{3.8781313304131937`*^9},
 CellID->410410689,ExpressionUUID->"84d74c68-bd13-49a8-8ad7-43a9fc301d8a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"U", "=", "3.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t1", "=", "2.7"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"supplementary", " ", "materials", " ", "of", " ", 
     RowBox[{"S", ".", "Mishra"}], " ", "et", " ", 
     RowBox[{"al", "."}]}], ",", 
    RowBox[{
     RowBox[{"Angew", ".", " ", "Chemie"}], " ", 
     RowBox[{"Int", ".", " ", "Ed"}], ".59"}], ",", 
    RowBox[{"12041", " ", 
     RowBox[{"(", "2020", ")"}], " ", "and", " ", 
     RowBox[{"S", ".", "Mishra"}], " ", "et", " ", 
     RowBox[{"al", "."}]}], ",", 
    RowBox[{
     RowBox[{"J", ".", " ", "Am", ".", " ", "Chem", ".", " ", "Soc"}], 
     ".141"}], ",", 
    RowBox[{"10621", " ", 
     RowBox[{
      RowBox[{"(", "2019", ")"}], "."}]}]}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Temp", "=", "4"}], ";"}], 
  RowBox[{"(*", " ", "K", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "FM", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"spinconfig", "=", 
   RowBox[{"{", "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"Length", "[", "uc", "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"1", ",", 
       RowBox[{"Length", "[", "uc", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
    "}"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "AFM", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"spinconfig", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
        "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "1", ",", 
        "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
        "1"}], "}"}]}], "}"}]}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"AbsoluteTiming", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"bdup", ",", "bddo", ",", "\[Mu]", ",", "occnumbers"}], "}"}], 
    "=", 
    RowBox[{"HubbardMeanField", "[", 
     RowBox[{"uc", ",", "T", ",", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], "}"}], ",", "U", ",", "t1", 
      ",", 
      RowBox[{"\"\<Temperature\>\"", "\[Rule]", "Temp"}], ",", 
      RowBox[{"\"\<SpinDensityScaleFactor\>\"", "\[Rule]", "2"}], ",", 
      RowBox[{"\"\<CMonitor\>\"", "\[Rule]", "True"}], ",", 
      RowBox[{"\"\<SpinConfiguration\>\"", "\[Rule]", "spinconfig"}]}], 
     "]"}]}], ";"}], "]"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{3.87813152389726*^9},
 CellID->639912496,ExpressionUUID->"5724424e-f7fb-43fd-a197-f1198beebd28"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"p1", "=", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "-", 
            "\[Mu]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", 
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "-", 
            "\[Mu]"}]}], "}"}]}], "}"}], "&"}], "/@", 
      RowBox[{"Most", "[", 
       RowBox[{"bdup", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
        "]"}]}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.9", ",", "2.1"}], "}"}], ",", 
        RowBox[{"1.7", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "2"}], ",", "2"}], "}"}]}]}], "}"}]}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Opacity", "[", "0.4", "]"}], ",", "Red", ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "}"}], "]"}]}], ",", 
     RowBox[{"Ticks", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"None", ",", "Automatic"}], "}"}]}], ",", 
     RowBox[{"Axes", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"False", ",", "True"}], "}"}]}]}], 
    RowBox[{"(*", 
     RowBox[{"GridLines", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"None", ",", 
        RowBox[{"{", "\[Mu]", "}"}]}], "}"}]}], "*)"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p2", "=", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "-", 
            "\[Mu]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", 
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "-", 
            "\[Mu]"}]}], "}"}]}], "}"}], "&"}], "/@", 
      RowBox[{"Most", "[", 
       RowBox[{"bddo", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
        "]"}]}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Opacity", "[", "0.2", "]"}], ",", "Blue", ",", 
         RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "}"}], "]"}]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Show", "[", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"p1", ",", "p2"}], "}"}], ",", 
   RowBox[{"AspectRatio", "\[Rule]", "2"}], ",", 
   RowBox[{"ImageSize", "\[Rule]", 
    RowBox[{"{", "300", "}"}]}]}], "]"}]}], "Input",
 CellChangeTimes->{3.878131573757112*^9},
 CellID->479092683,ExpressionUUID->"c202cbaa-d8cc-45f1-ae80-3521c864354a"]
}, Open  ]],

Cell[TextData[{
 "These results are in agreement with Fig. 3 (b) of ",
 ButtonBox["S. Mishra et al., ",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1002/anie.202002687"], None}],
 StyleBox[ButtonBox["Angew. Chemie Int. Ed.",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1002/anie.202002687"], None}],
  FontSlant->"Italic"],
 ButtonBox[" ",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1002/anie.202002687"], None}],
 StyleBox[ButtonBox["59",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1002/anie.202002687"], None}],
  FontWeight->"Bold"],
 ButtonBox[", 12041 (2020)",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1002/anie.202002687"], None}],
 "."
}], "Text",
 CellChangeTimes->{{3.8781315894290085`*^9, 3.8781316322624593`*^9}},
 CellID->1656622,ExpressionUUID->"5c0b93d0-f7b8-46c1-87f1-bfd114bbabb1"]
}, Closed]],

Cell[CellGroupData[{

Cell["Extended triangulene", "Subsubsection",
 CellChangeTimes->{{3.878131711958017*^9, 3.878131717452331*^9}},
 CellID->120439617,ExpressionUUID->"295fa2ce-38cf-4262-854d-52c2295cf7ff"],

Cell[TextData[{
 "Here we follow ",
 ButtonBox["S. Mishra et al., ",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1021/jacs.9b05319"], None}],
 StyleBox[ButtonBox["J. Am. Chem. Soc.",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1021/jacs.9b05319"], None}],
  FontSlant->"Italic"],
 ButtonBox[" ",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1021/jacs.9b05319"], None}],
 StyleBox[ButtonBox["141",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1021/jacs.9b05319"], None}],
  FontWeight->"Bold"],
 ButtonBox[", 10621 (2019)",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1021/jacs.9b05319"], None}],
 "."
}], "Text",
 CellChangeTimes->{{3.878132144850777*^9, 3.87813215784352*^9}},
 CellID->25364302,ExpressionUUID->"9e36d79b-fcd0-4471-b904-710f52b6d9e9"],

Cell[CellGroupData[{

Cell["XXXX", "Text",
 CellID->532343381,ExpressionUUID->"b42fc24c-a7ca-4410-88c8-c19e2d64c6d5"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"data", "=", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"uc", ",", "T", ",", "a0"}], "}"}], "=", 
    RowBox[{"IVGroupQuantumDot", "[", 
     RowBox[{"4", ",", "1"}], "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"AtomicStructure", "[", 
  RowBox[{"data", ",", 
   RowBox[{"PlaneProjection", "\[Rule]", 
    RowBox[{"{", 
     RowBox[{"1", ",", "1", ",", "0"}], "}"}]}], ",", 
   RowBox[{"AtomEnumeration", "\[Rule]", "True"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.878131740978677*^9, 3.8781317457429504`*^9}},
 CellID->133310808,ExpressionUUID->"62de73de-98a0-40b4-a293-3ea01679d72e"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"U", "=", "3.5"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"t1", "=", "2.7"}], ";"}], " ", 
  RowBox[{"(*", " ", 
   RowBox[{
    RowBox[{"supplementary", " ", "materials", " ", "of", " ", 
     RowBox[{"S", ".", "Mishra"}], " ", "et", " ", 
     RowBox[{"al", "."}]}], ",", 
    RowBox[{
     RowBox[{"Angew", ".", " ", "Chemie"}], " ", 
     RowBox[{"Int", ".", " ", "Ed"}], ".59"}], ",", 
    RowBox[{"12041", " ", 
     RowBox[{"(", "2020", ")"}], " ", "and", " ", 
     RowBox[{"S", ".", "Mishra"}], " ", "et", " ", 
     RowBox[{"al", "."}]}], ",", 
    RowBox[{
     RowBox[{"J", ".", " ", "Am", ".", " ", "Chem", ".", " ", "Soc"}], 
     ".141"}], ",", 
    RowBox[{"10621", " ", 
     RowBox[{
      RowBox[{"(", "2019", ")"}], "."}]}]}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Temp", "=", "4"}], ";"}], 
  RowBox[{"(*", " ", "K", " ", "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "FM", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"spinconfig", "=", 
   RowBox[{"{", "\[IndentingNewLine]", "\t", 
    RowBox[{
     RowBox[{"ConstantArray", "[", 
      RowBox[{"0", ",", 
       RowBox[{"Length", "[", "uc", "]"}]}], "]"}], ",", 
     "\[IndentingNewLine]", "\t", 
     RowBox[{"ConstantArray", "[", 
      RowBox[{"1", ",", 
       RowBox[{"Length", "[", "uc", "]"}]}], "]"}]}], "\[IndentingNewLine]", 
    "}"}]}], "\[IndentingNewLine]", 
  RowBox[{"(*", " ", "AFM", " ", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"spinconfig", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
      "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1", ",", "1", ",", "1", ",", "1", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{
      "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0", ",", 
       "0", ",", "0", ",", "0", ",", "0", ",", "1", ",", "1", ",", "1", ",", 
       "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", "1", ",", 
       "1", ",", "1", ",", "1", ",", "1", ",", "1"}], "}"}]}], "}"}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{"AbsoluteTiming", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"bdup", ",", "bddo", ",", "\[Mu]", ",", "occnumbers"}], "}"}], 
    "=", 
    RowBox[{"HubbardMeanField", "[", 
     RowBox[{"uc", ",", "T", ",", 
      RowBox[{"{", 
       RowBox[{"{", 
        RowBox[{"0", ",", "0", ",", "0"}], "}"}], "}"}], ",", "U", ",", "t1", 
      ",", 
      RowBox[{"\"\<Temperature\>\"", "\[Rule]", "Temp"}], ",", 
      RowBox[{"\"\<SpinDensityScaleFactor\>\"", "\[Rule]", "2"}], ",", 
      RowBox[{"\"\<CMonitor\>\"", "\[Rule]", "True"}], ",", 
      RowBox[{"\"\<SpinConfiguration\>\"", "\[Rule]", "spinconfig"}]}], 
     "]"}]}], ";"}], "]"}]}], "Input",
 CellChangeTimes->{3.87813176498105*^9},
 CellID->501590767,ExpressionUUID->"c782b48e-b3a4-4474-b86e-4acf503695fd"]
}, Open  ]],

Cell[CellGroupData[{

Cell["XXXX", "Text",
 CellID->102563042,ExpressionUUID->"39010a68-1846-4d99-bc6d-5dc807227573"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"p1", "=", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "-", 
            "\[Mu]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", 
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "-", 
            "\[Mu]"}]}], "}"}]}], "}"}], "&"}], "/@", 
      RowBox[{"Most", "[", 
       RowBox[{"bdup", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
        "]"}]}], ",", 
     RowBox[{"PlotRange", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"0.9", ",", "2.1"}], "}"}], ",", 
        RowBox[{"1.7", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "2"}], ",", "2"}], "}"}]}]}], "}"}]}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Opacity", "[", "0.4", "]"}], ",", "Red", ",", 
         RowBox[{"AbsoluteThickness", "[", "2", "]"}]}], "}"}], "]"}]}], ",", 
     RowBox[{"Ticks", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"None", ",", "Automatic"}], "}"}]}], ",", 
     RowBox[{"Axes", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"False", ",", "True"}], "}"}]}]}], 
    RowBox[{"(*", 
     RowBox[{"GridLines", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"None", ",", 
        RowBox[{"{", "\[Mu]", "}"}]}], "}"}]}], "*)"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"p2", "=", 
   RowBox[{"ListLinePlot", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"1", ",", 
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "-", 
            "\[Mu]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"2", ",", 
           RowBox[{
            RowBox[{
            "#", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}], "-", 
            "\[Mu]"}]}], "}"}]}], "}"}], "&"}], "/@", 
      RowBox[{"Most", "[", 
       RowBox[{"bddo", "\[LeftDoubleBracket]", "1", "\[RightDoubleBracket]"}],
        "]"}]}], ",", 
     RowBox[{"PlotStyle", "\[Rule]", 
      RowBox[{"Directive", "[", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Opacity", "[", "0.2", "]"}], ",", "Blue", ",", 
         RowBox[{"AbsoluteThickness", "[", "3", "]"}]}], "}"}], "]"}]}]}], 
    "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Grid", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"\"\<general view\>\"", ",", "\"\<zoom to Ef\>\""}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"p1", ",", "p2"}], "}"}], ",", 
        RowBox[{"AspectRatio", "\[Rule]", "2"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", 
         RowBox[{"{", "300", "}"}]}]}], "]"}], ",", 
      RowBox[{"Show", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"p1", ",", "p2"}], "}"}], ",", 
        RowBox[{"AspectRatio", "\[Rule]", "2"}], ",", 
        RowBox[{"ImageSize", "\[Rule]", 
         RowBox[{"{", "300", "}"}]}], ",", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"-", "0.1"}], ",", "1"}], "}"}]}]}], "]"}]}], "}"}]}], 
   "}"}], "]"}]}], "Input",
 CellChangeTimes->{3.878131815739953*^9},
 CellID->215651520,ExpressionUUID->"4009e675-e43a-483a-84f3-04fda83f6aae"]
}, Open  ]],

Cell[TextData[{
 "These energy levels are in agreement with Fig. 2 (b) in ",
 ButtonBox["S. Mishra et al., ",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1021/jacs.9b05319"], None}],
 StyleBox[ButtonBox["J. Am. Chem. Soc.",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1021/jacs.9b05319"], None}],
  FontSlant->"Italic"],
 ButtonBox[" ",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1021/jacs.9b05319"], None}],
 StyleBox[ButtonBox["141",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1021/jacs.9b05319"], None}],
  FontWeight->"Bold"],
 ButtonBox[", 10621 (2019)",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1021/jacs.9b05319"], None}],
 "."
}], "Text",
 CellChangeTimes->{{3.878131833961995*^9, 3.8781318427825003`*^9}, {
  3.878131888269101*^9, 3.878131909978343*^9}, {3.8781321022743416`*^9, 
  3.878132113009955*^9}},
 CellID->352974439,ExpressionUUID->"85b22f1a-9685-4c80-8b95-676fd3eb6570"],

Cell[CellGroupData[{

Cell["XXXX", "MathCaption",
 CellID->836781195,ExpressionUUID->"58746013-13dd-4661-aeb9-52995ffc7010"],

Cell[CellGroupData[{

Cell[BoxData["XXXX"], "Input",
 CellLabel->"In[1]:=",
 CellID->2058623809,ExpressionUUID->"da49dbbd-907d-4092-9f99-e0c1e4bc9193"],

Cell[BoxData["XXXX"], "Output",
 CellLabel->"Out[1]=",
 CellID->1181321046,ExpressionUUID->"022827ee-3a21-4cdb-a9f7-a319a6ef9ab1"]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Summary", "Subsection",
 CellChangeTimes->{{3.878133596422802*^9, 3.878133598782937*^9}},
 CellID->498751012,ExpressionUUID->"f4048db3-81b3-4cfb-b250-77ae9c32aa61"],

Cell["Phase diagram t/U vs ne", "Text",
 CellChangeTimes->{{3.878133644260538*^9, 3.878133663029611*^9}},
 CellID->763419631,ExpressionUUID->"2477266e-2e2b-4c83-881f-1b9dff4421c0"],

Cell["t-J model?", "Text",
 CellChangeTimes->{{3.878133692327288*^9, 3.8781337048030005`*^9}},
 CellID->103541674,ExpressionUUID->"be7a8930-fde1-4065-90e6-1aebf33a30b3"]
}, Open  ]],

Cell[CellGroupData[{

Cell["More About", "TutorialMoreAboutSection",
 CellID->23220180,ExpressionUUID->"77819af9-0a77-435c-a67e-248461d94066"],

Cell[TextData[{
 "Xxxx  ",
 ButtonBox["Y. Claveau, B. Arnaud, and S. Di Matteo, ",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1088/0143-0807/35/3/035023"], None}],
 StyleBox[ButtonBox["Eur. J. Phys.",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1088/0143-0807/35/3/035023"], None}],
  FontSlant->"Italic"],
 ButtonBox[" ",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1088/0143-0807/35/3/035023"], None}],
 StyleBox[ButtonBox["35",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1088/0143-0807/35/3/035023"], None}],
  FontWeight->"Bold"],
 ButtonBox[", 035023 (2014)",
  BaseStyle->"Hyperlink",
  ButtonData->{
    URL["https://doi.org/10.1088/0143-0807/35/3/035023"], None}],
 "."
}], "TutorialMoreAbout",
 CellChangeTimes->{{3.878132626481324*^9, 3.878132637503955*^9}},
 CellID->1567025153,ExpressionUUID->"45167747-0b9b-415f-8357-dea3c874568d"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Related Tutorials", "RelatedTutorialsSection",
 CellID->415694126,ExpressionUUID->"e52b0e7b-c5b4-4d89-b3a1-8a9f3f078311"],

Cell["XXXX", "RelatedTutorials",
 CellID->806871991,ExpressionUUID->"4fb49009-0fba-4520-9a29-b4104a24c9ac"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Related Wolfram Education Group Courses", "TutorialRelatedLinksSection",
 CellID->415694148,ExpressionUUID->"29c0b7d3-ddff-4c19-8205-c78a65cb153b"],

Cell["XXXX", "TutorialRelatedLinks",
 CellID->415694149,ExpressionUUID->"b07f5e6d-b2bd-4ba6-9066-408f0d670f09"]
}, Open  ]]
}, Open  ]]
},
WindowSize->{675.6, 573.6},
WindowMargins->{{97.19999999999999, Automatic}, {24, Automatic}},
Magnification:>1.5 Inherited,
FrontEndVersion->"14.0 for Microsoft Windows (64-bit) (December 12, 2023)",
StyleDefinitions->FrontEnd`FileName[{"Wolfram"}, "TutorialPageStyles.nb", 
  CharacterEncoding -> "UTF-8"],
ExpressionUUID->"04c70811-d905-4e46-8c97-59811bf7cb2a"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[558, 20, 666, 15, 35, "History",ExpressionUUID->"3940006d-6a0f-486f-aa1e-3a8e40c0f7cb",
 CellID->1247902091],
Cell[CellGroupData[{
Cell[1249, 39, 123, 1, 42, "CategorizationSection",ExpressionUUID->"091d4b82-1486-44fc-936a-55dae8d1b01e",
 CellID->1122911449],
Cell[1375, 42, 136, 2, 48, "Categorization",ExpressionUUID->"12a50e11-0ea6-435c-871d-7fca16e42f89",
 CellID->686433507],
Cell[1514, 46, 134, 2, 48, "Categorization",ExpressionUUID->"41b5bfee-12d1-4c22-a6d7-4e9ffbebcfb4",
 CellID->605800465],
Cell[1651, 50, 131, 2, 48, "Categorization",ExpressionUUID->"596a08b0-fb5f-4694-ab0b-90638efb236f",
 CellID->468444828],
Cell[1785, 54, 137, 1, 48, "Categorization",ExpressionUUID->"ea40e3af-a5f4-46dc-a8cc-1bf3a2c44d4a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1959, 60, 111, 1, 42, "KeywordsSection",ExpressionUUID->"f9914da7-07d0-40fd-9f4c-e5d4f7191392",
 CellID->1427428552],
Cell[2073, 63, 244, 3, 27, "Keywords",ExpressionUUID->"9f40a13e-a795-49e4-843f-f7fbfc4f4ffa",
 CellID->1251852827],
Cell[2320, 68, 182, 2, 27, "Keywords",ExpressionUUID->"e354a31c-d0b5-4d5a-a5b4-29343ef9751c",
 CellID->653679113],
Cell[2505, 72, 181, 2, 27, "Keywords",ExpressionUUID->"38078204-3146-40df-a284-5dc4ee441da1",
 CellID->613130496],
Cell[2689, 76, 189, 2, 27, "Keywords",ExpressionUUID->"8f4c26f4-afeb-4e90-b08f-07f70c820ca3",
 CellID->504256200],
Cell[2881, 80, 227, 3, 27, "Keywords",ExpressionUUID->"a690edf4-04b0-4c35-8c1d-c583759c22d7",
 CellID->1030914704],
Cell[3111, 85, 187, 2, 27, "Keywords",ExpressionUUID->"8c6c851a-1d41-4af9-aed8-c17b11b366bb",
 CellID->287984341],
Cell[3301, 89, 176, 2, 27, "Keywords",ExpressionUUID->"a7bb5352-67da-4688-8eed-3695ca9a1299",
 CellID->333773507],
Cell[3480, 93, 176, 2, 27, "Keywords",ExpressionUUID->"3573d626-129c-4d33-9b6a-bea68813ad61",
 CellID->372860421],
Cell[3659, 97, 181, 2, 27, "Keywords",ExpressionUUID->"d7e01337-0159-4694-a68c-d5b8cbaac321",
 CellID->721034594],
Cell[3843, 101, 173, 2, 27, "Keywords",ExpressionUUID->"cfb205c4-66f4-4b7b-9f8b-b245aa05e232",
 CellID->17758388],
Cell[4019, 105, 177, 2, 27, "Keywords",ExpressionUUID->"296183f8-9383-425f-a772-b213457fa14e",
 CellID->41305077],
Cell[4199, 109, 173, 2, 27, "Keywords",ExpressionUUID->"a46c7cdb-f64e-4d8d-a059-5a1366e63839",
 CellID->492575331],
Cell[4375, 113, 177, 2, 27, "Keywords",ExpressionUUID->"40cbac29-b276-4fb7-ab2d-3b706eb6d3b5",
 CellID->688022415],
Cell[4555, 117, 179, 2, 27, "Keywords",ExpressionUUID->"0bda32d1-a699-4437-a4f1-0750389425d0",
 CellID->324842763],
Cell[4737, 121, 176, 2, 27, "Keywords",ExpressionUUID->"12d0fba9-af39-4a87-8e41-9e75bc1c92c5",
 CellID->21823167]
}, Open  ]],
Cell[CellGroupData[{
Cell[4950, 128, 108, 1, 42, "DetailsSection",ExpressionUUID->"90e9975d-c520-46e0-bf71-3acd7cf6f1e8",
 CellID->307771771],
Cell[5061, 131, 118, 2, 105, "Details",ExpressionUUID->"7d8d0c7b-e61e-4575-a313-a7b642db8c8a",
 CellID->218895918],
Cell[5182, 135, 124, 2, 105, "Details",ExpressionUUID->"b21b727f-597b-4e89-9be6-c16e07fc0f24",
 CellID->350963985],
Cell[5309, 139, 121, 2, 105, "Details",ExpressionUUID->"4541a1f0-67fb-41b5-9bd2-156a40c9ee87",
 CellID->795871300],
Cell[5433, 143, 126, 2, 105, "Details",ExpressionUUID->"3b5fa953-fede-4043-ae29-4c65585d43be",
 CellID->199739161],
Cell[5562, 147, 115, 2, 105, "Details",ExpressionUUID->"4f8d0a18-baa7-4821-b109-d469f558826a",
 CellID->40625308],
Cell[5680, 151, 116, 2, 105, "Details",ExpressionUUID->"dc91fe58-ba2b-4868-ada2-35153a1cb69a",
 CellID->357121918],
Cell[5799, 155, 117, 2, 105, "Details",ExpressionUUID->"d9ad6e5c-dfbf-43c8-ad66-cefc105ad852",
 CellID->35949532],
Cell[5919, 159, 133, 2, 105, "Details",ExpressionUUID->"3743f626-8751-48d7-b328-5281890e682c",
 CellID->929432370],
Cell[6055, 163, 122, 2, 105, "Details",ExpressionUUID->"e1faf829-06d4-479f-95c7-0d8b527e8003",
 CellID->240026365]
}, Closed]],
Cell[CellGroupData[{
Cell[6214, 170, 182, 2, 122, "Title",ExpressionUUID->"7d715dab-bfea-48f6-8d4e-3a3b891c6cba",
 CellID->509267359],
Cell[6399, 174, 2752, 59, 369, "Text",ExpressionUUID->"2df5b76c-6d6d-4a03-968a-295551a68714",
 CellID->392738683],
Cell[9154, 235, 798, 15, 60, "Text",ExpressionUUID->"86241a8a-be16-4793-bb9b-3b18c3bcc980",
 CellID->234279902],
Cell[9955, 252, 2089, 58, 106, "DefinitionBox",ExpressionUUID->"3a1bcea0-4a3b-421f-b003-b4cb8349cb87",
 CellID->2096742444],
Cell[12047, 312, 310, 4, 42, "Caption",ExpressionUUID->"580ed65d-1618-4f98-8d7c-484e1c8a1e78",
 CellID->1891092685],
Cell[CellGroupData[{
Cell[12382, 320, 227, 3, 55, "Subsection",ExpressionUUID->"cef2287f-643e-4d1d-a0da-72c99a953337",
 CellID->99497867],
Cell[12612, 325, 1286, 31, 81, "Text",ExpressionUUID->"282cb253-591f-45e0-a2e5-91fc179bfb24",
 CellID->340960235],
Cell[13901, 358, 1407, 38, 37, "Text",ExpressionUUID->"d3c135d8-6dd4-41b7-8698-475aa96ba954",
 CellID->248436350],
Cell[15311, 398, 216, 3, 33, "Text",ExpressionUUID->"98a342a0-b954-4e83-8037-f5d96508ec39",
 CellID->575166834],
Cell[15530, 403, 902, 23, 36, "Text",ExpressionUUID->"b848d3e0-e3dc-4327-99ac-d6922b23d7ba",
 CellID->175323470],
Cell[16435, 428, 849, 20, 35, "Text",ExpressionUUID->"f3101dec-e6bc-4011-a6d6-51d028b68b12",
 CellID->431712291],
Cell[17287, 450, 830, 19, 59, "Text",ExpressionUUID->"5d04248c-d458-42ab-8bb9-1d2283efffa3",
 CellID->355460130],
Cell[18120, 471, 700, 12, 33, "Text",ExpressionUUID->"73a6b437-bd1c-48bc-835c-da1f300ed7d3",
 CellID->6233816],
Cell[18823, 485, 1142, 29, 36, "Text",ExpressionUUID->"075d7032-6e66-4a82-821f-92c2fe1953ba",
 CellID->691137860],
Cell[19968, 516, 2227, 44, 255, "Text",ExpressionUUID->"dee2eb1c-f86a-4151-8e7b-9f2e98d942fb",
 CellID->9668019],
Cell[22198, 562, 2244, 63, 109, "Text",ExpressionUUID->"85a33cc4-9ccf-4975-a2b7-f301552b38b1",
 CellID->244331071],
Cell[24445, 627, 2752, 74, 34, "Text",ExpressionUUID->"816a5dc8-490f-43a8-a94d-d7352bb59a12",
 CellID->135531073],
Cell[27200, 703, 454, 8, 57, "Text",ExpressionUUID->"db4aee14-5452-4f17-92aa-90362178c4b0",
 CellID->188641995],
Cell[27657, 713, 5642, 158, 61, "Text",ExpressionUUID->"a7afd486-0cb6-4c9c-a848-567cb34bdf32",
 CellID->610935084],
Cell[33302, 873, 194, 2, 33, "Text",ExpressionUUID->"c0bbfc22-4877-4d7d-9f68-57276250cab3",
 CellID->513880676],
Cell[33499, 877, 2112, 58, 37, "Text",ExpressionUUID->"6ea8e673-a7f0-442c-b343-561152c1fdee",
 CellID->968486772],
Cell[35614, 937, 3765, 112, 62, "Text",ExpressionUUID->"146109dd-06f8-7f44-a838-2de64e495817",
 CellID->50592848],
Cell[39382, 1051, 738, 11, 81, "Text",ExpressionUUID->"436b25c7-f3fb-4d87-b665-451eb19cc889",
 CellID->711149020],
Cell[40123, 1064, 614, 10, 57, "Text",ExpressionUUID->"20cd8010-c590-f548-8674-072c6dbec213",
 CellID->10684558],
Cell[40740, 1076, 1335, 36, 44, "Text",ExpressionUUID->"1f6e276c-c35a-4a4d-9115-3b3ff56fcd50",
 CellID->12107329],
Cell[42078, 1114, 1132, 33, 44, "Text",ExpressionUUID->"fa5780c0-e073-4622-bf89-901361a5df68",
 CellID->591970146],
Cell[43213, 1149, 871, 21, 57, "Text",ExpressionUUID->"e0e8778b-2a43-418c-b01c-0f5bb1da3aee",
 CellID->706609024],
Cell[44087, 1172, 357, 7, 33, "Text",ExpressionUUID->"d4d2b80c-5100-4987-a376-79d14031041d",
 CellID->707388835],
Cell[44447, 1181, 1359, 39, 64, "Text",ExpressionUUID->"02d93cce-a5cb-402c-b7db-3df505dbd2f7",
 CellID->70986363],
Cell[45809, 1222, 162, 2, 33, "Text",ExpressionUUID->"6de84716-6724-43d1-b5f4-105c432a8c1f",
 CellID->253226891],
Cell[45974, 1226, 1337, 37, 64, "Text",ExpressionUUID->"07db1f46-6861-4bb9-a886-47415f93460c",
 CellID->273828738],
Cell[47314, 1265, 2793, 69, 133, "Text",ExpressionUUID->"5341fae3-4658-4baa-8520-981cf7a564fe",
 CellID->80053891],
Cell[50110, 1336, 475, 9, 81, "Text",ExpressionUUID->"f345168b-17c5-4d39-a1d7-64d0b52ab919",
 CellID->327927258],
Cell[50588, 1347, 396, 7, 33, "Text",ExpressionUUID->"fd6b4bd2-833e-498a-87f0-7170adeeefdb",
 CellID->357310156],
Cell[50987, 1356, 2865, 82, 122, "Text",ExpressionUUID->"47241bca-4c35-4b15-87dc-3f815aa47e7e",
 CellID->453425570],
Cell[53855, 1440, 2583, 60, 183, "Text",ExpressionUUID->"75c3bd3f-1a49-417a-ad80-723481df5009",
 CellID->223785096],
Cell[56441, 1502, 212, 2, 33, "Text",ExpressionUUID->"9ccd6dc8-2b14-401a-9894-06f69a31794c",
 CellID->26141655],
Cell[56656, 1506, 1397, 41, 41, "Text",ExpressionUUID->"350d62af-4853-4e60-94c0-aba0431aaa5e",
 CellID->135951613],
Cell[58056, 1549, 1585, 46, 57, "Text",ExpressionUUID->"045ae40e-a52d-42aa-91af-44d85191dd5f",
 CellID->288067883],
Cell[59644, 1597, 995, 29, 35, "Text",ExpressionUUID->"6af06849-6f78-485e-859c-0b87857534ef",
 CellID->558645],
Cell[60642, 1628, 1174, 28, 57, "Text",ExpressionUUID->"2c09ea12-e815-4497-8370-154583b7ac71",
 CellID->277095794],
Cell[61819, 1658, 692, 11, 129, "Text",ExpressionUUID->"f04b6401-4706-4920-9326-b6f49f3e6144",
 CellID->430520891],
Cell[62514, 1671, 1063, 26, 57, "Text",ExpressionUUID->"8fc728a6-7e3d-4ceb-9351-0e88ed4e30e3",
 CellID->240321390],
Cell[63580, 1699, 1255, 39, 35, "Text",ExpressionUUID->"e9188e2d-29c5-4239-9319-fc1875d8831d",
 CellID->58174926],
Cell[64838, 1740, 2601, 81, 35, "Text",ExpressionUUID->"e6d5107c-b29a-4bdc-b001-9dd696c0dcb7",
 CellID->85753493],
Cell[67442, 1823, 358, 9, 33, "Text",ExpressionUUID->"1c0a8662-3520-4bf1-8dad-1a06506ff1d2",
 CellID->57861609],
Cell[67803, 1834, 2401, 57, 201, "Text",ExpressionUUID->"4e681a1c-28b6-4e42-8cc3-83828b22e10c",
 CellID->13211328]
}, Open  ]],
Cell[CellGroupData[{
Cell[70241, 1896, 175, 2, 58, "Subsection",ExpressionUUID->"96936a3e-8ce9-45c6-8399-27c027ff80ab",
 CellID->262340085],
Cell[70419, 1900, 1556, 37, 81, "Text",ExpressionUUID->"64c244e7-ce53-4397-8104-99869502c572",
 CellID->142643545],
Cell[71978, 1939, 510, 9, 57, "Text",ExpressionUUID->"08ea47d7-20a7-4a06-85c4-41d7b1b9b387",
 CellID->981673901],
Cell[72491, 1950, 561, 8, 33, "Text",ExpressionUUID->"355ff0a4-acf7-438a-bb55-cd54fbe9dfe5",
 CellID->5495055],
Cell[73055, 1960, 322, 5, 33, "Text",ExpressionUUID->"31060984-cec4-4ede-b943-aaedd24dd9dd",
 CellID->404766169],
Cell[73380, 1967, 576, 11, 60, "Text",ExpressionUUID->"bcf14bcc-e104-4ce7-9d45-90b000ad051a",
 CellID->689812174],
Cell[73959, 1980, 611, 16, 63, "Text",ExpressionUUID->"b91aee21-acf9-4c7f-bc0d-db843b819e20",
 CellID->463680380],
Cell[74573, 1998, 342, 6, 33, "Text",ExpressionUUID->"a3bf0c91-661c-4d42-a37a-2536d21b0886",
 CellID->161262773],
Cell[74918, 2006, 424, 10, 33, "Text",ExpressionUUID->"0f73e6c6-6088-42c9-91ad-25e15558cf7f",
 CellID->327779710],
Cell[75345, 2018, 231, 5, 33, "Text",ExpressionUUID->"68ea4b77-bf86-4a16-99b4-03af9f0cdf85",
 CellID->789092532],
Cell[CellGroupData[{
Cell[75601, 2027, 322, 6, 33, "Text",ExpressionUUID->"2c2c027f-e571-478d-a186-83ff77c9b0c5",
 CellID->44949911],
Cell[CellGroupData[{
Cell[75948, 2037, 343, 6, 84, "Code",ExpressionUUID->"6a378b33-2853-4444-b34a-54f886227e4f",
 CellID->505161433],
Cell[76294, 2045, 202, 3, 36, "Output",ExpressionUUID->"17d5e6fc-0817-46c4-99c8-95a63f14df38",
 CellID->17218734]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[76545, 2054, 495, 11, 36, "Text",ExpressionUUID->"87796fd7-a7d6-4766-a7cb-cf3e4600ca0a",
 CellID->2401200],
Cell[77043, 2067, 236, 4, 84, "Code",ExpressionUUID->"32247a65-953e-4fbe-85f1-f3495df7a9b9",
 CellID->160837254]
}, Open  ]],
Cell[CellGroupData[{
Cell[77316, 2076, 1149, 27, 84, "Text",ExpressionUUID->"069431dc-3865-4e98-826c-663082d33be5",
 CellID->633671718],
Cell[78468, 2105, 9098, 210, 1915, "Code",ExpressionUUID->"cf57b0ea-8ea3-452d-932d-bc5b572bdf87",
 CellID->287161835]
}, Closed]],
Cell[CellGroupData[{
Cell[87603, 2320, 1248, 32, 62, "Text",ExpressionUUID->"8ee74053-5cfe-497f-8065-e10b0205c595",
 CellID->579868645],
Cell[88854, 2354, 5080, 120, 1038, "Code",ExpressionUUID->"e1fd9edc-aac0-4751-992c-a18e6dd773a6",
 CellID->792939417]
}, Closed]],
Cell[CellGroupData[{
Cell[93971, 2479, 650, 14, 57, "Text",ExpressionUUID->"5f014cd9-0cb2-4b4a-b592-5c4ece955c94",
 CellID->183662499],
Cell[94624, 2495, 7765, 183, 1228, "Code",ExpressionUUID->"dbc6af23-941d-4f11-ad2c-dcd986e20b16",
 CellID->663875468]
}, Closed]],
Cell[CellGroupData[{
Cell[102426, 2683, 1435, 33, 135, "Text",ExpressionUUID->"f7cd916d-403c-467a-b57e-341dc2a07f34",
 CellID->44386903],
Cell[103864, 2718, 12542, 286, 1930, "Code",ExpressionUUID->"24a08639-5c19-4b47-a890-d6246f204e88",
 CellID->53961409]
}, Closed]],
Cell[CellGroupData[{
Cell[116443, 3009, 694, 15, 57, "Text",ExpressionUUID->"9bd55406-5529-4532-a730-9624cb542e95",
 CellID->475847898],
Cell[117140, 3026, 5433, 125, 1250, "Code",ExpressionUUID->"d4fb5ba3-59cb-4911-9b5c-e2f5db627107",
 CellID->319588904]
}, Closed]],
Cell[122588, 3154, 633, 14, 57, "Text",ExpressionUUID->"fdc37674-3441-43e8-bf90-8b00bd025775",
 CellID->25939828],
Cell[123224, 3170, 12022, 202, 199, "Text",ExpressionUUID->"b57ce971-918c-487a-81bc-6b1b042dc5e3",
 CellID->114793826]
}, Closed]],
Cell[CellGroupData[{
Cell[135283, 3377, 172, 2, 55, "Subsection",ExpressionUUID->"567fd1c0-4c1e-4081-9f8d-b3fc817863d3",
 CellID->64426075],
Cell[CellGroupData[{
Cell[135480, 3383, 193, 2, 60, "Subsubsection",ExpressionUUID->"e56c4039-3e51-487c-8397-b6420fd0ab78",
 CellID->115823570],
Cell[CellGroupData[{
Cell[135698, 3389, 987, 28, 33, "Text",ExpressionUUID->"63b696c3-4f2f-4bc9-adba-3a9b5c62d997",
 CellID->541116115],
Cell[CellGroupData[{
Cell[136710, 3421, 597, 15, 64, "Input",ExpressionUUID->"d1750d16-8095-4d1f-9f04-afcf7cff6f88",
 CellID->163654459],
Cell[137310, 3438, 16852, 445, 98, "Output",ExpressionUUID->"4a9c0f25-b32d-46bf-8b5b-c624dcb5144b",
 CellID->297566894]
}, Open  ]],
Cell[CellGroupData[{
Cell[154199, 3888, 2158, 58, 498, "Input",ExpressionUUID->"c3282c42-f6c1-4397-bece-6d2346102734",
 CellID->203993768],
Cell[156360, 3948, 536, 13, 36, "Output",ExpressionUUID->"1ec0c2c2-1cf9-4fcd-9da5-3a2c026ff534",
 CellID->572603121],
Cell[CellGroupData[{
Cell[156921, 3965, 1702, 31, 50, "Echo",ExpressionUUID->"1eb9a258-cc8f-4a3d-8834-723fd0612850",
 CellID->18648108],
Cell[158626, 3998, 1867, 46, 239, "Echo",ExpressionUUID->"3b1f3a35-03c2-4761-83f0-0d5d1696be12",
 CellID->47006840],
Cell[160496, 4046, 1958, 38, 38, "Echo",ExpressionUUID->"6d7815d4-0b53-4081-9e35-88576959439f",
 CellID->261121597]
}, Open  ]],
Cell[162469, 4087, 233, 5, 36, "Output",ExpressionUUID->"cfd2a37d-93b0-4b7b-b89d-d3ca46eb9b54",
 CellID->35452243]
}, Open  ]],
Cell[162717, 4095, 1269, 35, 91, "Input",ExpressionUUID->"266d935e-fd17-4993-9ba5-8c9f739e0735",
 CellID->115514514],
Cell[CellGroupData[{
Cell[164011, 4134, 270, 5, 37, "Input",ExpressionUUID->"ac2b5b33-f844-4d1d-b969-4231c6152323",
 CellID->136568887],
Cell[164284, 4141, 19478, 396, 170, "Output",ExpressionUUID->"bd1c46ed-4cbb-44a8-9c24-27bc648be126",
 CellID->178049117]
}, Open  ]],
Cell[CellGroupData[{
Cell[183799, 4542, 945, 25, 143, "Input",ExpressionUUID->"0138768f-a219-499c-ad77-99430c1ebc31",
 CellID->202423183],
Cell[184747, 4569, 203, 4, 36, "Output",ExpressionUUID->"86364a3f-2b48-420b-bf37-2162077e8c02",
 CellID->199442416]
}, Open  ]],
Cell[CellGroupData[{
Cell[184987, 4578, 1458, 34, 249, "Input",ExpressionUUID->"6cbbba6b-bcb0-437b-b0bf-f8e5734f568d",
 CellID->780751736],
Cell[CellGroupData[{
Cell[186470, 4616, 1702, 31, 50, "Echo",ExpressionUUID->"3defe828-d377-4714-9365-5f37b2b57616",
 CellID->16937823],
Cell[188175, 4649, 2036, 49, 239, "Echo",ExpressionUUID->"19462126-a065-42ad-b22a-c9a687ae4123",
 CellID->594250686],
Cell[190214, 4700, 1959, 38, 38, "Echo",ExpressionUUID->"3ca41c94-1bcc-490f-851a-12772ce81571",
 CellID->11367142]
}, Open  ]],
Cell[192188, 4741, 234, 5, 36, "Output",ExpressionUUID->"578ee3b0-dc8b-44b0-8278-d3f8c0a83081",
 CellID->104815728]
}, Open  ]],
Cell[CellGroupData[{
Cell[192459, 4751, 246, 5, 37, "Input",ExpressionUUID->"bd336d60-d006-42fd-9d81-19817e3c9307",
 CellID->806929819],
Cell[192708, 4758, 19311, 394, 170, "Output",ExpressionUUID->"73ad917d-57fa-40b2-9b89-b0df300e369a",
 CellID->356402827]
}, Open  ]],
Cell[CellGroupData[{
Cell[212056, 5157, 825, 23, 143, "Input",ExpressionUUID->"d244a178-f1a2-4f7b-9da3-86be8bf91642",
 CellID->301794949],
Cell[212884, 5182, 206, 4, 36, "Output",ExpressionUUID->"0a25ae49-b2b1-43c2-b628-f0eab15b20f8",
 CellID->244172380]
}, Open  ]]
}, Closed]],
Cell[213117, 5190, 349, 6, 57, "Text",ExpressionUUID->"27e4f825-31ef-48a2-bd17-5ca9e549d400",
 CellID->427396307]
}, Open  ]],
Cell[CellGroupData[{
Cell[213503, 5201, 200, 2, 60, "Subsubsection",ExpressionUUID->"0cb9b211-6e52-451d-9eab-bca6f29d7a4b",
 CellID->152948105],
Cell[213706, 5205, 924, 28, 33, "Text",ExpressionUUID->"9c0c6b61-f7f2-4fdc-b5f4-618b0e0c7997",
 CellID->83376063]
}, Open  ]],
Cell[CellGroupData[{
Cell[214667, 5238, 176, 2, 60, "Subsubsection",ExpressionUUID->"0fa9474d-ac4a-4e3f-bda9-5e61b5255357",
 CellID->77061337],
Cell[214846, 5242, 946, 28, 33, "Text",ExpressionUUID->"b7a8bf63-fe2f-450e-911c-207a03802772",
 CellID->419431593],
Cell[CellGroupData[{
Cell[215817, 5274, 95, 1, 33, "Text",ExpressionUUID->"07f65a40-55a2-4e0d-bd61-de6fdc1062f8",
 CellID->179323992],
Cell[215915, 5277, 607, 15, 64, "Input",ExpressionUUID->"84d74c68-bd13-49a8-8ad7-43a9fc301d8a",
 CellID->410410689],
Cell[216525, 5294, 3107, 78, 512, "Input",ExpressionUUID->"5724424e-f7fb-43fd-a197-f1198beebd28",
 CellID->639912496],
Cell[219635, 5374, 3040, 89, 196, "Input",ExpressionUUID->"c202cbaa-d8cc-45f1-ae80-3521c864354a",
 CellID->479092683]
}, Open  ]],
Cell[222690, 5466, 932, 27, 57, "Text",ExpressionUUID->"5c0b93d0-f7b8-46c1-87f1-bfd114bbabb1",
 CellID->1656622]
}, Closed]],
Cell[CellGroupData[{
Cell[223659, 5498, 186, 2, 51, "Subsubsection",ExpressionUUID->"295fa2ce-38cf-4262-854d-52c2295cf7ff",
 CellID->120439617],
Cell[223848, 5502, 879, 27, 33, "Text",ExpressionUUID->"9e36d79b-fcd0-4471-b904-710f52b6d9e9",
 CellID->25364302],
Cell[CellGroupData[{
Cell[224752, 5533, 95, 1, 33, "Text",ExpressionUUID->"b42fc24c-a7ca-4410-88c8-c19e2d64c6d5",
 CellID->532343381],
Cell[224850, 5536, 631, 15, 64, "Input",ExpressionUUID->"62de73de-98a0-40b4-a293-3ea01679d72e",
 CellID->133310808],
Cell[225484, 5553, 3292, 80, 539, "Input",ExpressionUUID->"c782b48e-b3a4-4474-b86e-4acf503695fd",
 CellID->501590767]
}, Open  ]],
Cell[CellGroupData[{
Cell[228813, 5638, 95, 1, 33, "Text",ExpressionUUID->"39010a68-1846-4d99-bc6d-5dc807227573",
 CellID->102563042],
Cell[228911, 5641, 3691, 108, 249, "Input",ExpressionUUID->"4009e675-e43a-483a-84f3-04fda83f6aae",
 CellID->215651520]
}, Open  ]],
Cell[232617, 5752, 1024, 29, 57, "Text",ExpressionUUID->"85b22f1a-9685-4c80-8b95-676fd3eb6570",
 CellID->352974439],
Cell[CellGroupData[{
Cell[233666, 5785, 102, 1, 47, "MathCaption",ExpressionUUID->"58746013-13dd-4661-aeb9-52995ffc7010",
 CellID->836781195],
Cell[CellGroupData[{
Cell[233793, 5790, 129, 2, 37, "Input",ExpressionUUID->"da49dbbd-907d-4092-9f99-e0c1e4bc9193",
 CellID->2058623809],
Cell[233925, 5794, 130, 2, 36, "Output",ExpressionUUID->"022827ee-3a21-4cdb-a9f7-a319a6ef9ab1",
 CellID->1181321046]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[234128, 5804, 170, 2, 58, "Subsection",ExpressionUUID->"f4048db3-81b3-4cfb-b250-77ae9c32aa61",
 CellID->498751012],
Cell[234301, 5808, 180, 2, 33, "Text",ExpressionUUID->"2477266e-2e2b-4c83-881f-1b9dff4421c0",
 CellID->763419631],
Cell[234484, 5812, 169, 2, 33, "Text",ExpressionUUID->"be7a8930-fde1-4065-90e6-1aebf33a30b3",
 CellID->103541674]
}, Open  ]],
Cell[CellGroupData[{
Cell[234690, 5819, 120, 1, 107, "TutorialMoreAboutSection",ExpressionUUID->"77819af9-0a77-435c-a67e-248461d94066",
 CellID->23220180],
Cell[234813, 5822, 950, 27, 31, "TutorialMoreAbout",ExpressionUUID->"45167747-0b9b-415f-8357-dea3c874568d",
 CellID->1567025153]
}, Open  ]],
Cell[CellGroupData[{
Cell[235800, 5854, 127, 1, 107, "RelatedTutorialsSection",ExpressionUUID->"e52b0e7b-c5b4-4d89-b3a1-8a9f3f078311",
 CellID->415694126],
Cell[235930, 5857, 107, 1, 31, "RelatedTutorials",ExpressionUUID->"4fb49009-0fba-4520-9a29-b4104a24c9ac",
 CellID->806871991]
}, Open  ]],
Cell[CellGroupData[{
Cell[236074, 5863, 153, 1, 107, "TutorialRelatedLinksSection",ExpressionUUID->"29c0b7d3-ddff-4c19-8205-c78a65cb153b",
 CellID->415694148],
Cell[236230, 5866, 111, 1, 31, "TutorialRelatedLinks",ExpressionUUID->"b07f5e6d-b2bd-4ba6-9066-408f0d670f09",
 CellID->415694149]
}, Open  ]]
}, Open  ]]
}
]
*)

